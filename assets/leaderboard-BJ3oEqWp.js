import{s as e}from"./rolldown-runtime-Cb2Vi1zU.js";import{a as t,n}from"./vendor-react-Pim_c09P.js";import"./vendor-i18n-DhDyTfDN.js";import{Bt as r,Ht as i,Wt as a,at as o,dt as s,ft as c,lt as l,mt as u,ot as d,pt as f,qt as p,ut as m,zt as h}from"./vendor-ui-eN3EJBiY.js";import{_ as g,a as _,h as v,i as y,n as b}from"./index-BhiUe6BC.js";import{t as x}from"./AdaptiveTooltip-Co_UX482.js";import{t as S}from"./Footer-P_9CF_o9.js";var C=e(t(),1),w=e(n(),1),T=()=>{let{t:e}=g(),{seasons:t,artifactCounts:n,fetchArtifactCounts:p,loadingArtifactCounts:v,serverMatchings:b,region:x,setRegion:S}=y(),[T,E]=(0,C.useState)(_.ABYSS_A),D={trigger:`!bg-character-card hover:!bg-character-card focus:!bg-character-card !transition-none border-crafting-border border-1 shadow-none rounded-sm group-data-[hover=true]:!bg-character-card group-data-[focus=true]:!bg-character-card group-data-[focus-visible=true]:!bg-character-card`,innerWrapper:`h-10 py-0`,popoverContent:`rounded-none p-0`},O={itemClasses:{base:`rounded-none`}},k=(0,C.useMemo)(()=>{if(t.length===0)return null;let e=Math.max(...t.map(e=>e.number));return t.find(t=>t.serverRegion.toLowerCase()===x.toLowerCase()&&t.number===e)?.id||null},[t,x]);(0,C.useEffect)(()=>{k&&p(k,T)},[k,T,p]);let A=(0,C.useMemo)(()=>{let e=[...n].sort((e,t)=>t.artifactCount-e.artifactCount||e.serverId-t.serverId),t=[],r=-1,i=0;for(let n=0;n<e.length;n++){let a=e[n];a.artifactCount!==r&&(i=n+1,r=a.artifactCount),t.push({...a,rank:i})}return t},[n]),j=t=>{let n=b.find(e=>e.server1.serverId===t||e.server2.serverId===t);if(n){let r=n.server1.serverId===t?n.server1:n.server2,i=r.raceId===1?e(`common:server.lightAbbr`):e(`common:server.darkAbbr`),a=r.serverId%1e3;return`${r.serverName}（${i}${a}）`}let r=e(t<2e3?`common:server.lightAbbr`:`common:server.darkAbbr`),i=t%1e3;return`${e(`common:server.server`)}（${r}${i}）`};return(0,w.jsxs)(h,{className:`bg-transparent shadow-none`,children:[(0,w.jsxs)(r,{className:`flex flex-col items-start gap-3 px-0`,children:[(0,w.jsx)(`p`,{className:`text-[22px] text-default-800 pb-4`,children:e(`common:leaderboard.artifactRegionRanking`)}),(0,w.jsxs)(`div`,{className:`flex gap-2 w-full sm:w-auto`,children:[(0,w.jsxs)(o,{size:`sm`,selectedKeys:[x],onSelectionChange:e=>S(Array.from(e)[0]),className:`min-w-[100px]`,disallowEmptySelection:!0,classNames:D,popoverProps:{radius:`none`},listboxProps:O,children:[(0,w.jsx)(d,{children:e(`common:server.tw`)},`tw`),(0,w.jsx)(d,{children:e(`common:server.kr`)},`kr`)]}),(0,w.jsxs)(o,{size:`sm`,selectedKeys:[T],onSelectionChange:e=>E(Array.from(e)[0]),className:`min-w-[150px]`,disallowEmptySelection:!0,classNames:D,popoverProps:{radius:`none`},listboxProps:O,children:[(0,w.jsx)(d,{children:e(`maps:${_.ABYSS_A}.description`)},_.ABYSS_A),(0,w.jsx)(d,{children:e(`maps:${_.ABYSS_B}.description`)},_.ABYSS_B)]})]})]}),(0,w.jsx)(i,{className:`px-0`,children:(0,w.jsxs)(u,{"aria-label":`Artifact Region Ranking`,removeWrapper:!0,className:`min-w-full`,classNames:{table:`border-separate border-spacing-y-[10px] -mt-[10px]`,thead:`[&>tr]:first:shadow-none`,th:`bg-transparent text-foreground font-bold text-[16px] h-auto py-0`,td:`bg-character-equipment h-[44px] text-[16px] font-normal text-default-800 border-y-1 border-crafting-border first:border-l-1 last:border-r-1 first:rounded-l-md last:rounded-r-md`},children:[(0,w.jsxs)(c,{children:[(0,w.jsx)(f,{children:e(`common:leaderboard.rank`)}),(0,w.jsx)(f,{children:e(`common:server.server`)}),(0,w.jsx)(f,{align:`center`,children:e(`common:leaderboard.artifactCount`)})]}),(0,w.jsx)(m,{emptyContent:v?(0,w.jsx)(a,{}):e(`common:leaderboard.inContention`),items:A,children:e=>(0,w.jsxs)(s,{children:[(0,w.jsx)(l,{children:(0,w.jsx)(`div`,{className:`flex items-center justify-center w-6 h-6`,children:e.rank})}),(0,w.jsx)(l,{children:(0,w.jsx)(`span`,{children:j(e.serverId)})}),(0,w.jsx)(l,{align:`center`,children:(0,w.jsx)(`span`,{children:e.artifactCount})})]},e.serverId)})]})})]})},E=()=>{let{t:e}=g([...[_.ABYSS_A,_.ABYSS_B].map(e=>`markers/${e}`),`common`]),{seasons:t,serverMatchings:n,loadingMatchings:a,artifacts:o,loadingArtifacts:s,artifactStates:c,fetchServerMatchings:l,fetchArtifactStates:u,region:d}=y(),{maps:f}=b(),[m,S]=(0,C.useState)(new Date);(0,C.useEffect)(()=>{let e=setInterval(()=>{S(new Date)},1e3);return()=>clearInterval(e)},[]);let T=v(`UI/Resource/Texture/Icon/UT_Marker_AbyssArtifact_Neutral.webp`),E=v(`UI/Resource/Texture/Icon/UT_Marker_AbyssArtifact_Light.webp`),D=v(`UI/Resource/Texture/Icon/UT_Marker_AbyssArtifact_Dark.webp`),O=v(`images/Leaderboards/VS.webp`),k=(0,C.useMemo)(()=>t.length===0?null:Math.max(...t.map(e=>e.number)),[t]),A=(0,C.useMemo)(()=>k&&t.find(e=>e.serverRegion===d&&e.number===k)?.id||null,[d,k,t]);(0,C.useEffect)(()=>{A&&(l(A),u(A))},[A,l,u]);let j=(0,C.useMemo)(()=>{let e={};return c.forEach(t=>{e[t.serverMatchingId]||(e[t.serverMatchingId]={}),e[t.serverMatchingId][t.abyssArtifactId]={state:t.state,recordTime:t.recordTime}}),e},[c]),M=t=>{if(!t)return`--:--:--`;let n=new Date(t).getTime()+2880*60*1e3-m.getTime();if(n<=0)return e(`common:leaderboard.inContention`,`数据待上传`);let r=Math.floor(n/(1e3*60*60)),i=Math.floor(n%(1e3*60*60)/(1e3*60)),a=Math.floor(n%(1e3*60)/1e3);return`${String(r).padStart(2,`0`)}:${String(i).padStart(2,`0`)}:${String(a).padStart(2,`0`)}`},{artifactsA:N,artifactsB:P}=(0,C.useMemo)(()=>{let e=f.find(e=>e.name===_.ABYSS_A),t=f.find(e=>e.name===_.ABYSS_B);return{artifactsA:o.filter(t=>t.marker.mapId===e?.id).sort((e,t)=>e.order-t.order),artifactsB:o.filter(e=>e.marker.mapId===t?.id).sort((e,t)=>e.order-t.order)}},[o,f]);return(0,w.jsxs)(`div`,{className:`flex flex-col gap-4`,children:[(0,w.jsx)(h,{className:`bg-transparent shadow-none`,children:(0,w.jsx)(r,{className:`flex flex-col items-start gap-3 px-0`,children:(0,w.jsx)(`p`,{className:`text-[22px] text-default-800`,children:e(`common:leaderboard.realtimeArtifactRatio`)})})}),a||s?(0,w.jsx)(`p`,{className:`text-center py-4`,children:e(`common:ui.loading`)}):n.map(t=>(0,w.jsx)(h,{className:`bg-character-equipment shadow-none border-1 border-crafting-border p-4`,children:(0,w.jsx)(i,{className:`p-0`,children:(0,w.jsxs)(`div`,{className:`flex items-center justify-between`,children:[(0,w.jsxs)(`div`,{className:`flex-1 flex flex-col items-center`,children:[(0,w.jsxs)(`div`,{className:`w-full h-[38px] flex items-center justify-center rounded-md`,style:{background:`linear-gradient(135deg, #DBEDFF 0%, #F3FBFF 100%)`},children:[(0,w.jsx)(`span`,{className:`text-lg font-bold text-[#1D3557]`,children:t.server1.serverName}),(0,w.jsxs)(`span`,{className:`text-[14px] font-normal text-default-700`,children:[`（天`,t.server1.serverId%1e3,`）`]})]}),(0,w.jsxs)(`div`,{className:`flex flex-col items-center gap-2 mt-2`,children:[(0,w.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,w.jsx)(`span`,{className:`text-[14px] text-foreground`,children:e(`maps:${_.ABYSS_A}.description`)}),(0,w.jsx)(`div`,{className:`flex gap-1`,children:N.map(n=>{let r=e(`markers/${_.ABYSS_A}:${n.markerId}.name`,n.marker.name),i=j[t.id]?.[n.id]?.state,a=T;return i===1?a=E:i===2&&(a=D),(0,w.jsx)(x,{content:r,children:(0,w.jsx)(`img`,{src:a,alt:r,className:`w-12 h-12`})},n.id)})})]}),(0,w.jsx)(`div`,{className:`text-[20px] text-default-800 font-mono`,children:M(N.length>0?j[t.id]?.[N[0].id]?.recordTime:void 0)})]})]}),(0,w.jsxs)(`div`,{className:`flex flex-col items-center px-2`,children:[(0,w.jsx)(`img`,{src:O,alt:`VS`,className:`w-10 h-10 object-contain`}),(0,w.jsx)(`div`,{className:`h-10 flex items-center mt-2`,children:(0,w.jsx)(p,{orientation:`vertical`,className:`h-full bg-default-500`})})]}),(0,w.jsxs)(`div`,{className:`flex-1 flex flex-col items-center`,children:[(0,w.jsxs)(`div`,{className:`w-full h-[38px] flex items-center justify-center rounded-md`,style:{background:`linear-gradient(225deg, #EFE5FF 0%, #F3FBFF 100%)`},children:[(0,w.jsx)(`span`,{className:`text-lg font-bold text-[#4B0082]`,children:t.server2.serverName}),(0,w.jsxs)(`span`,{className:`text-[14px] font-normal text-default-700`,children:[`（魔`,t.server2.serverId%1e3,`）`]})]}),(0,w.jsxs)(`div`,{className:`flex flex-col items-center gap-2 mt-2`,children:[(0,w.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,w.jsx)(`span`,{className:`text-[14px] text-foreground`,children:e(`maps:${_.ABYSS_B}.description`)}),(0,w.jsx)(`div`,{className:`flex gap-1`,children:P.map(n=>{let r=e(`markers/${_.ABYSS_B}:${n.markerId}.name`,n.marker.name),i=j[t.id]?.[n.id]?.state,a=T;return i===1?a=E:i===2&&(a=D),(0,w.jsx)(x,{content:r,children:(0,w.jsx)(`img`,{src:a,alt:r,className:`w-12 h-12`})},n.id)})})]}),(0,w.jsx)(`div`,{className:`text-[20px] text-default-800 font-mono`,children:M(P.length>0?j[t.id]?.[P[0].id]?.recordTime:void 0)})]})]})]})})},t.id))]})};function D(){return(0,w.jsxs)(`div`,{className:`h-full overflow-y-auto flex flex-col bg-leaderboard-page`,children:[(0,w.jsxs)(`div`,{className:`flex-1 flex justify-center gap-4 p-4`,children:[(0,w.jsx)(`div`,{style:{width:`428px`},className:`flex flex-col gap-4`,children:(0,w.jsx)(T,{})}),(0,w.jsx)(`div`,{style:{width:`632px`},className:`flex flex-col gap-4`,children:(0,w.jsx)(E,{})})]}),(0,w.jsx)(S,{})]})}export{D as component};
import{s as e,t}from"./rolldown-runtime-Cb2Vi1zU.js";import{a as n,n as r,t as i}from"./vendor-react-Pim_c09P.js";import{a,c as o,i as s,l as c,n as l,o as u,r as d,s as f,t as p,u as m}from"./vendor-map-DscpnS6u.js";import{i as h}from"./vendor-i18n-DJG_JRbJ.js";import{B as g,Dt as _,E as v,Ft as y,It as b,J as x,M as S,Mt as C,N as ee,Nt as w,O as T,Ot as E,Pt as D,Tt as O,W as k,_t as A,at as te,gt as ne,ht as j,k as re,mt as ie,ot as M,pt as ae,t as N,tt as P,z as F}from"./vendor-ui-2jyxot12.js";import{C as I,S as L,_ as R,a as oe,b as z,f as se,g as ce,h as le,i as ue,m as B,p as de,r as fe,v as pe,w as me,x as he,y as ge}from"./index-DxmTMv8p.js";import{t as _e}from"./useYamlLoader-CEUn0vuz.js";import{a as ve,c as ye,i as be,l as xe,o as Se,t as Ce}from"./lodash-DmxRirzj.js";var we=e(t(((e,t)=>{t.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}}))()),Te=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function Ee(e){var t={type:`tag`,name:``,voidElement:!1,attrs:{},children:[]},n=e.match(/<\/?([^\s]+?)[/\s>]/);if(n&&(t.name=n[1],(we.default[n[1]]||e.charAt(e.length-2)===`/`)&&(t.voidElement=!0),t.name.startsWith(`!--`))){var r=e.indexOf(`-->`);return{type:`comment`,comment:r===-1?``:e.slice(4,r)}}for(var i=new RegExp(Te),a=null;(a=i.exec(e))!==null;)if(a[0].trim())if(a[1]){var o=a[1].trim(),s=[o,``];o.indexOf(`=`)>-1&&(s=o.split(`=`)),t.attrs[s[0]]=s[1],i.lastIndex--}else a[2]&&(t.attrs[a[2]]=a[3].trim().substring(1,a[3].length-1));return t}var De=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,Oe=/^\s*$/,ke=Object.create(null);function Ae(e,t){switch(t.type){case`text`:return e+t.content;case`tag`:return e+=`<`+t.name+(t.attrs?function(e){var t=[];for(var n in e)t.push(n+`="`+e[n]+`"`);return t.length?` `+t.join(` `):``}(t.attrs):``)+(t.voidElement?`/>`:`>`),t.voidElement?e:e+t.children.reduce(Ae,``)+`</`+t.name+`>`;case`comment`:return e+`<!--`+t.comment+`-->`}}var je={parse:function(e,t){t||={},t.components||=ke;var n,r=[],i=[],a=-1,o=!1;if(e.indexOf(`<`)!==0){var s=e.indexOf(`<`);r.push({type:`text`,content:s===-1?e:e.substring(0,s)})}return e.replace(De,function(s,c){if(o){if(s!==`</`+n.name+`>`)return;o=!1}var l,u=s.charAt(1)!==`/`,d=s.startsWith(`<!--`),f=c+s.length,p=e.charAt(f);if(d){var m=Ee(s);return a<0?(r.push(m),r):((l=i[a]).children.push(m),r)}if(u&&(a++,(n=Ee(s)).type===`tag`&&t.components[n.name]&&(n.type=`component`,o=!0),n.voidElement||o||!p||p===`<`||n.children.push({type:`text`,content:e.slice(f,e.indexOf(`<`,f))}),a===0&&r.push(n),(l=i[a-1])&&l.children.push(n),i[a]=n),(!u||n.voidElement)&&(a>-1&&(n.voidElement||n.name===s.slice(2,-1))&&(a--,n=a===-1?r:i[a]),!o&&p!==`<`&&p)){l=a===-1?r:i[a].children;var h=e.indexOf(`<`,f),g=e.slice(f,h===-1?void 0:h);Oe.test(g)&&(g=` `),(h>-1&&a+l.length>=0||g!==` `)&&l.push({type:`text`,content:g})}}),r},stringify:function(e){return e.reduce(function(e,t){return e+Ae(``,t)},``)}},V=e(n()),Me=(e,t)=>{if(!e)return!1;let n=e.props?.children??e.children;return t?n.length>0:!!n},Ne=e=>{if(!e)return[];let t=e.props?.children??e.children;return e.props?.i18nIsDynamicList?Fe(t):t},Pe=e=>Array.isArray(e)&&e.every(V.isValidElement),Fe=e=>Array.isArray(e)?e:[e],Ie=(e,t)=>{let n={...t};return n.props=Object.assign(e.props,t.props),n};const Le=(e,t,n,r)=>{if(!e)return``;let i=``,a=Fe(e),o=t?.transSupportBasicHtmlNodes?t.transKeepBasicHtmlNodesFor??[]:[];return a.forEach((e,a)=>{if(L(e)){i+=`${e}`;return}if((0,V.isValidElement)(e)){let{props:s,type:c}=e,l=Object.keys(s).length,u=o.indexOf(c)>-1,d=s.children;if(!d&&u&&!l){i+=`<${c}/>`;return}if(!d&&(!u||l)||s.i18nIsDynamicList){i+=`<${a}></${a}>`;return}if(u&&l===1&&L(d)){i+=`<${c}>${d}</${c}>`;return}let f=Le(d,t,n,r);i+=`<${a}>${f}</${a}>`;return}if(e===null){I(n,`TRANS_NULL_VALUE`,`Passed in a null value as child`,{i18nKey:r});return}if(he(e)){let{format:t,...a}=e,o=Object.keys(a);if(o.length===1){let e=t?`${o[0]}, ${t}`:o[0];i+=`{{${e}}}`;return}I(n,`TRANS_INVALID_OBJ`,`Invalid child - Object should only have keys {{ value, format }} (format is optional).`,{i18nKey:r,child:e});return}I(n,`TRANS_INVALID_VAR`,`Passed in a variable like {number} - pass variables for interpolation as full objects like {{number}}.`,{i18nKey:r,child:e})}),i};var H=(e,t=[],n={})=>{if(!e)return e;let r=Object.keys(n),i=[...t,...r],a=``,o=0;for(;o<e.length;)if(e[o]===`<`){let t=!1,n=e.slice(o).match(/^<\/(\d+|[a-zA-Z][a-zA-Z0-9-]*)>/);if(n){let e=n[1];(/^\d+$/.test(e)||i.includes(e))&&(t=!0,a+=n[0],o+=n[0].length)}if(!t){let n=e.slice(o).match(/^<(\d+|[a-zA-Z][a-zA-Z0-9-]*)(\s+[\w-]+(?:=(?:"[^"]*"|'[^']*'|[^\s>]+))?)*\s*(\/)?>/);if(n){let e=n[1];(/^\d+$/.test(e)||i.includes(e))&&(t=!0,a+=n[0],o+=n[0].length)}}t||(a+=`&lt;`,o+=1)}else a+=e[o],o+=1;return a},Re=(e,t,n,r,i,a,o)=>{if(n===``)return[];let s=i.transKeepBasicHtmlNodesFor||[],c=n&&new RegExp(s.map(e=>`<${e}`).join(`|`)).test(n);if(!e&&!t&&!c&&!o)return[n];let l=t??{},u=e=>{Fe(e).forEach(e=>{L(e)||(Me(e)?u(Ne(e)):he(e)&&!(0,V.isValidElement)(e)&&Object.assign(l,e))})};u(e);let d=H(n,s,l),f=je.parse(`<0>${d}</0>`),p={...l,...a},m=(e,t,n)=>{let r=Ne(e),i=g(r,t.children,n);return Pe(r)&&i.length===0||e.props?.i18nIsDynamicList?r:i},h=(e,t,n,r,i)=>{e.dummy?(e.children=t,n.push((0,V.cloneElement)(e,{key:r},i?void 0:t))):n.push(...V.Children.map([e],e=>{let n={...e.props};return delete n.i18nIsDynamicList,(0,V.createElement)(e.type,{...n,key:r,ref:e.props.ref??e.ref},i?null:t)}))},g=(e,n,a)=>{let l=Fe(e);return Fe(n).reduce((e,n,u)=>{let d=n.children?.[0]?.content&&r.services.interpolator.interpolate(n.children[0].content,p,r.language);if(n.type===`tag`){let o=l[parseInt(n.name,10)];!o&&t&&(o=t[n.name]),a.length===1&&!o&&(o=a[0][n.name]),o||={};let f=Object.keys(n.attrs).length===0?o:Ie({props:n.attrs},o),_=(0,V.isValidElement)(f),v=_&&Me(n,!0)&&!n.voidElement,y=c&&he(f)&&f.dummy&&!_,b=he(t)&&Object.hasOwnProperty.call(t,n.name);if(L(f)){let t=r.services.interpolator.interpolate(f,p,r.language);e.push(t)}else if(Me(f)||v)h(f,m(f,n,a),e,u);else if(y)h(f,g(l,n.children,a),e,u);else if(Number.isNaN(parseFloat(n.name)))if(b)h(f,m(f,n,a),e,u,n.voidElement);else if(i.transSupportBasicHtmlNodes&&s.indexOf(n.name)>-1)if(n.voidElement)e.push((0,V.createElement)(n.name,{key:`${n.name}-${u}`}));else{let t=g(l,n.children,a);e.push((0,V.createElement)(n.name,{key:`${n.name}-${u}`},t))}else if(n.voidElement)e.push(`<${n.name} />`);else{let t=g(l,n.children,a);e.push(`<${n.name}>${t}</${n.name}>`)}else if(he(f)&&!_){let t=n.children[0]?d:null;t&&e.push(t)}else h(f,d,e,u,n.children.length!==1||!d)}else if(n.type===`text`){let t=i.transWrapTextNodes,a=o?i.unescape(r.services.interpolator.interpolate(n.content,p,r.language)):r.services.interpolator.interpolate(n.content,p,r.language);t?e.push((0,V.createElement)(t,{key:`${n.name}-${u}`},a)):e.push(a)}return e},[])};return Ne(g([{dummy:!0,children:e||[]}],f,Fe(e||[]))[0])},ze=(e,t,n)=>{let r=e.key||t,i=(0,V.cloneElement)(e,{key:r});if(!i.props||!i.props.children||n.indexOf(`${t}/>`)<0&&n.indexOf(`${t} />`)<0)return i;function a(){return(0,V.createElement)(V.Fragment,null,i)}return(0,V.createElement)(a,{key:r})},Be=(e,t)=>e.map((e,n)=>ze(e,n,t)),Ve=(e,t)=>{let n={};return Object.keys(e).forEach(r=>{Object.assign(n,{[r]:ze(e[r],r,t)})}),n},He=(e,t,n,r)=>e?Array.isArray(e)?Be(e,t):he(e)?Ve(e,t):(me(n,`TRANS_INVALID_COMPONENTS`,`<Trans /> "components" prop expects an object or array`,{i18nKey:r}),null):null,Ue=e=>!he(e)||Array.isArray(e)?!1:Object.keys(e).reduce((e,t)=>e&&Number.isNaN(Number.parseFloat(t)),!0);function We({children:e,count:t,parent:n,i18nKey:r,context:i,tOptions:a={},values:o,defaults:s,components:c,ns:l,i18n:u,t:d,shouldUnescape:f,...p}){let m=u||ge();if(!m)return me(m,`NO_I18NEXT_INSTANCE`,`Trans: You need to pass in an i18next instance using i18nextReactModule`,{i18nKey:r}),e;let g=d||m.t.bind(m)||(e=>e),_={...z(),...m.options?.react},v=l||g.ns||m.options?.defaultNS;v=L(v)?[v]:v||[`translation`];let y=Le(e,_,m,r),b=s||a?.defaultValue||y||_.transEmptyNodeValue||(typeof r==`function`?h(r):r),{hashTransKey:x}=_,S=r||(x?x(y||b):y||b);m.options?.interpolation?.defaultVariables&&(o=o&&Object.keys(o).length>0?{...o,...m.options.interpolation.defaultVariables}:{...m.options.interpolation.defaultVariables});let C=o||t!==void 0&&!m.options?.interpolation?.alwaysFormat||!e?a.interpolation:{interpolation:{...a.interpolation,prefix:`#$?`,suffix:`?$#`}},ee={...a,context:i||a.context,count:t,...o,...C,defaultValue:b,ns:v},w=S?g(S,ee):b;w===S&&b&&(w=b);let T=He(c,w,m,r),E=T||e,D=null;Ue(T)&&(D=T,E=e);let O=Re(E,D,w,m,_,ee,f),k=n??_.defaultTransParent;return k?(0,V.createElement)(k,p,O):O}function Ge({children:e,count:t,parent:n,i18nKey:r,context:i,tOptions:a={},values:o,defaults:s,components:c,ns:l,i18n:u,t:d,shouldUnescape:f,...p}){let{i18n:m,defaultNS:h}=(0,V.useContext)(pe)||{},g=u||m||ge(),_=d||g?.t.bind(g);return We({children:e,count:t,parent:n,i18nKey:r,context:i,tOptions:a,values:o,defaults:s,components:c,ns:l||_?.ns||h||g?.options?.defaultNS,i18n:g,t:d,shouldUnescape:f,...p})}function U(e,t,n,r){function i(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||=Promise)(function(n,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?n(e.value):i(e.value).then(o,s)}c((r=r.apply(e,t||[])).next())})}var Ke=e(m(),1),W=e(r(),1),qe=(0,V.createContext)(null);const Je=({children:e})=>{let[t,n]=(0,V.useState)([]),[r,i]=(0,V.useState)([]),[a,o]=(0,V.useState)(!0),[s,c]=(0,V.useState)(void 0),l=_e();return(0,V.useEffect)(()=>{let e=!1;async function t(){try{let[t,r]=await Promise.all([l(`data/maps.yaml`),l(`data/types.yaml`)]);if(e)return;n(t.maps.filter(e=>e.isVisible)),i(r.categories)}catch(e){console.error(e)}finally{e||o(!1)}}return t(),()=>{e=!0}},[l]),(0,V.useEffect)(()=>{if(!t||t.length===0)return;if(s){ce(`map`,s.name);return}let e=de(`map`);if(e){c(t.find(t=>t.name===e));return}t.length>0&&!s&&(c(t[0]),ce(`map`,t[0].name))},[t,s]),(0,W.jsx)(qe.Provider,{value:{maps:t,types:r,loading:a,selectedMap:s,setSelectedMap:c},children:e})};function G(){let e=(0,V.useContext)(qe);if(!e)throw Error(`useGameMap must be used inside <GameMapProvider>`);return e}var Ye=(0,V.createContext)(null);function Xe(e){let t=`${be}.${e}`;try{let e=localStorage.getItem(t);if(!e)return new Set;let n=JSON.parse(e);return new Set(n)}catch{return new Set}}function Ze(e){let t=`${be}.${e}`;localStorage.removeItem(t)}function Qe(e,t,n){let r=`${ve}.${e}.${t}`;localStorage.setItem(r,JSON.stringify([...n]))}function $e(e,t){let n=`${ve}.${e}.${t}`;try{let e=localStorage.getItem(n);if(!e)return new Set;let t=JSON.parse(e).filter(e=>typeof e==`number`);return new Set(t)}catch{return new Set}}const et=({children:e})=>{let[t,n]=(0,V.useState)([]),[r,i]=(0,V.useState)([]),[a,o]=(0,V.useState)(!1),[s,c]=(0,V.useState)(!1),l=_e(),{selectedMap:u}=G(),d=`markers/${u?.name}`,{t:f,i18n:p}=R([d]),[m,h]=(0,V.useState)({}),g=(0,V.useMemo)(()=>u?t.map(e=>{let t=f(`${d}:${e.id}.name`,e.name??``),n=f(`${d}:${e.id}.description`,``);return{...e,localizedName:t,localizedDescription:n}}):[],[t,u,f,p.language]),_=(0,V.useMemo)(()=>{let e={};for(let t of g)e[t.id]=t;return e},[g]);(0,V.useEffect)(()=>{if(!u){n([]),i([]);return}let e=!1;async function t(){o(!0);try{let t=await l(`data/markers/${u?.name}.yaml`);if(e)return;let r=await l(`data/regions/${u?.name}.yaml`);n(t.markers||[]),i(r.regions||[])}catch(t){console.error(t),e||(n([]),i([]))}finally{e||o(!1)}}return t(),()=>{e=!0}},[u,l]);let v=(0,V.useMemo)(()=>{let e={};for(let n of t)e[n.subtype]||(e[n.subtype]=new Set),e[n.subtype].add(n.indexInSubtype);let n={};for(let t of Object.keys(e))n[t]=e[t].size;return n},[t]),y=(0,V.useMemo)(()=>{let e={};for(let[t,n]of Object.entries(m))e[t]=n.size;return e},[m]);(0,V.useEffect)(()=>{if(!u){h({});return}let e=u.name,n=new Set(t.map(e=>e.subtype)),r={},i=!1;for(let t of n){let n=$e(e,t);n.size>0&&(i=!0),r[t]=n}if(i){h(r);return}let a=Xe(e);if(a.size===0){h(r);return}console.log(`[Markers] Migrating V1 â†’ V2`);let o={};for(let e of t){let t=e.id;a.has(t)&&(o[e.subtype]||(o[e.subtype]=new Set),o[e.subtype].add(e.indexInSubtype))}for(let t of Object.keys(o))Qe(e,t,o[t]);h(()=>({...r,...o}))},[u,t]);let b=(0,V.useCallback)(e=>{if(!u)return;let t=u.name,{subtype:n,indexInSubtype:r}=e;h(e=>{let i={...e},a=new Set(e[n]??[]);return a.has(r)?a.delete(r):a.add(r),i[n]=a,Qe(t,n,a),i})},[u]),x=(0,V.useCallback)(()=>{if(!u)return;let e=u.name;Ze(e),h(t=>{let n={};for(let r of Object.keys(t))n[r]=new Set,Qe(e,r,new Set);return n})},[u]);return(0,W.jsx)(Ye.Provider,{value:{markers:g,markersById:_,regions:r,loading:a,showLabels:s,setShowLabels:c,subtypeCounts:v,completedCounts:y,completedBySubtype:m,toggleMarkerCompleted:b,clearMarkerCompleted:x},children:e})};function tt(){let e=(0,V.useContext)(Ye);if(!e)throw Error(`useMarkers must be used inside <MarkersProvider>`);return e}var nt=(0,V.createContext)(null),rt=(e,t,n)=>{if(!t||!n)return;let r=`${e}${t.name}`;try{let e=Array.from(n),t=JSON.stringify(e);typeof window<`u`&&window.localStorage.setItem(r,t)}catch(e){console.warn(`Failed to save to localStorage`,r,e)}},it=(e,t,n)=>{let r=`${e}${t.name}`;try{let e=typeof window<`u`?window.localStorage.getItem(r):null;if(!e)return null;let t=JSON.parse(e),i=new Set;return t.forEach(e=>{n.has(e)&&i.add(e)}),i}catch(e){return console.warn(`Failed to parse from localStorage`,r,e),null}};const at=({children:e})=>{let[t,n]=(0,V.useState)(void 0),[r,i]=(0,V.useState)(void 0),[a,o]=(0,V.useState)(new Map),[s,c]=(0,V.useState)(!1),{types:l,selectedMap:u}=G(),{regions:d}=tt();return(0,V.useEffect)(()=>{if(!u||l.length===0)return;let e=new Map;l.forEach(t=>{t.subtypes.forEach(n=>{n.category=t.name,e.set(n.name,n)})}),o(e);let t=it(xe,u,new Set(e.keys()));if(t)n(t);else{let t=new Set;e.forEach((e,n)=>{(e.category===`location`||e.name===`monolithMaterial`&&u.type===`abyss`)&&t.add(n)}),n(t)}},[u,l]),(0,V.useEffect)(()=>{if(!u||d.length===0)return;let e=new Set(d.map(e=>e.name));i(it(ye,u,e)||e)},[u,d]),(0,V.useEffect)(()=>{rt(xe,u,t)},[u,t]),(0,V.useEffect)(()=>{rt(ye,u,r)},[u,r]),(0,W.jsx)(nt.Provider,{value:{visibleSubtypes:t,setVisibleSubtypes:n,visibleRegions:r,setVisibleRegions:i,allSubtypes:a,setAllSubtypes:o,handleToggleSubtype:e=>{n(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},handleToggleRegion:e=>{i(t=>{let n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},handleShowAllSubtypes:()=>{n(new Set(a.keys()))},handleHideAllSubtypes:()=>{n(new Set)},showBorders:s,handleToggleBorders:()=>{c(!s)}},children:e})};function ot(){let e=(0,V.useContext)(nt);if(!e)throw Error(`useGameData must be used inside <GameDataProvider>`);return e}var st=e(i(),1);function ct(e,t,n,r=!1){let i=40*t,a=(0,st.renderToString)((0,W.jsxs)(`div`,{style:{position:`relative`,width:`40px`,height:`40px`,display:`flex`,alignItems:`center`,justifyContent:`center`,opacity:n?.4:1},children:[r?(0,W.jsx)(`div`,{style:{width:`${i}px`,height:`${i}px`,borderRadius:`50%`,overflow:`hidden`,border:`1.5px solid rgba(255,255,255,0.9)`,boxShadow:`0 0 6px rgba(0,0,0,0.6)`,display:`flex`,alignItems:`center`,justifyContent:`center`,backgroundColor:`rgba(0,0,0,0.4)`},children:(0,W.jsx)(`img`,{src:e,alt:``,style:{width:`100%`,height:`100%`,objectFit:`cover`,pointerEvents:`none`}})}):(0,W.jsx)(`img`,{src:e,alt:``,style:{width:`${i}px`,height:`${i}px`,objectFit:`contain`,pointerEvents:`none`,zIndex:1e3}}),n&&(0,W.jsx)(P,{icon:v,style:{position:`absolute`,fontSize:`12px`,right:`-2px`,bottom:`-2px`,color:`#22c55e`}})]}));return Ke.default.divIcon({html:a,className:``,iconSize:[40,40],iconAnchor:[40/2,40/2],popupAnchor:[0,-10]})}var lt=e(m(),1),ut=(0,V.memo)(({marker:e,onSelectMarker:t})=>{let{selectedMap:n,types:r}=G(),{allSubtypes:i}=ot(),{showLabels:o,completedBySubtype:s}=tt(),{t:c}=R();if(!n)return null;let l=i.get(e.subtype),u=r.find(e=>e.name===l?.category),d=c(`types:subtypes.${l?.name}.name`),f=l?.iconScale||1.25,m=!!l?.hideTooltip,h=!1;l?.name&&s[l.name]&&(h=s[l.name].has(e.indexInSubtype));let g=le(e.icon||l?.icon||``,n),_;_=u?.name===`creature`?ct(g,.9,h,!0):ct(g,f,h);let v=e.localizedName||e.name||d;return(0,W.jsx)(a,{position:new lt.default.LatLng(e.y,e.x),icon:_,eventHandlers:{click:()=>{console.log(`clicked`),t?.(e.id)}},children:o&&!m&&(0,W.jsx)(p,{permanent:!0,direction:`top`,offset:[0,-15],className:`game-marker-tooltip`,children:v})})}),dt=e(m(),1),ft=class extends dt.default.TileLayer{constructor(e){e.tileSize=e.selectedMap.tileWidth,super(``,e),this.gameOptions=e}getTileUrl(e){let{selectedMap:t,isWatermark:n}=this.gameOptions,r=e.x,i=t.tilesCountY+e.y;if(r<0||i<0||r>=t.tilesCountX||i>=t.tilesCountY)return``;if(n)return B(`images/watermark.webp`);let a=String(r).padStart(2,`0`),o=String(i).padStart(2,`0`);return B(`UI/Map/WorldMap/${t.name}/Res/${t.name}_${a}_${o}.webp`)}},pt=({selectedMap:e})=>{let t=o();return(0,V.useEffect)(()=>{let n=new ft({selectedMap:e,noWrap:!0,minZoom:t.getMinZoom(),maxZoom:t.getMaxZoom(),maxNativeZoom:0,minNativeZoom:0});n.addTo(t);let r=new ft({selectedMap:e,isWatermark:!0,noWrap:!0,minZoom:t.getMinZoom(),maxZoom:t.getMaxZoom(),maxNativeZoom:0,minNativeZoom:0,opacity:.2});return r.addTo(t),()=>{console.log(`[GameMapTiles] useEffect cleanup`),t.removeLayer(n),t.removeLayer(r)}},[t,e]),null},mt=[`#ff3c3c`,`#3cd23c`,`#3c78ff`,`#ffd200`];function ht(e){let t=0;for(let n=0;n<e.length;n++)t=t*31+e.charCodeAt(n)|0;return Math.abs(t)%mt.length}var gt=([e,t])=>[t,e],_t=({hoveredRegion:e,setHoveredRegion:t})=>{let{regions:n}=tt(),{showBorders:r}=ot();function i(e,t){let n=`${e}`,r=`${t}`;return n<r?`${n}|${r}`:`${r}|${n}`}let a=(0,V.useMemo)(()=>{let e=new Map;return n.forEach(t=>{t.borders.forEach(n=>{for(let r=0;r<n.length-1;r++){let a=n[r],o=n[r+1],s=i(a,o),c=[gt(a),gt(o)];e.has(s)?e.get(s).regions.push(t.name):e.set(s,{positions:c,regions:[t.name]})}})}),[...e.entries()].map(([e,t])=>({key:e,positions:t.positions,regions:t.regions,color:mt[ht(t.regions[0])]}))},[n]);return(0,W.jsxs)(f,{children:[n.map(e=>e.borders.map((n,r)=>(0,W.jsx)(s,{positions:n.map(gt),pathOptions:{color:`transparent`,fillOpacity:0},eventHandlers:{mouseover:()=>t(e),mouseout:()=>t(void 0)}},`${e.name}-hit-${r}`))),r?a.map(t=>(0,W.jsx)(d,{positions:t.positions,pathOptions:e&&t.regions.includes(e.name)?{color:`#ffffff`,weight:3,opacity:1,dashArray:`1 0`}:{color:`#ffffff`,weight:3,opacity:.5,dashArray:`8 5`},interactive:!1},t.key)):null]})},K=[];for(let e=0;e<256;++e)K.push((e+256).toString(16).slice(1));function vt(e,t=0){return(K[e[t+0]]+K[e[t+1]]+K[e[t+2]]+K[e[t+3]]+`-`+K[e[t+4]]+K[e[t+5]]+`-`+K[e[t+6]]+K[e[t+7]]+`-`+K[e[t+8]]+K[e[t+9]]+`-`+K[e[t+10]]+K[e[t+11]]+K[e[t+12]]+K[e[t+13]]+K[e[t+14]]+K[e[t+15]]).toLowerCase()}var yt,bt=new Uint8Array(16);function xt(){if(!yt){if(typeof crypto>`u`||!crypto.getRandomValues)throw Error(`crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported`);yt=crypto.getRandomValues.bind(crypto)}return yt(bt)}var St={randomUUID:typeof crypto<`u`&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Ct(e,t,n){e||={};let r=e.random??e.rng?.()??xt();if(r.length<16)throw Error(`Random bytes length must be >= 16`);if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,t){if(n||=0,n<0||n+16>t.length)throw RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=r[e];return t}return vt(r)}function wt(e,t,n){return St.randomUUID&&!t&&!e?St.randomUUID():Ct(e,t,n)}var Tt=wt,Et=e(Ce(),1),Dt=`aion2.userMarkers.v1.`,Ot=(0,V.createContext)(null);const kt=({children:e})=>{let{selectedMap:t}=G(),[n,r]=(0,V.useState)(!1),[i,a]=(0,V.useState)([]),[o,s]=(0,V.useState)({}),[c,l]=(0,V.useState)(null),{fetchWithAuth:u}=ue(),[d,f]=(0,V.useState)(!1),p=(0,V.useCallback)(e=>`${Dt}${e}`,[]);(0,V.useEffect)(()=>{(async()=>{if(!t){a([]),l(null);return}let e=new Map;try{let n=localStorage.getItem(p(t.name));n&&JSON.parse(n).forEach(t=>{t.type===`local`&&e.set(t.id,t)})}catch(e){console.error(e)}try{let n=await u(`/maps/${t?.name}/marker_feedbacks`,{method:`GET`,headers:{"Content-Type":`application/json`}});if(n.ok){let t=await n.json();t.errorCode===`Success`&&(console.log(t.data.results),t.data.results.forEach(t=>{let n={id:t.id,markerId:t.markerId,subtype:t.subtypeId,mapId:t.mapId,x:t.x,y:t.y,name:t.name,description:t.description,image:t.image?.s3Key||``,type:t.type===`create`?`uploaded`:`feedback`,status:t.status,reply:t.reply};e.set(n.id,n)}))}}catch(e){console.error(e)}let n=[...e.values()];a(n),s((0,Et.keyBy)(n.filter(e=>e.type===`feedback`),`markerId`))})()},[t,p,u]),(0,V.useEffect)(()=>{t&&localStorage.setItem(p(t.name),JSON.stringify(i.filter(e=>e.type===`local`)))},[i,t,p]);let m=(0,V.useCallback)((e,n)=>{if(!t)return;let i={id:Tt(),markerId:``,subtype:``,mapId:t.id,x:e,y:n,name:``,description:``,image:``,type:`local`,localType:`fox`};a(e=>[...e,i]),l(i),r(!1)},[t]),h=(0,V.useCallback)(e=>{a(t=>[...t,e]),s(t=>({...t,[e.markerId]:e}))},[]),g=(0,V.useCallback)(e=>{a(t=>t.map(t=>t.id===e.id?e:t)),s(t=>({...t,[e.markerId]:e}))},[]),_=(0,V.useCallback)(e=>{a(t=>t.filter(t=>t.id!==e)),l(null)},[]);return(0,W.jsx)(Ot.Provider,{value:{pickMode:n,setPickMode:r,userMarkers:i,userMarkersByMarkerId:o,createMarker:m,createMarkerRemote:h,updateMarker:g,deleteMarker:_,editingMarker:c,setEditingMarker:l,hideUserMarkers:d,setHideUserMarkers:f},children:e})};function At(){let e=(0,V.useContext)(Ot);if(!e)throw Error(`useUserMarkers must be used inside <UserMarkersProvider>`);return e}const jt={completed:`images/Markers/Completed.svg`,location:`images/Markers/Location.svg`,fox:`images/Markers/Fox.svg`,favorite:`images/Markers/Favorite.svg`,gathering:`images/Markers/Gathering.svg`,creature:`images/Markers/Creature.svg`},Mt=[`fox`,`location`,`favorite`,`gathering`,`creature`,`completed`];function Nt(e){return e.type!==`local`||!e.localType?null:jt[e.localType]??null}var Pt=e(m(),1),Ft=V.memo(({marker:e})=>{let{setEditingMarker:t}=At(),{selectedMap:n}=G(),{allSubtypes:r}=ot(),{t:i}=R();if(!n)return null;let o=[...r.values()].find(t=>t.id===e.subtype),s=o?.icon?le(o.icon,n):le(``,n),c=e.type===`local`?Nt(e):null,l=c?B(c):s,u=c?1:o?.iconScale??1.25,d=40*u,f=[`w-full h-full`,`rounded-full`,`border border-white`,`flex items-center justify-center`,`shrink-0`,`bg-[radial-gradient(50%_50%_at_50%_50%,_#2E97FF_75%,_rgba(22,23,23,0.7)_76%)]`].join(` `),m=e.type===`local`?new Pt.default.DivIcon({className:``,html:`
            <div class="${f}">
              <img
                src="${l}"
                class="w-[${d*.7}px] h-[${d*.7}px] object-contain pointer-events-none select-none"
                draggable="false"
                alt="${e.localType}"
              />
            </div>
          `,iconSize:[d,d],iconAnchor:[d/2,d/2],popupAnchor:[0,-d/2]}):ct(l,u,!1);return(0,W.jsx)(a,{position:[e.y,e.x],icon:m,eventHandlers:{click:()=>t(e)},children:(0,W.jsx)(p,{permanent:!0,direction:`top`,offset:[0,-d/2],className:`game-marker-tooltip`,children:i(`common:markerActions.userMarker`,`User Marker`)})})}),It=t(((e,t)=>{t.exports=`SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED`})),Lt=t(((e,t)=>{var n=It();function r(){}function i(){}i.resetWarningCache=r,t.exports=function(){function e(e,t,r,i,a,o){if(o!==n){var s=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name=`Invariant Violation`,s}}e.isRequired=e;function t(){return e}var a={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:r};return a.PropTypes=a,a}})),Rt=t(((e,t)=>{t.exports=Lt()()}));const zt=new Map([[`1km`,`application/vnd.1000minds.decision-model+xml`],[`3dml`,`text/vnd.in3d.3dml`],[`3ds`,`image/x-3ds`],[`3g2`,`video/3gpp2`],[`3gp`,`video/3gp`],[`3gpp`,`video/3gpp`],[`3mf`,`model/3mf`],[`7z`,`application/x-7z-compressed`],[`7zip`,`application/x-7z-compressed`],[`123`,`application/vnd.lotus-1-2-3`],[`aab`,`application/x-authorware-bin`],[`aac`,`audio/x-acc`],[`aam`,`application/x-authorware-map`],[`aas`,`application/x-authorware-seg`],[`abw`,`application/x-abiword`],[`ac`,`application/vnd.nokia.n-gage.ac+xml`],[`ac3`,`audio/ac3`],[`acc`,`application/vnd.americandynamics.acc`],[`ace`,`application/x-ace-compressed`],[`acu`,`application/vnd.acucobol`],[`acutc`,`application/vnd.acucorp`],[`adp`,`audio/adpcm`],[`aep`,`application/vnd.audiograph`],[`afm`,`application/x-font-type1`],[`afp`,`application/vnd.ibm.modcap`],[`ahead`,`application/vnd.ahead.space`],[`ai`,`application/pdf`],[`aif`,`audio/x-aiff`],[`aifc`,`audio/x-aiff`],[`aiff`,`audio/x-aiff`],[`air`,`application/vnd.adobe.air-application-installer-package+zip`],[`ait`,`application/vnd.dvb.ait`],[`ami`,`application/vnd.amiga.ami`],[`amr`,`audio/amr`],[`apk`,`application/vnd.android.package-archive`],[`apng`,`image/apng`],[`appcache`,`text/cache-manifest`],[`application`,`application/x-ms-application`],[`apr`,`application/vnd.lotus-approach`],[`arc`,`application/x-freearc`],[`arj`,`application/x-arj`],[`asc`,`application/pgp-signature`],[`asf`,`video/x-ms-asf`],[`asm`,`text/x-asm`],[`aso`,`application/vnd.accpac.simply.aso`],[`asx`,`video/x-ms-asf`],[`atc`,`application/vnd.acucorp`],[`atom`,`application/atom+xml`],[`atomcat`,`application/atomcat+xml`],[`atomdeleted`,`application/atomdeleted+xml`],[`atomsvc`,`application/atomsvc+xml`],[`atx`,`application/vnd.antix.game-component`],[`au`,`audio/x-au`],[`avi`,`video/x-msvideo`],[`avif`,`image/avif`],[`aw`,`application/applixware`],[`azf`,`application/vnd.airzip.filesecure.azf`],[`azs`,`application/vnd.airzip.filesecure.azs`],[`azv`,`image/vnd.airzip.accelerator.azv`],[`azw`,`application/vnd.amazon.ebook`],[`b16`,`image/vnd.pco.b16`],[`bat`,`application/x-msdownload`],[`bcpio`,`application/x-bcpio`],[`bdf`,`application/x-font-bdf`],[`bdm`,`application/vnd.syncml.dm+wbxml`],[`bdoc`,`application/x-bdoc`],[`bed`,`application/vnd.realvnc.bed`],[`bh2`,`application/vnd.fujitsu.oasysprs`],[`bin`,`application/octet-stream`],[`blb`,`application/x-blorb`],[`blorb`,`application/x-blorb`],[`bmi`,`application/vnd.bmi`],[`bmml`,`application/vnd.balsamiq.bmml+xml`],[`bmp`,`image/bmp`],[`book`,`application/vnd.framemaker`],[`box`,`application/vnd.previewsystems.box`],[`boz`,`application/x-bzip2`],[`bpk`,`application/octet-stream`],[`bpmn`,`application/octet-stream`],[`bsp`,`model/vnd.valve.source.compiled-map`],[`btif`,`image/prs.btif`],[`buffer`,`application/octet-stream`],[`bz`,`application/x-bzip`],[`bz2`,`application/x-bzip2`],[`c`,`text/x-c`],[`c4d`,`application/vnd.clonk.c4group`],[`c4f`,`application/vnd.clonk.c4group`],[`c4g`,`application/vnd.clonk.c4group`],[`c4p`,`application/vnd.clonk.c4group`],[`c4u`,`application/vnd.clonk.c4group`],[`c11amc`,`application/vnd.cluetrust.cartomobile-config`],[`c11amz`,`application/vnd.cluetrust.cartomobile-config-pkg`],[`cab`,`application/vnd.ms-cab-compressed`],[`caf`,`audio/x-caf`],[`cap`,`application/vnd.tcpdump.pcap`],[`car`,`application/vnd.curl.car`],[`cat`,`application/vnd.ms-pki.seccat`],[`cb7`,`application/x-cbr`],[`cba`,`application/x-cbr`],[`cbr`,`application/x-cbr`],[`cbt`,`application/x-cbr`],[`cbz`,`application/x-cbr`],[`cc`,`text/x-c`],[`cco`,`application/x-cocoa`],[`cct`,`application/x-director`],[`ccxml`,`application/ccxml+xml`],[`cdbcmsg`,`application/vnd.contact.cmsg`],[`cda`,`application/x-cdf`],[`cdf`,`application/x-netcdf`],[`cdfx`,`application/cdfx+xml`],[`cdkey`,`application/vnd.mediastation.cdkey`],[`cdmia`,`application/cdmi-capability`],[`cdmic`,`application/cdmi-container`],[`cdmid`,`application/cdmi-domain`],[`cdmio`,`application/cdmi-object`],[`cdmiq`,`application/cdmi-queue`],[`cdr`,`application/cdr`],[`cdx`,`chemical/x-cdx`],[`cdxml`,`application/vnd.chemdraw+xml`],[`cdy`,`application/vnd.cinderella`],[`cer`,`application/pkix-cert`],[`cfs`,`application/x-cfs-compressed`],[`cgm`,`image/cgm`],[`chat`,`application/x-chat`],[`chm`,`application/vnd.ms-htmlhelp`],[`chrt`,`application/vnd.kde.kchart`],[`cif`,`chemical/x-cif`],[`cii`,`application/vnd.anser-web-certificate-issue-initiation`],[`cil`,`application/vnd.ms-artgalry`],[`cjs`,`application/node`],[`cla`,`application/vnd.claymore`],[`class`,`application/octet-stream`],[`clkk`,`application/vnd.crick.clicker.keyboard`],[`clkp`,`application/vnd.crick.clicker.palette`],[`clkt`,`application/vnd.crick.clicker.template`],[`clkw`,`application/vnd.crick.clicker.wordbank`],[`clkx`,`application/vnd.crick.clicker`],[`clp`,`application/x-msclip`],[`cmc`,`application/vnd.cosmocaller`],[`cmdf`,`chemical/x-cmdf`],[`cml`,`chemical/x-cml`],[`cmp`,`application/vnd.yellowriver-custom-menu`],[`cmx`,`image/x-cmx`],[`cod`,`application/vnd.rim.cod`],[`coffee`,`text/coffeescript`],[`com`,`application/x-msdownload`],[`conf`,`text/plain`],[`cpio`,`application/x-cpio`],[`cpp`,`text/x-c`],[`cpt`,`application/mac-compactpro`],[`crd`,`application/x-mscardfile`],[`crl`,`application/pkix-crl`],[`crt`,`application/x-x509-ca-cert`],[`crx`,`application/x-chrome-extension`],[`cryptonote`,`application/vnd.rig.cryptonote`],[`csh`,`application/x-csh`],[`csl`,`application/vnd.citationstyles.style+xml`],[`csml`,`chemical/x-csml`],[`csp`,`application/vnd.commonspace`],[`csr`,`application/octet-stream`],[`css`,`text/css`],[`cst`,`application/x-director`],[`csv`,`text/csv`],[`cu`,`application/cu-seeme`],[`curl`,`text/vnd.curl`],[`cww`,`application/prs.cww`],[`cxt`,`application/x-director`],[`cxx`,`text/x-c`],[`dae`,`model/vnd.collada+xml`],[`daf`,`application/vnd.mobius.daf`],[`dart`,`application/vnd.dart`],[`dataless`,`application/vnd.fdsn.seed`],[`davmount`,`application/davmount+xml`],[`dbf`,`application/vnd.dbf`],[`dbk`,`application/docbook+xml`],[`dcr`,`application/x-director`],[`dcurl`,`text/vnd.curl.dcurl`],[`dd2`,`application/vnd.oma.dd2+xml`],[`ddd`,`application/vnd.fujixerox.ddd`],[`ddf`,`application/vnd.syncml.dmddf+xml`],[`dds`,`image/vnd.ms-dds`],[`deb`,`application/x-debian-package`],[`def`,`text/plain`],[`deploy`,`application/octet-stream`],[`der`,`application/x-x509-ca-cert`],[`dfac`,`application/vnd.dreamfactory`],[`dgc`,`application/x-dgc-compressed`],[`dic`,`text/x-c`],[`dir`,`application/x-director`],[`dis`,`application/vnd.mobius.dis`],[`disposition-notification`,`message/disposition-notification`],[`dist`,`application/octet-stream`],[`distz`,`application/octet-stream`],[`djv`,`image/vnd.djvu`],[`djvu`,`image/vnd.djvu`],[`dll`,`application/octet-stream`],[`dmg`,`application/x-apple-diskimage`],[`dmn`,`application/octet-stream`],[`dmp`,`application/vnd.tcpdump.pcap`],[`dms`,`application/octet-stream`],[`dna`,`application/vnd.dna`],[`doc`,`application/msword`],[`docm`,`application/vnd.ms-word.template.macroEnabled.12`],[`docx`,`application/vnd.openxmlformats-officedocument.wordprocessingml.document`],[`dot`,`application/msword`],[`dotm`,`application/vnd.ms-word.template.macroEnabled.12`],[`dotx`,`application/vnd.openxmlformats-officedocument.wordprocessingml.template`],[`dp`,`application/vnd.osgi.dp`],[`dpg`,`application/vnd.dpgraph`],[`dra`,`audio/vnd.dra`],[`drle`,`image/dicom-rle`],[`dsc`,`text/prs.lines.tag`],[`dssc`,`application/dssc+der`],[`dtb`,`application/x-dtbook+xml`],[`dtd`,`application/xml-dtd`],[`dts`,`audio/vnd.dts`],[`dtshd`,`audio/vnd.dts.hd`],[`dump`,`application/octet-stream`],[`dvb`,`video/vnd.dvb.file`],[`dvi`,`application/x-dvi`],[`dwd`,`application/atsc-dwd+xml`],[`dwf`,`model/vnd.dwf`],[`dwg`,`image/vnd.dwg`],[`dxf`,`image/vnd.dxf`],[`dxp`,`application/vnd.spotfire.dxp`],[`dxr`,`application/x-director`],[`ear`,`application/java-archive`],[`ecelp4800`,`audio/vnd.nuera.ecelp4800`],[`ecelp7470`,`audio/vnd.nuera.ecelp7470`],[`ecelp9600`,`audio/vnd.nuera.ecelp9600`],[`ecma`,`application/ecmascript`],[`edm`,`application/vnd.novadigm.edm`],[`edx`,`application/vnd.novadigm.edx`],[`efif`,`application/vnd.picsel`],[`ei6`,`application/vnd.pg.osasli`],[`elc`,`application/octet-stream`],[`emf`,`image/emf`],[`eml`,`message/rfc822`],[`emma`,`application/emma+xml`],[`emotionml`,`application/emotionml+xml`],[`emz`,`application/x-msmetafile`],[`eol`,`audio/vnd.digital-winds`],[`eot`,`application/vnd.ms-fontobject`],[`eps`,`application/postscript`],[`epub`,`application/epub+zip`],[`es`,`application/ecmascript`],[`es3`,`application/vnd.eszigno3+xml`],[`esa`,`application/vnd.osgi.subsystem`],[`esf`,`application/vnd.epson.esf`],[`et3`,`application/vnd.eszigno3+xml`],[`etx`,`text/x-setext`],[`eva`,`application/x-eva`],[`evy`,`application/x-envoy`],[`exe`,`application/octet-stream`],[`exi`,`application/exi`],[`exp`,`application/express`],[`exr`,`image/aces`],[`ext`,`application/vnd.novadigm.ext`],[`ez`,`application/andrew-inset`],[`ez2`,`application/vnd.ezpix-album`],[`ez3`,`application/vnd.ezpix-package`],[`f`,`text/x-fortran`],[`f4v`,`video/mp4`],[`f77`,`text/x-fortran`],[`f90`,`text/x-fortran`],[`fbs`,`image/vnd.fastbidsheet`],[`fcdt`,`application/vnd.adobe.formscentral.fcdt`],[`fcs`,`application/vnd.isac.fcs`],[`fdf`,`application/vnd.fdf`],[`fdt`,`application/fdt+xml`],[`fe_launch`,`application/vnd.denovo.fcselayout-link`],[`fg5`,`application/vnd.fujitsu.oasysgp`],[`fgd`,`application/x-director`],[`fh`,`image/x-freehand`],[`fh4`,`image/x-freehand`],[`fh5`,`image/x-freehand`],[`fh7`,`image/x-freehand`],[`fhc`,`image/x-freehand`],[`fig`,`application/x-xfig`],[`fits`,`image/fits`],[`flac`,`audio/x-flac`],[`fli`,`video/x-fli`],[`flo`,`application/vnd.micrografx.flo`],[`flv`,`video/x-flv`],[`flw`,`application/vnd.kde.kivio`],[`flx`,`text/vnd.fmi.flexstor`],[`fly`,`text/vnd.fly`],[`fm`,`application/vnd.framemaker`],[`fnc`,`application/vnd.frogans.fnc`],[`fo`,`application/vnd.software602.filler.form+xml`],[`for`,`text/x-fortran`],[`fpx`,`image/vnd.fpx`],[`frame`,`application/vnd.framemaker`],[`fsc`,`application/vnd.fsc.weblaunch`],[`fst`,`image/vnd.fst`],[`ftc`,`application/vnd.fluxtime.clip`],[`fti`,`application/vnd.anser-web-funds-transfer-initiation`],[`fvt`,`video/vnd.fvt`],[`fxp`,`application/vnd.adobe.fxp`],[`fxpl`,`application/vnd.adobe.fxp`],[`fzs`,`application/vnd.fuzzysheet`],[`g2w`,`application/vnd.geoplan`],[`g3`,`image/g3fax`],[`g3w`,`application/vnd.geospace`],[`gac`,`application/vnd.groove-account`],[`gam`,`application/x-tads`],[`gbr`,`application/rpki-ghostbusters`],[`gca`,`application/x-gca-compressed`],[`gdl`,`model/vnd.gdl`],[`gdoc`,`application/vnd.google-apps.document`],[`geo`,`application/vnd.dynageo`],[`geojson`,`application/geo+json`],[`gex`,`application/vnd.geometry-explorer`],[`ggb`,`application/vnd.geogebra.file`],[`ggt`,`application/vnd.geogebra.tool`],[`ghf`,`application/vnd.groove-help`],[`gif`,`image/gif`],[`gim`,`application/vnd.groove-identity-message`],[`glb`,`model/gltf-binary`],[`gltf`,`model/gltf+json`],[`gml`,`application/gml+xml`],[`gmx`,`application/vnd.gmx`],[`gnumeric`,`application/x-gnumeric`],[`gpg`,`application/gpg-keys`],[`gph`,`application/vnd.flographit`],[`gpx`,`application/gpx+xml`],[`gqf`,`application/vnd.grafeq`],[`gqs`,`application/vnd.grafeq`],[`gram`,`application/srgs`],[`gramps`,`application/x-gramps-xml`],[`gre`,`application/vnd.geometry-explorer`],[`grv`,`application/vnd.groove-injector`],[`grxml`,`application/srgs+xml`],[`gsf`,`application/x-font-ghostscript`],[`gsheet`,`application/vnd.google-apps.spreadsheet`],[`gslides`,`application/vnd.google-apps.presentation`],[`gtar`,`application/x-gtar`],[`gtm`,`application/vnd.groove-tool-message`],[`gtw`,`model/vnd.gtw`],[`gv`,`text/vnd.graphviz`],[`gxf`,`application/gxf`],[`gxt`,`application/vnd.geonext`],[`gz`,`application/gzip`],[`gzip`,`application/gzip`],[`h`,`text/x-c`],[`h261`,`video/h261`],[`h263`,`video/h263`],[`h264`,`video/h264`],[`hal`,`application/vnd.hal+xml`],[`hbci`,`application/vnd.hbci`],[`hbs`,`text/x-handlebars-template`],[`hdd`,`application/x-virtualbox-hdd`],[`hdf`,`application/x-hdf`],[`heic`,`image/heic`],[`heics`,`image/heic-sequence`],[`heif`,`image/heif`],[`heifs`,`image/heif-sequence`],[`hej2`,`image/hej2k`],[`held`,`application/atsc-held+xml`],[`hh`,`text/x-c`],[`hjson`,`application/hjson`],[`hlp`,`application/winhlp`],[`hpgl`,`application/vnd.hp-hpgl`],[`hpid`,`application/vnd.hp-hpid`],[`hps`,`application/vnd.hp-hps`],[`hqx`,`application/mac-binhex40`],[`hsj2`,`image/hsj2`],[`htc`,`text/x-component`],[`htke`,`application/vnd.kenameaapp`],[`htm`,`text/html`],[`html`,`text/html`],[`hvd`,`application/vnd.yamaha.hv-dic`],[`hvp`,`application/vnd.yamaha.hv-voice`],[`hvs`,`application/vnd.yamaha.hv-script`],[`i2g`,`application/vnd.intergeo`],[`icc`,`application/vnd.iccprofile`],[`ice`,`x-conference/x-cooltalk`],[`icm`,`application/vnd.iccprofile`],[`ico`,`image/x-icon`],[`ics`,`text/calendar`],[`ief`,`image/ief`],[`ifb`,`text/calendar`],[`ifm`,`application/vnd.shana.informed.formdata`],[`iges`,`model/iges`],[`igl`,`application/vnd.igloader`],[`igm`,`application/vnd.insors.igm`],[`igs`,`model/iges`],[`igx`,`application/vnd.micrografx.igx`],[`iif`,`application/vnd.shana.informed.interchange`],[`img`,`application/octet-stream`],[`imp`,`application/vnd.accpac.simply.imp`],[`ims`,`application/vnd.ms-ims`],[`in`,`text/plain`],[`ini`,`text/plain`],[`ink`,`application/inkml+xml`],[`inkml`,`application/inkml+xml`],[`install`,`application/x-install-instructions`],[`iota`,`application/vnd.astraea-software.iota`],[`ipfix`,`application/ipfix`],[`ipk`,`application/vnd.shana.informed.package`],[`irm`,`application/vnd.ibm.rights-management`],[`irp`,`application/vnd.irepository.package+xml`],[`iso`,`application/x-iso9660-image`],[`itp`,`application/vnd.shana.informed.formtemplate`],[`its`,`application/its+xml`],[`ivp`,`application/vnd.immervision-ivp`],[`ivu`,`application/vnd.immervision-ivu`],[`jad`,`text/vnd.sun.j2me.app-descriptor`],[`jade`,`text/jade`],[`jam`,`application/vnd.jam`],[`jar`,`application/java-archive`],[`jardiff`,`application/x-java-archive-diff`],[`java`,`text/x-java-source`],[`jhc`,`image/jphc`],[`jisp`,`application/vnd.jisp`],[`jls`,`image/jls`],[`jlt`,`application/vnd.hp-jlyt`],[`jng`,`image/x-jng`],[`jnlp`,`application/x-java-jnlp-file`],[`joda`,`application/vnd.joost.joda-archive`],[`jp2`,`image/jp2`],[`jpe`,`image/jpeg`],[`jpeg`,`image/jpeg`],[`jpf`,`image/jpx`],[`jpg`,`image/jpeg`],[`jpg2`,`image/jp2`],[`jpgm`,`video/jpm`],[`jpgv`,`video/jpeg`],[`jph`,`image/jph`],[`jpm`,`video/jpm`],[`jpx`,`image/jpx`],[`js`,`application/javascript`],[`json`,`application/json`],[`json5`,`application/json5`],[`jsonld`,`application/ld+json`],[`jsonl`,`application/jsonl`],[`jsonml`,`application/jsonml+json`],[`jsx`,`text/jsx`],[`jxr`,`image/jxr`],[`jxra`,`image/jxra`],[`jxrs`,`image/jxrs`],[`jxs`,`image/jxs`],[`jxsc`,`image/jxsc`],[`jxsi`,`image/jxsi`],[`jxss`,`image/jxss`],[`kar`,`audio/midi`],[`karbon`,`application/vnd.kde.karbon`],[`kdb`,`application/octet-stream`],[`kdbx`,`application/x-keepass2`],[`key`,`application/x-iwork-keynote-sffkey`],[`kfo`,`application/vnd.kde.kformula`],[`kia`,`application/vnd.kidspiration`],[`kml`,`application/vnd.google-earth.kml+xml`],[`kmz`,`application/vnd.google-earth.kmz`],[`kne`,`application/vnd.kinar`],[`knp`,`application/vnd.kinar`],[`kon`,`application/vnd.kde.kontour`],[`kpr`,`application/vnd.kde.kpresenter`],[`kpt`,`application/vnd.kde.kpresenter`],[`kpxx`,`application/vnd.ds-keypoint`],[`ksp`,`application/vnd.kde.kspread`],[`ktr`,`application/vnd.kahootz`],[`ktx`,`image/ktx`],[`ktx2`,`image/ktx2`],[`ktz`,`application/vnd.kahootz`],[`kwd`,`application/vnd.kde.kword`],[`kwt`,`application/vnd.kde.kword`],[`lasxml`,`application/vnd.las.las+xml`],[`latex`,`application/x-latex`],[`lbd`,`application/vnd.llamagraphics.life-balance.desktop`],[`lbe`,`application/vnd.llamagraphics.life-balance.exchange+xml`],[`les`,`application/vnd.hhe.lesson-player`],[`less`,`text/less`],[`lgr`,`application/lgr+xml`],[`lha`,`application/octet-stream`],[`link66`,`application/vnd.route66.link66+xml`],[`list`,`text/plain`],[`list3820`,`application/vnd.ibm.modcap`],[`listafp`,`application/vnd.ibm.modcap`],[`litcoffee`,`text/coffeescript`],[`lnk`,`application/x-ms-shortcut`],[`log`,`text/plain`],[`lostxml`,`application/lost+xml`],[`lrf`,`application/octet-stream`],[`lrm`,`application/vnd.ms-lrm`],[`ltf`,`application/vnd.frogans.ltf`],[`lua`,`text/x-lua`],[`luac`,`application/x-lua-bytecode`],[`lvp`,`audio/vnd.lucent.voice`],[`lwp`,`application/vnd.lotus-wordpro`],[`lzh`,`application/octet-stream`],[`m1v`,`video/mpeg`],[`m2a`,`audio/mpeg`],[`m2v`,`video/mpeg`],[`m3a`,`audio/mpeg`],[`m3u`,`text/plain`],[`m3u8`,`application/vnd.apple.mpegurl`],[`m4a`,`audio/x-m4a`],[`m4p`,`application/mp4`],[`m4s`,`video/iso.segment`],[`m4u`,`application/vnd.mpegurl`],[`m4v`,`video/x-m4v`],[`m13`,`application/x-msmediaview`],[`m14`,`application/x-msmediaview`],[`m21`,`application/mp21`],[`ma`,`application/mathematica`],[`mads`,`application/mads+xml`],[`maei`,`application/mmt-aei+xml`],[`mag`,`application/vnd.ecowin.chart`],[`maker`,`application/vnd.framemaker`],[`man`,`text/troff`],[`manifest`,`text/cache-manifest`],[`map`,`application/json`],[`mar`,`application/octet-stream`],[`markdown`,`text/markdown`],[`mathml`,`application/mathml+xml`],[`mb`,`application/mathematica`],[`mbk`,`application/vnd.mobius.mbk`],[`mbox`,`application/mbox`],[`mc1`,`application/vnd.medcalcdata`],[`mcd`,`application/vnd.mcd`],[`mcurl`,`text/vnd.curl.mcurl`],[`md`,`text/markdown`],[`mdb`,`application/x-msaccess`],[`mdi`,`image/vnd.ms-modi`],[`mdx`,`text/mdx`],[`me`,`text/troff`],[`mesh`,`model/mesh`],[`meta4`,`application/metalink4+xml`],[`metalink`,`application/metalink+xml`],[`mets`,`application/mets+xml`],[`mfm`,`application/vnd.mfmp`],[`mft`,`application/rpki-manifest`],[`mgp`,`application/vnd.osgeo.mapguide.package`],[`mgz`,`application/vnd.proteus.magazine`],[`mid`,`audio/midi`],[`midi`,`audio/midi`],[`mie`,`application/x-mie`],[`mif`,`application/vnd.mif`],[`mime`,`message/rfc822`],[`mj2`,`video/mj2`],[`mjp2`,`video/mj2`],[`mjs`,`application/javascript`],[`mk3d`,`video/x-matroska`],[`mka`,`audio/x-matroska`],[`mkd`,`text/x-markdown`],[`mks`,`video/x-matroska`],[`mkv`,`video/x-matroska`],[`mlp`,`application/vnd.dolby.mlp`],[`mmd`,`application/vnd.chipnuts.karaoke-mmd`],[`mmf`,`application/vnd.smaf`],[`mml`,`text/mathml`],[`mmr`,`image/vnd.fujixerox.edmics-mmr`],[`mng`,`video/x-mng`],[`mny`,`application/x-msmoney`],[`mobi`,`application/x-mobipocket-ebook`],[`mods`,`application/mods+xml`],[`mov`,`video/quicktime`],[`movie`,`video/x-sgi-movie`],[`mp2`,`audio/mpeg`],[`mp2a`,`audio/mpeg`],[`mp3`,`audio/mpeg`],[`mp4`,`video/mp4`],[`mp4a`,`audio/mp4`],[`mp4s`,`application/mp4`],[`mp4v`,`video/mp4`],[`mp21`,`application/mp21`],[`mpc`,`application/vnd.mophun.certificate`],[`mpd`,`application/dash+xml`],[`mpe`,`video/mpeg`],[`mpeg`,`video/mpeg`],[`mpg`,`video/mpeg`],[`mpg4`,`video/mp4`],[`mpga`,`audio/mpeg`],[`mpkg`,`application/vnd.apple.installer+xml`],[`mpm`,`application/vnd.blueice.multipass`],[`mpn`,`application/vnd.mophun.application`],[`mpp`,`application/vnd.ms-project`],[`mpt`,`application/vnd.ms-project`],[`mpy`,`application/vnd.ibm.minipay`],[`mqy`,`application/vnd.mobius.mqy`],[`mrc`,`application/marc`],[`mrcx`,`application/marcxml+xml`],[`ms`,`text/troff`],[`mscml`,`application/mediaservercontrol+xml`],[`mseed`,`application/vnd.fdsn.mseed`],[`mseq`,`application/vnd.mseq`],[`msf`,`application/vnd.epson.msf`],[`msg`,`application/vnd.ms-outlook`],[`msh`,`model/mesh`],[`msi`,`application/x-msdownload`],[`msl`,`application/vnd.mobius.msl`],[`msm`,`application/octet-stream`],[`msp`,`application/octet-stream`],[`msty`,`application/vnd.muvee.style`],[`mtl`,`model/mtl`],[`mts`,`model/vnd.mts`],[`mus`,`application/vnd.musician`],[`musd`,`application/mmt-usd+xml`],[`musicxml`,`application/vnd.recordare.musicxml+xml`],[`mvb`,`application/x-msmediaview`],[`mvt`,`application/vnd.mapbox-vector-tile`],[`mwf`,`application/vnd.mfer`],[`mxf`,`application/mxf`],[`mxl`,`application/vnd.recordare.musicxml`],[`mxmf`,`audio/mobile-xmf`],[`mxml`,`application/xv+xml`],[`mxs`,`application/vnd.triscape.mxs`],[`mxu`,`video/vnd.mpegurl`],[`n-gage`,`application/vnd.nokia.n-gage.symbian.install`],[`n3`,`text/n3`],[`nb`,`application/mathematica`],[`nbp`,`application/vnd.wolfram.player`],[`nc`,`application/x-netcdf`],[`ncx`,`application/x-dtbncx+xml`],[`nfo`,`text/x-nfo`],[`ngdat`,`application/vnd.nokia.n-gage.data`],[`nitf`,`application/vnd.nitf`],[`nlu`,`application/vnd.neurolanguage.nlu`],[`nml`,`application/vnd.enliven`],[`nnd`,`application/vnd.noblenet-directory`],[`nns`,`application/vnd.noblenet-sealer`],[`nnw`,`application/vnd.noblenet-web`],[`npx`,`image/vnd.net-fpx`],[`nq`,`application/n-quads`],[`nsc`,`application/x-conference`],[`nsf`,`application/vnd.lotus-notes`],[`nt`,`application/n-triples`],[`ntf`,`application/vnd.nitf`],[`numbers`,`application/x-iwork-numbers-sffnumbers`],[`nzb`,`application/x-nzb`],[`oa2`,`application/vnd.fujitsu.oasys2`],[`oa3`,`application/vnd.fujitsu.oasys3`],[`oas`,`application/vnd.fujitsu.oasys`],[`obd`,`application/x-msbinder`],[`obgx`,`application/vnd.openblox.game+xml`],[`obj`,`model/obj`],[`oda`,`application/oda`],[`odb`,`application/vnd.oasis.opendocument.database`],[`odc`,`application/vnd.oasis.opendocument.chart`],[`odf`,`application/vnd.oasis.opendocument.formula`],[`odft`,`application/vnd.oasis.opendocument.formula-template`],[`odg`,`application/vnd.oasis.opendocument.graphics`],[`odi`,`application/vnd.oasis.opendocument.image`],[`odm`,`application/vnd.oasis.opendocument.text-master`],[`odp`,`application/vnd.oasis.opendocument.presentation`],[`ods`,`application/vnd.oasis.opendocument.spreadsheet`],[`odt`,`application/vnd.oasis.opendocument.text`],[`oga`,`audio/ogg`],[`ogex`,`model/vnd.opengex`],[`ogg`,`audio/ogg`],[`ogv`,`video/ogg`],[`ogx`,`application/ogg`],[`omdoc`,`application/omdoc+xml`],[`onepkg`,`application/onenote`],[`onetmp`,`application/onenote`],[`onetoc`,`application/onenote`],[`onetoc2`,`application/onenote`],[`opf`,`application/oebps-package+xml`],[`opml`,`text/x-opml`],[`oprc`,`application/vnd.palm`],[`opus`,`audio/ogg`],[`org`,`text/x-org`],[`osf`,`application/vnd.yamaha.openscoreformat`],[`osfpvg`,`application/vnd.yamaha.openscoreformat.osfpvg+xml`],[`osm`,`application/vnd.openstreetmap.data+xml`],[`otc`,`application/vnd.oasis.opendocument.chart-template`],[`otf`,`font/otf`],[`otg`,`application/vnd.oasis.opendocument.graphics-template`],[`oth`,`application/vnd.oasis.opendocument.text-web`],[`oti`,`application/vnd.oasis.opendocument.image-template`],[`otp`,`application/vnd.oasis.opendocument.presentation-template`],[`ots`,`application/vnd.oasis.opendocument.spreadsheet-template`],[`ott`,`application/vnd.oasis.opendocument.text-template`],[`ova`,`application/x-virtualbox-ova`],[`ovf`,`application/x-virtualbox-ovf`],[`owl`,`application/rdf+xml`],[`oxps`,`application/oxps`],[`oxt`,`application/vnd.openofficeorg.extension`],[`p`,`text/x-pascal`],[`p7a`,`application/x-pkcs7-signature`],[`p7b`,`application/x-pkcs7-certificates`],[`p7c`,`application/pkcs7-mime`],[`p7m`,`application/pkcs7-mime`],[`p7r`,`application/x-pkcs7-certreqresp`],[`p7s`,`application/pkcs7-signature`],[`p8`,`application/pkcs8`],[`p10`,`application/x-pkcs10`],[`p12`,`application/x-pkcs12`],[`pac`,`application/x-ns-proxy-autoconfig`],[`pages`,`application/x-iwork-pages-sffpages`],[`pas`,`text/x-pascal`],[`paw`,`application/vnd.pawaafile`],[`pbd`,`application/vnd.powerbuilder6`],[`pbm`,`image/x-portable-bitmap`],[`pcap`,`application/vnd.tcpdump.pcap`],[`pcf`,`application/x-font-pcf`],[`pcl`,`application/vnd.hp-pcl`],[`pclxl`,`application/vnd.hp-pclxl`],[`pct`,`image/x-pict`],[`pcurl`,`application/vnd.curl.pcurl`],[`pcx`,`image/x-pcx`],[`pdb`,`application/x-pilot`],[`pde`,`text/x-processing`],[`pdf`,`application/pdf`],[`pem`,`application/x-x509-user-cert`],[`pfa`,`application/x-font-type1`],[`pfb`,`application/x-font-type1`],[`pfm`,`application/x-font-type1`],[`pfr`,`application/font-tdpfr`],[`pfx`,`application/x-pkcs12`],[`pgm`,`image/x-portable-graymap`],[`pgn`,`application/x-chess-pgn`],[`pgp`,`application/pgp`],[`php`,`application/x-httpd-php`],[`php3`,`application/x-httpd-php`],[`php4`,`application/x-httpd-php`],[`phps`,`application/x-httpd-php-source`],[`phtml`,`application/x-httpd-php`],[`pic`,`image/x-pict`],[`pkg`,`application/octet-stream`],[`pki`,`application/pkixcmp`],[`pkipath`,`application/pkix-pkipath`],[`pkpass`,`application/vnd.apple.pkpass`],[`pl`,`application/x-perl`],[`plb`,`application/vnd.3gpp.pic-bw-large`],[`plc`,`application/vnd.mobius.plc`],[`plf`,`application/vnd.pocketlearn`],[`pls`,`application/pls+xml`],[`pm`,`application/x-perl`],[`pml`,`application/vnd.ctc-posml`],[`png`,`image/png`],[`pnm`,`image/x-portable-anymap`],[`portpkg`,`application/vnd.macports.portpkg`],[`pot`,`application/vnd.ms-powerpoint`],[`potm`,`application/vnd.ms-powerpoint.presentation.macroEnabled.12`],[`potx`,`application/vnd.openxmlformats-officedocument.presentationml.template`],[`ppa`,`application/vnd.ms-powerpoint`],[`ppam`,`application/vnd.ms-powerpoint.addin.macroEnabled.12`],[`ppd`,`application/vnd.cups-ppd`],[`ppm`,`image/x-portable-pixmap`],[`pps`,`application/vnd.ms-powerpoint`],[`ppsm`,`application/vnd.ms-powerpoint.slideshow.macroEnabled.12`],[`ppsx`,`application/vnd.openxmlformats-officedocument.presentationml.slideshow`],[`ppt`,`application/powerpoint`],[`pptm`,`application/vnd.ms-powerpoint.presentation.macroEnabled.12`],[`pptx`,`application/vnd.openxmlformats-officedocument.presentationml.presentation`],[`pqa`,`application/vnd.palm`],[`prc`,`application/x-pilot`],[`pre`,`application/vnd.lotus-freelance`],[`prf`,`application/pics-rules`],[`provx`,`application/provenance+xml`],[`ps`,`application/postscript`],[`psb`,`application/vnd.3gpp.pic-bw-small`],[`psd`,`application/x-photoshop`],[`psf`,`application/x-font-linux-psf`],[`pskcxml`,`application/pskc+xml`],[`pti`,`image/prs.pti`],[`ptid`,`application/vnd.pvi.ptid1`],[`pub`,`application/x-mspublisher`],[`pvb`,`application/vnd.3gpp.pic-bw-var`],[`pwn`,`application/vnd.3m.post-it-notes`],[`pya`,`audio/vnd.ms-playready.media.pya`],[`pyv`,`video/vnd.ms-playready.media.pyv`],[`qam`,`application/vnd.epson.quickanime`],[`qbo`,`application/vnd.intu.qbo`],[`qfx`,`application/vnd.intu.qfx`],[`qps`,`application/vnd.publishare-delta-tree`],[`qt`,`video/quicktime`],[`qwd`,`application/vnd.quark.quarkxpress`],[`qwt`,`application/vnd.quark.quarkxpress`],[`qxb`,`application/vnd.quark.quarkxpress`],[`qxd`,`application/vnd.quark.quarkxpress`],[`qxl`,`application/vnd.quark.quarkxpress`],[`qxt`,`application/vnd.quark.quarkxpress`],[`ra`,`audio/x-realaudio`],[`ram`,`audio/x-pn-realaudio`],[`raml`,`application/raml+yaml`],[`rapd`,`application/route-apd+xml`],[`rar`,`application/x-rar`],[`ras`,`image/x-cmu-raster`],[`rcprofile`,`application/vnd.ipunplugged.rcprofile`],[`rdf`,`application/rdf+xml`],[`rdz`,`application/vnd.data-vision.rdz`],[`relo`,`application/p2p-overlay+xml`],[`rep`,`application/vnd.businessobjects`],[`res`,`application/x-dtbresource+xml`],[`rgb`,`image/x-rgb`],[`rif`,`application/reginfo+xml`],[`rip`,`audio/vnd.rip`],[`ris`,`application/x-research-info-systems`],[`rl`,`application/resource-lists+xml`],[`rlc`,`image/vnd.fujixerox.edmics-rlc`],[`rld`,`application/resource-lists-diff+xml`],[`rm`,`audio/x-pn-realaudio`],[`rmi`,`audio/midi`],[`rmp`,`audio/x-pn-realaudio-plugin`],[`rms`,`application/vnd.jcp.javame.midlet-rms`],[`rmvb`,`application/vnd.rn-realmedia-vbr`],[`rnc`,`application/relax-ng-compact-syntax`],[`rng`,`application/xml`],[`roa`,`application/rpki-roa`],[`roff`,`text/troff`],[`rp9`,`application/vnd.cloanto.rp9`],[`rpm`,`audio/x-pn-realaudio-plugin`],[`rpss`,`application/vnd.nokia.radio-presets`],[`rpst`,`application/vnd.nokia.radio-preset`],[`rq`,`application/sparql-query`],[`rs`,`application/rls-services+xml`],[`rsa`,`application/x-pkcs7`],[`rsat`,`application/atsc-rsat+xml`],[`rsd`,`application/rsd+xml`],[`rsheet`,`application/urc-ressheet+xml`],[`rss`,`application/rss+xml`],[`rtf`,`text/rtf`],[`rtx`,`text/richtext`],[`run`,`application/x-makeself`],[`rusd`,`application/route-usd+xml`],[`rv`,`video/vnd.rn-realvideo`],[`s`,`text/x-asm`],[`s3m`,`audio/s3m`],[`saf`,`application/vnd.yamaha.smaf-audio`],[`sass`,`text/x-sass`],[`sbml`,`application/sbml+xml`],[`sc`,`application/vnd.ibm.secure-container`],[`scd`,`application/x-msschedule`],[`scm`,`application/vnd.lotus-screencam`],[`scq`,`application/scvp-cv-request`],[`scs`,`application/scvp-cv-response`],[`scss`,`text/x-scss`],[`scurl`,`text/vnd.curl.scurl`],[`sda`,`application/vnd.stardivision.draw`],[`sdc`,`application/vnd.stardivision.calc`],[`sdd`,`application/vnd.stardivision.impress`],[`sdkd`,`application/vnd.solent.sdkm+xml`],[`sdkm`,`application/vnd.solent.sdkm+xml`],[`sdp`,`application/sdp`],[`sdw`,`application/vnd.stardivision.writer`],[`sea`,`application/octet-stream`],[`see`,`application/vnd.seemail`],[`seed`,`application/vnd.fdsn.seed`],[`sema`,`application/vnd.sema`],[`semd`,`application/vnd.semd`],[`semf`,`application/vnd.semf`],[`senmlx`,`application/senml+xml`],[`sensmlx`,`application/sensml+xml`],[`ser`,`application/java-serialized-object`],[`setpay`,`application/set-payment-initiation`],[`setreg`,`application/set-registration-initiation`],[`sfd-hdstx`,`application/vnd.hydrostatix.sof-data`],[`sfs`,`application/vnd.spotfire.sfs`],[`sfv`,`text/x-sfv`],[`sgi`,`image/sgi`],[`sgl`,`application/vnd.stardivision.writer-global`],[`sgm`,`text/sgml`],[`sgml`,`text/sgml`],[`sh`,`application/x-sh`],[`shar`,`application/x-shar`],[`shex`,`text/shex`],[`shf`,`application/shf+xml`],[`shtml`,`text/html`],[`sid`,`image/x-mrsid-image`],[`sieve`,`application/sieve`],[`sig`,`application/pgp-signature`],[`sil`,`audio/silk`],[`silo`,`model/mesh`],[`sis`,`application/vnd.symbian.install`],[`sisx`,`application/vnd.symbian.install`],[`sit`,`application/x-stuffit`],[`sitx`,`application/x-stuffitx`],[`siv`,`application/sieve`],[`skd`,`application/vnd.koan`],[`skm`,`application/vnd.koan`],[`skp`,`application/vnd.koan`],[`skt`,`application/vnd.koan`],[`sldm`,`application/vnd.ms-powerpoint.slide.macroenabled.12`],[`sldx`,`application/vnd.openxmlformats-officedocument.presentationml.slide`],[`slim`,`text/slim`],[`slm`,`text/slim`],[`sls`,`application/route-s-tsid+xml`],[`slt`,`application/vnd.epson.salt`],[`sm`,`application/vnd.stepmania.stepchart`],[`smf`,`application/vnd.stardivision.math`],[`smi`,`application/smil`],[`smil`,`application/smil`],[`smv`,`video/x-smv`],[`smzip`,`application/vnd.stepmania.package`],[`snd`,`audio/basic`],[`snf`,`application/x-font-snf`],[`so`,`application/octet-stream`],[`spc`,`application/x-pkcs7-certificates`],[`spdx`,`text/spdx`],[`spf`,`application/vnd.yamaha.smaf-phrase`],[`spl`,`application/x-futuresplash`],[`spot`,`text/vnd.in3d.spot`],[`spp`,`application/scvp-vp-response`],[`spq`,`application/scvp-vp-request`],[`spx`,`audio/ogg`],[`sql`,`application/x-sql`],[`src`,`application/x-wais-source`],[`srt`,`application/x-subrip`],[`sru`,`application/sru+xml`],[`srx`,`application/sparql-results+xml`],[`ssdl`,`application/ssdl+xml`],[`sse`,`application/vnd.kodak-descriptor`],[`ssf`,`application/vnd.epson.ssf`],[`ssml`,`application/ssml+xml`],[`sst`,`application/octet-stream`],[`st`,`application/vnd.sailingtracker.track`],[`stc`,`application/vnd.sun.xml.calc.template`],[`std`,`application/vnd.sun.xml.draw.template`],[`stf`,`application/vnd.wt.stf`],[`sti`,`application/vnd.sun.xml.impress.template`],[`stk`,`application/hyperstudio`],[`stl`,`model/stl`],[`stpx`,`model/step+xml`],[`stpxz`,`model/step-xml+zip`],[`stpz`,`model/step+zip`],[`str`,`application/vnd.pg.format`],[`stw`,`application/vnd.sun.xml.writer.template`],[`styl`,`text/stylus`],[`stylus`,`text/stylus`],[`sub`,`text/vnd.dvb.subtitle`],[`sus`,`application/vnd.sus-calendar`],[`susp`,`application/vnd.sus-calendar`],[`sv4cpio`,`application/x-sv4cpio`],[`sv4crc`,`application/x-sv4crc`],[`svc`,`application/vnd.dvb.service`],[`svd`,`application/vnd.svd`],[`svg`,`image/svg+xml`],[`svgz`,`image/svg+xml`],[`swa`,`application/x-director`],[`swf`,`application/x-shockwave-flash`],[`swi`,`application/vnd.aristanetworks.swi`],[`swidtag`,`application/swid+xml`],[`sxc`,`application/vnd.sun.xml.calc`],[`sxd`,`application/vnd.sun.xml.draw`],[`sxg`,`application/vnd.sun.xml.writer.global`],[`sxi`,`application/vnd.sun.xml.impress`],[`sxm`,`application/vnd.sun.xml.math`],[`sxw`,`application/vnd.sun.xml.writer`],[`t`,`text/troff`],[`t3`,`application/x-t3vm-image`],[`t38`,`image/t38`],[`taglet`,`application/vnd.mynfc`],[`tao`,`application/vnd.tao.intent-module-archive`],[`tap`,`image/vnd.tencent.tap`],[`tar`,`application/x-tar`],[`tcap`,`application/vnd.3gpp2.tcap`],[`tcl`,`application/x-tcl`],[`td`,`application/urc-targetdesc+xml`],[`teacher`,`application/vnd.smart.teacher`],[`tei`,`application/tei+xml`],[`teicorpus`,`application/tei+xml`],[`tex`,`application/x-tex`],[`texi`,`application/x-texinfo`],[`texinfo`,`application/x-texinfo`],[`text`,`text/plain`],[`tfi`,`application/thraud+xml`],[`tfm`,`application/x-tex-tfm`],[`tfx`,`image/tiff-fx`],[`tga`,`image/x-tga`],[`tgz`,`application/x-tar`],[`thmx`,`application/vnd.ms-officetheme`],[`tif`,`image/tiff`],[`tiff`,`image/tiff`],[`tk`,`application/x-tcl`],[`tmo`,`application/vnd.tmobile-livetv`],[`toml`,`application/toml`],[`torrent`,`application/x-bittorrent`],[`tpl`,`application/vnd.groove-tool-template`],[`tpt`,`application/vnd.trid.tpt`],[`tr`,`text/troff`],[`tra`,`application/vnd.trueapp`],[`trig`,`application/trig`],[`trm`,`application/x-msterminal`],[`ts`,`video/mp2t`],[`tsd`,`application/timestamped-data`],[`tsv`,`text/tab-separated-values`],[`ttc`,`font/collection`],[`ttf`,`font/ttf`],[`ttl`,`text/turtle`],[`ttml`,`application/ttml+xml`],[`twd`,`application/vnd.simtech-mindmapper`],[`twds`,`application/vnd.simtech-mindmapper`],[`txd`,`application/vnd.genomatix.tuxedo`],[`txf`,`application/vnd.mobius.txf`],[`txt`,`text/plain`],[`u8dsn`,`message/global-delivery-status`],[`u8hdr`,`message/global-headers`],[`u8mdn`,`message/global-disposition-notification`],[`u8msg`,`message/global`],[`u32`,`application/x-authorware-bin`],[`ubj`,`application/ubjson`],[`udeb`,`application/x-debian-package`],[`ufd`,`application/vnd.ufdl`],[`ufdl`,`application/vnd.ufdl`],[`ulx`,`application/x-glulx`],[`umj`,`application/vnd.umajin`],[`unityweb`,`application/vnd.unity`],[`uoml`,`application/vnd.uoml+xml`],[`uri`,`text/uri-list`],[`uris`,`text/uri-list`],[`urls`,`text/uri-list`],[`usdz`,`model/vnd.usdz+zip`],[`ustar`,`application/x-ustar`],[`utz`,`application/vnd.uiq.theme`],[`uu`,`text/x-uuencode`],[`uva`,`audio/vnd.dece.audio`],[`uvd`,`application/vnd.dece.data`],[`uvf`,`application/vnd.dece.data`],[`uvg`,`image/vnd.dece.graphic`],[`uvh`,`video/vnd.dece.hd`],[`uvi`,`image/vnd.dece.graphic`],[`uvm`,`video/vnd.dece.mobile`],[`uvp`,`video/vnd.dece.pd`],[`uvs`,`video/vnd.dece.sd`],[`uvt`,`application/vnd.dece.ttml+xml`],[`uvu`,`video/vnd.uvvu.mp4`],[`uvv`,`video/vnd.dece.video`],[`uvva`,`audio/vnd.dece.audio`],[`uvvd`,`application/vnd.dece.data`],[`uvvf`,`application/vnd.dece.data`],[`uvvg`,`image/vnd.dece.graphic`],[`uvvh`,`video/vnd.dece.hd`],[`uvvi`,`image/vnd.dece.graphic`],[`uvvm`,`video/vnd.dece.mobile`],[`uvvp`,`video/vnd.dece.pd`],[`uvvs`,`video/vnd.dece.sd`],[`uvvt`,`application/vnd.dece.ttml+xml`],[`uvvu`,`video/vnd.uvvu.mp4`],[`uvvv`,`video/vnd.dece.video`],[`uvvx`,`application/vnd.dece.unspecified`],[`uvvz`,`application/vnd.dece.zip`],[`uvx`,`application/vnd.dece.unspecified`],[`uvz`,`application/vnd.dece.zip`],[`vbox`,`application/x-virtualbox-vbox`],[`vbox-extpack`,`application/x-virtualbox-vbox-extpack`],[`vcard`,`text/vcard`],[`vcd`,`application/x-cdlink`],[`vcf`,`text/x-vcard`],[`vcg`,`application/vnd.groove-vcard`],[`vcs`,`text/x-vcalendar`],[`vcx`,`application/vnd.vcx`],[`vdi`,`application/x-virtualbox-vdi`],[`vds`,`model/vnd.sap.vds`],[`vhd`,`application/x-virtualbox-vhd`],[`vis`,`application/vnd.visionary`],[`viv`,`video/vnd.vivo`],[`vlc`,`application/videolan`],[`vmdk`,`application/x-virtualbox-vmdk`],[`vob`,`video/x-ms-vob`],[`vor`,`application/vnd.stardivision.writer`],[`vox`,`application/x-authorware-bin`],[`vrml`,`model/vrml`],[`vsd`,`application/vnd.visio`],[`vsf`,`application/vnd.vsf`],[`vss`,`application/vnd.visio`],[`vst`,`application/vnd.visio`],[`vsw`,`application/vnd.visio`],[`vtf`,`image/vnd.valve.source.texture`],[`vtt`,`text/vtt`],[`vtu`,`model/vnd.vtu`],[`vxml`,`application/voicexml+xml`],[`w3d`,`application/x-director`],[`wad`,`application/x-doom`],[`wadl`,`application/vnd.sun.wadl+xml`],[`war`,`application/java-archive`],[`wasm`,`application/wasm`],[`wav`,`audio/x-wav`],[`wax`,`audio/x-ms-wax`],[`wbmp`,`image/vnd.wap.wbmp`],[`wbs`,`application/vnd.criticaltools.wbs+xml`],[`wbxml`,`application/wbxml`],[`wcm`,`application/vnd.ms-works`],[`wdb`,`application/vnd.ms-works`],[`wdp`,`image/vnd.ms-photo`],[`weba`,`audio/webm`],[`webapp`,`application/x-web-app-manifest+json`],[`webm`,`video/webm`],[`webmanifest`,`application/manifest+json`],[`webp`,`image/webp`],[`wg`,`application/vnd.pmi.widget`],[`wgt`,`application/widget`],[`wks`,`application/vnd.ms-works`],[`wm`,`video/x-ms-wm`],[`wma`,`audio/x-ms-wma`],[`wmd`,`application/x-ms-wmd`],[`wmf`,`image/wmf`],[`wml`,`text/vnd.wap.wml`],[`wmlc`,`application/wmlc`],[`wmls`,`text/vnd.wap.wmlscript`],[`wmlsc`,`application/vnd.wap.wmlscriptc`],[`wmv`,`video/x-ms-wmv`],[`wmx`,`video/x-ms-wmx`],[`wmz`,`application/x-msmetafile`],[`woff`,`font/woff`],[`woff2`,`font/woff2`],[`word`,`application/msword`],[`wpd`,`application/vnd.wordperfect`],[`wpl`,`application/vnd.ms-wpl`],[`wps`,`application/vnd.ms-works`],[`wqd`,`application/vnd.wqd`],[`wri`,`application/x-mswrite`],[`wrl`,`model/vrml`],[`wsc`,`message/vnd.wfa.wsc`],[`wsdl`,`application/wsdl+xml`],[`wspolicy`,`application/wspolicy+xml`],[`wtb`,`application/vnd.webturbo`],[`wvx`,`video/x-ms-wvx`],[`x3d`,`model/x3d+xml`],[`x3db`,`model/x3d+fastinfoset`],[`x3dbz`,`model/x3d+binary`],[`x3dv`,`model/x3d-vrml`],[`x3dvz`,`model/x3d+vrml`],[`x3dz`,`model/x3d+xml`],[`x32`,`application/x-authorware-bin`],[`x_b`,`model/vnd.parasolid.transmit.binary`],[`x_t`,`model/vnd.parasolid.transmit.text`],[`xaml`,`application/xaml+xml`],[`xap`,`application/x-silverlight-app`],[`xar`,`application/vnd.xara`],[`xav`,`application/xcap-att+xml`],[`xbap`,`application/x-ms-xbap`],[`xbd`,`application/vnd.fujixerox.docuworks.binder`],[`xbm`,`image/x-xbitmap`],[`xca`,`application/xcap-caps+xml`],[`xcs`,`application/calendar+xml`],[`xdf`,`application/xcap-diff+xml`],[`xdm`,`application/vnd.syncml.dm+xml`],[`xdp`,`application/vnd.adobe.xdp+xml`],[`xdssc`,`application/dssc+xml`],[`xdw`,`application/vnd.fujixerox.docuworks`],[`xel`,`application/xcap-el+xml`],[`xenc`,`application/xenc+xml`],[`xer`,`application/patch-ops-error+xml`],[`xfdf`,`application/vnd.adobe.xfdf`],[`xfdl`,`application/vnd.xfdl`],[`xht`,`application/xhtml+xml`],[`xhtml`,`application/xhtml+xml`],[`xhvml`,`application/xv+xml`],[`xif`,`image/vnd.xiff`],[`xl`,`application/excel`],[`xla`,`application/vnd.ms-excel`],[`xlam`,`application/vnd.ms-excel.addin.macroEnabled.12`],[`xlc`,`application/vnd.ms-excel`],[`xlf`,`application/xliff+xml`],[`xlm`,`application/vnd.ms-excel`],[`xls`,`application/vnd.ms-excel`],[`xlsb`,`application/vnd.ms-excel.sheet.binary.macroEnabled.12`],[`xlsm`,`application/vnd.ms-excel.sheet.macroEnabled.12`],[`xlsx`,`application/vnd.openxmlformats-officedocument.spreadsheetml.sheet`],[`xlt`,`application/vnd.ms-excel`],[`xltm`,`application/vnd.ms-excel.template.macroEnabled.12`],[`xltx`,`application/vnd.openxmlformats-officedocument.spreadsheetml.template`],[`xlw`,`application/vnd.ms-excel`],[`xm`,`audio/xm`],[`xml`,`application/xml`],[`xns`,`application/xcap-ns+xml`],[`xo`,`application/vnd.olpc-sugar`],[`xop`,`application/xop+xml`],[`xpi`,`application/x-xpinstall`],[`xpl`,`application/xproc+xml`],[`xpm`,`image/x-xpixmap`],[`xpr`,`application/vnd.is-xpr`],[`xps`,`application/vnd.ms-xpsdocument`],[`xpw`,`application/vnd.intercon.formnet`],[`xpx`,`application/vnd.intercon.formnet`],[`xsd`,`application/xml`],[`xsl`,`application/xml`],[`xslt`,`application/xslt+xml`],[`xsm`,`application/vnd.syncml+xml`],[`xspf`,`application/xspf+xml`],[`xul`,`application/vnd.mozilla.xul+xml`],[`xvm`,`application/xv+xml`],[`xvml`,`application/xv+xml`],[`xwd`,`image/x-xwindowdump`],[`xyz`,`chemical/x-xyz`],[`xz`,`application/x-xz`],[`yaml`,`text/yaml`],[`yang`,`application/yang`],[`yin`,`application/yin+xml`],[`yml`,`text/yaml`],[`ymp`,`text/x-suse-ymp`],[`z`,`application/x-compress`],[`z1`,`application/x-zmachine`],[`z2`,`application/x-zmachine`],[`z3`,`application/x-zmachine`],[`z4`,`application/x-zmachine`],[`z5`,`application/x-zmachine`],[`z6`,`application/x-zmachine`],[`z7`,`application/x-zmachine`],[`z8`,`application/x-zmachine`],[`zaz`,`application/vnd.zzazz.deck+xml`],[`zip`,`application/zip`],[`zir`,`application/vnd.zul`],[`zirz`,`application/vnd.zul`],[`zmm`,`application/vnd.handheld-entertainment+xml`],[`zsh`,`text/x-scriptzsh`]]);function Bt(e,t,n){let r=Vt(e),{webkitRelativePath:i}=e,a=typeof t==`string`?t:typeof i==`string`&&i.length>0?i:`./${e.name}`;return typeof r.path!=`string`&&Ht(r,`path`,a),n!==void 0&&Object.defineProperty(r,`handle`,{value:n,writable:!1,configurable:!1,enumerable:!0}),Ht(r,`relativePath`,a),r}function Vt(e){let{name:t}=e;if(t&&t.lastIndexOf(`.`)!==-1&&!e.type){let n=t.split(`.`).pop().toLowerCase(),r=zt.get(n);r&&Object.defineProperty(e,`type`,{value:r,writable:!1,configurable:!1,enumerable:!0})}return e}function Ht(e,t,n){Object.defineProperty(e,t,{value:n,writable:!1,configurable:!1,enumerable:!0})}var Ut=[`.DS_Store`,`Thumbs.db`];function Wt(e){return U(this,void 0,void 0,function*(){return qt(e)&&Gt(e.dataTransfer)?Xt(e.dataTransfer,e.type):Kt(e)?Jt(e):Array.isArray(e)&&e.every(e=>`getFile`in e&&typeof e.getFile==`function`)?Yt(e):[]})}function Gt(e){return qt(e)}function Kt(e){return qt(e)&&qt(e.target)}function qt(e){return typeof e==`object`&&!!e}function Jt(e){return Qt(e.target.files).map(e=>Bt(e))}function Yt(e){return U(this,void 0,void 0,function*(){return(yield Promise.all(e.map(e=>e.getFile()))).map(e=>Bt(e))})}function Xt(e,t){return U(this,void 0,void 0,function*(){if(e.items){let n=Qt(e.items).filter(e=>e.kind===`file`);return t===`drop`?Zt(en(yield Promise.all(n.map($t)))):n}return Zt(Qt(e.files).map(e=>Bt(e)))})}function Zt(e){return e.filter(e=>Ut.indexOf(e.name)===-1)}function Qt(e){if(e===null)return[];let t=[];for(let n=0;n<e.length;n++){let r=e[n];t.push(r)}return t}function $t(e){if(typeof e.webkitGetAsEntry!=`function`)return tn(e);let t=e.webkitGetAsEntry();return t&&t.isDirectory?rn(t):tn(e,t)}function en(e){return e.reduce((e,t)=>[...e,...Array.isArray(t)?en(t):[t]],[])}function tn(e,t){return U(this,void 0,void 0,function*(){if(globalThis.isSecureContext&&typeof e.getAsFileSystemHandle==`function`){let t=yield e.getAsFileSystemHandle();if(t===null)throw Error(`${e} is not a File`);if(t!==void 0){let e=yield t.getFile();return e.handle=t,Bt(e)}}let n=e.getAsFile();if(!n)throw Error(`${e} is not a File`);return Bt(n,t?.fullPath??void 0)})}function nn(e){return U(this,void 0,void 0,function*(){return e.isDirectory?rn(e):an(e)})}function rn(e){let t=e.createReader();return new Promise((e,n)=>{let r=[];function i(){t.readEntries(t=>U(this,void 0,void 0,function*(){if(t.length){let e=Promise.all(t.map(nn));r.push(e),i()}else try{e(yield Promise.all(r))}catch(e){n(e)}}),e=>{n(e)})}i()})}function an(e){return U(this,void 0,void 0,function*(){return new Promise((t,n)=>{e.file(n=>{t(Bt(n,e.fullPath))},e=>{n(e)})})})}var on=t((e=>{e.__esModule=!0,e.default=function(e,t){if(e&&t){var n=Array.isArray(t)?t:t.split(`,`);if(n.length===0)return!0;var r=e.name||``,i=(e.type||``).toLowerCase(),a=i.replace(/\/.*$/,``);return n.some(function(e){var t=e.trim().toLowerCase();return t.charAt(0)===`.`?r.toLowerCase().endsWith(t):t.endsWith(`/*`)?a===t.replace(/\/.*$/,``):i===t})}return!0}})),q=e(Rt()),sn=e(on());function cn(e){return dn(e)||un(e)||_n(e)||ln()}function ln(){throw TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function un(e){if(typeof Symbol<`u`&&e[Symbol.iterator]!=null||e[`@@iterator`]!=null)return Array.from(e)}function dn(e){if(Array.isArray(e))return vn(e)}function fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function pn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?fn(Object(n),!0).forEach(function(t){mn(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fn(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function mn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hn(e,t){return bn(e)||yn(e,t)||_n(e,t)||gn()}function gn(){throw TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _n(e,t){if(e){if(typeof e==`string`)return vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n===`Object`&&e.constructor&&(n=e.constructor.name),n===`Map`||n===`Set`)return Array.from(e);if(n===`Arguments`||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vn(e,t)}}function vn(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function yn(e,t){var n=e==null?null:typeof Symbol<`u`&&e[Symbol.iterator]||e[`@@iterator`];if(n!=null){var r=[],i=!0,a=!1,o,s;try{for(n=n.call(e);!(i=(o=n.next()).done)&&(r.push(o.value),!(t&&r.length===t));i=!0);}catch(e){a=!0,s=e}finally{try{!i&&n.return!=null&&n.return()}finally{if(a)throw s}}return r}}function bn(e){if(Array.isArray(e))return e}var xn=typeof sn.default==`function`?sn.default:sn.default.default,Sn=`file-invalid-type`,Cn=`file-too-large`,wn=`file-too-small`,Tn=`too-many-files`,En=function(){var e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:``).split(`,`);return{code:Sn,message:`File type must be ${e.length>1?`one of ${e.join(`, `)}`:e[0]}`}},Dn=function(e){return{code:Cn,message:`File is larger than ${e} ${e===1?`byte`:`bytes`}`}},On=function(e){return{code:wn,message:`File is smaller than ${e} ${e===1?`byte`:`bytes`}`}},kn={code:Tn,message:`Too many files`};function An(e,t){var n=e.type===`application/x-moz-file`||xn(e,t);return[n,n?null:En(t)]}function jn(e,t,n){if(Mn(e.size)){if(Mn(t)&&Mn(n)){if(e.size>n)return[!1,Dn(n)];if(e.size<t)return[!1,On(t)]}else if(Mn(t)&&e.size<t)return[!1,On(t)];else if(Mn(n)&&e.size>n)return[!1,Dn(n)]}return[!0,null]}function Mn(e){return e!=null}function Nn(e){var t=e.files,n=e.accept,r=e.minSize,i=e.maxSize,a=e.multiple,o=e.maxFiles,s=e.validator;return!a&&t.length>1||a&&o>=1&&t.length>o?!1:t.every(function(e){var t=hn(An(e,n),1)[0],a=hn(jn(e,r,i),1)[0],o=s?s(e):null;return t&&a&&!o})}function Pn(e){return typeof e.isPropagationStopped==`function`?e.isPropagationStopped():e.cancelBubble===void 0?!1:e.cancelBubble}function Fn(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(e){return e===`Files`||e===`application/x-moz-file`}):!!e.target&&!!e.target.files}function In(e){e.preventDefault()}function Ln(e){return e.indexOf(`MSIE`)!==-1||e.indexOf(`Trident/`)!==-1}function Rn(e){return e.indexOf(`Edge/`)!==-1}function zn(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return Ln(e)||Rn(e)}function Bn(){var e=[...arguments];return function(t){var n=[...arguments].slice(1);return e.some(function(e){return!Pn(t)&&e&&e.apply(void 0,[t].concat(n)),Pn(t)})}}function Vn(){return`showOpenFilePicker`in window}function Hn(e){return Mn(e)?[{description:`Files`,accept:Object.entries(e).filter(function(e){var t=hn(e,2),n=t[0],r=t[1],i=!0;return Kn(n)||(console.warn(`Skipped "${n}" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.`),i=!1),(!Array.isArray(r)||!r.every(qn))&&(console.warn(`Skipped "${n}" because an invalid file extension was provided.`),i=!1),i}).reduce(function(e,t){var n=hn(t,2),r=n[0],i=n[1];return pn(pn({},e),{},mn({},r,i))},{})}]:e}function Un(e){if(Mn(e))return Object.entries(e).reduce(function(e,t){var n=hn(t,2),r=n[0],i=n[1];return[].concat(cn(e),[r],cn(i))},[]).filter(function(e){return Kn(e)||qn(e)}).join(`,`)}function Wn(e){return e instanceof DOMException&&(e.name===`AbortError`||e.code===e.ABORT_ERR)}function Gn(e){return e instanceof DOMException&&(e.name===`SecurityError`||e.code===e.SECURITY_ERR)}function Kn(e){return e===`audio/*`||e===`video/*`||e===`image/*`||e===`text/*`||e===`application/*`||/\w+\/[-+.\w]+/g.test(e)}function qn(e){return/^.*\.[\w]+$/.test(e)}var Jn=[`children`],Yn=[`open`],Xn=[`refKey`,`role`,`onKeyDown`,`onFocus`,`onBlur`,`onClick`,`onDragEnter`,`onDragOver`,`onDragLeave`,`onDrop`],Zn=[`refKey`,`onChange`,`onClick`];function Qn(e){return tr(e)||er(e)||ir(e)||$n()}function $n(){throw TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function er(e){if(typeof Symbol<`u`&&e[Symbol.iterator]!=null||e[`@@iterator`]!=null)return Array.from(e)}function tr(e){if(Array.isArray(e))return ar(e)}function nr(e,t){return sr(e)||or(e,t)||ir(e,t)||rr()}function rr(){throw TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ir(e,t){if(e){if(typeof e==`string`)return ar(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n===`Object`&&e.constructor&&(n=e.constructor.name),n===`Map`||n===`Set`)return Array.from(e);if(n===`Arguments`||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ar(e,t)}}function ar(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function or(e,t){var n=e==null?null:typeof Symbol<`u`&&e[Symbol.iterator]||e[`@@iterator`];if(n!=null){var r=[],i=!0,a=!1,o,s;try{for(n=n.call(e);!(i=(o=n.next()).done)&&(r.push(o.value),!(t&&r.length===t));i=!0);}catch(e){a=!0,s=e}finally{try{!i&&n.return!=null&&n.return()}finally{if(a)throw s}}return r}}function sr(e){if(Array.isArray(e))return e}function cr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?cr(Object(n),!0).forEach(function(t){lr(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cr(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function lr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ur(e,t){if(e==null)return{};var n=dr(e,t),r,i;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)r=a[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function dr(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,a;for(a=0;a<r.length;a++)i=r[a],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}var fr=(0,V.forwardRef)(function(e,t){var n=e.children,r=hr(ur(e,Jn)),i=r.open,a=ur(r,Yn);return(0,V.useImperativeHandle)(t,function(){return{open:i}},[i]),V.createElement(V.Fragment,null,n(J(J({},a),{},{open:i})))});fr.displayName=`Dropzone`;var pr={disabled:!1,getFilesFromEvent:Wt,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};fr.defaultProps=pr,fr.propTypes={children:q.default.func,accept:q.default.objectOf(q.default.arrayOf(q.default.string)),multiple:q.default.bool,preventDropOnDocument:q.default.bool,noClick:q.default.bool,noKeyboard:q.default.bool,noDrag:q.default.bool,noDragEventsBubbling:q.default.bool,minSize:q.default.number,maxSize:q.default.number,maxFiles:q.default.number,disabled:q.default.bool,getFilesFromEvent:q.default.func,onFileDialogCancel:q.default.func,onFileDialogOpen:q.default.func,useFsAccessApi:q.default.bool,autoFocus:q.default.bool,onDragEnter:q.default.func,onDragLeave:q.default.func,onDragOver:q.default.func,onDrop:q.default.func,onDropAccepted:q.default.func,onDropRejected:q.default.func,onError:q.default.func,validator:q.default.func};var mr={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function hr(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=J(J({},pr),e),n=t.accept,r=t.disabled,i=t.getFilesFromEvent,a=t.maxSize,o=t.minSize,s=t.multiple,c=t.maxFiles,l=t.onDragEnter,u=t.onDragLeave,d=t.onDragOver,f=t.onDrop,p=t.onDropAccepted,m=t.onDropRejected,h=t.onFileDialogCancel,g=t.onFileDialogOpen,_=t.useFsAccessApi,v=t.autoFocus,y=t.preventDropOnDocument,b=t.noClick,x=t.noKeyboard,S=t.noDrag,C=t.noDragEventsBubbling,ee=t.onError,w=t.validator,T=(0,V.useMemo)(function(){return Un(n)},[n]),E=(0,V.useMemo)(function(){return Hn(n)},[n]),D=(0,V.useMemo)(function(){return typeof g==`function`?g:_r},[g]),O=(0,V.useMemo)(function(){return typeof h==`function`?h:_r},[h]),k=(0,V.useRef)(null),A=(0,V.useRef)(null),te=nr((0,V.useReducer)(gr,mr),2),ne=te[0],j=te[1],re=ne.isFocused,ie=ne.isFileDialogActive,M=(0,V.useRef)(typeof window<`u`&&window.isSecureContext&&_&&Vn()),ae=function(){!M.current&&ie&&setTimeout(function(){A.current&&(A.current.files.length||(j({type:`closeDialog`}),O()))},300)};(0,V.useEffect)(function(){return window.addEventListener(`focus`,ae,!1),function(){window.removeEventListener(`focus`,ae,!1)}},[A,ie,O,M]);var N=(0,V.useRef)([]),P=function(e){k.current&&k.current.contains(e.target)||(e.preventDefault(),N.current=[])};(0,V.useEffect)(function(){return y&&(document.addEventListener(`dragover`,In,!1),document.addEventListener(`drop`,P,!1)),function(){y&&(document.removeEventListener(`dragover`,In),document.removeEventListener(`drop`,P))}},[k,y]),(0,V.useEffect)(function(){return!r&&v&&k.current&&k.current.focus(),function(){}},[k,v,r]);var F=(0,V.useCallback)(function(e){ee?ee(e):console.error(e)},[ee]),I=(0,V.useCallback)(function(e){e.preventDefault(),e.persist(),me(e),N.current=[].concat(Qn(N.current),[e.target]),Fn(e)&&Promise.resolve(i(e)).then(function(t){if(!(Pn(e)&&!C)){var n=t.length,r=n>0&&Nn({files:t,accept:T,minSize:o,maxSize:a,multiple:s,maxFiles:c,validator:w});j({isDragAccept:r,isDragReject:n>0&&!r,isDragActive:!0,type:`setDraggedFiles`}),l&&l(e)}}).catch(function(e){return F(e)})},[i,l,F,C,T,o,a,s,c,w]),L=(0,V.useCallback)(function(e){e.preventDefault(),e.persist(),me(e);var t=Fn(e);if(t&&e.dataTransfer)try{e.dataTransfer.dropEffect=`copy`}catch{}return t&&d&&d(e),!1},[d,C]),R=(0,V.useCallback)(function(e){e.preventDefault(),e.persist(),me(e);var t=N.current.filter(function(e){return k.current&&k.current.contains(e)}),n=t.indexOf(e.target);n!==-1&&t.splice(n,1),N.current=t,!(t.length>0)&&(j({type:`setDraggedFiles`,isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Fn(e)&&u&&u(e))},[k,u,C]),oe=(0,V.useCallback)(function(e,t){var n=[],r=[];e.forEach(function(e){var t=nr(An(e,T),2),i=t[0],s=t[1],c=nr(jn(e,o,a),2),l=c[0],u=c[1],d=w?w(e):null;if(i&&l&&!d)n.push(e);else{var f=[s,u];d&&(f=f.concat(d)),r.push({file:e,errors:f.filter(function(e){return e})})}}),(!s&&n.length>1||s&&c>=1&&n.length>c)&&(n.forEach(function(e){r.push({file:e,errors:[kn]})}),n.splice(0)),j({acceptedFiles:n,fileRejections:r,isDragReject:r.length>0,type:`setFiles`}),f&&f(n,r,t),r.length>0&&m&&m(r,t),n.length>0&&p&&p(n,t)},[j,s,T,o,a,c,f,p,m,w]),z=(0,V.useCallback)(function(e){e.preventDefault(),e.persist(),me(e),N.current=[],Fn(e)&&Promise.resolve(i(e)).then(function(t){Pn(e)&&!C||oe(t,e)}).catch(function(e){return F(e)}),j({type:`reset`})},[i,oe,F,C]),se=(0,V.useCallback)(function(){if(M.current){j({type:`openDialog`}),D();var e={multiple:s,types:E};window.showOpenFilePicker(e).then(function(e){return i(e)}).then(function(e){oe(e,null),j({type:`closeDialog`})}).catch(function(e){Wn(e)?(O(e),j({type:`closeDialog`})):Gn(e)?(M.current=!1,A.current?(A.current.value=null,A.current.click()):F(Error(`Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided.`))):F(e)});return}A.current&&(j({type:`openDialog`}),D(),A.current.value=null,A.current.click())},[j,D,O,_,oe,F,E,s]),ce=(0,V.useCallback)(function(e){!k.current||!k.current.isEqualNode(e.target)||(e.key===` `||e.key===`Enter`||e.keyCode===32||e.keyCode===13)&&(e.preventDefault(),se())},[k,se]),le=(0,V.useCallback)(function(){j({type:`focus`})},[]),ue=(0,V.useCallback)(function(){j({type:`blur`})},[]),B=(0,V.useCallback)(function(){b||(zn()?setTimeout(se,0):se())},[b,se]),de=function(e){return r?null:e},fe=function(e){return x?null:de(e)},pe=function(e){return S?null:de(e)},me=function(e){C&&e.stopPropagation()},he=(0,V.useMemo)(function(){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.refKey,n=t===void 0?`ref`:t,i=e.role,a=e.onKeyDown,o=e.onFocus,s=e.onBlur,c=e.onClick,l=e.onDragEnter,u=e.onDragOver,d=e.onDragLeave,f=e.onDrop,p=ur(e,Xn);return J(J(lr({onKeyDown:fe(Bn(a,ce)),onFocus:fe(Bn(o,le)),onBlur:fe(Bn(s,ue)),onClick:de(Bn(c,B)),onDragEnter:pe(Bn(l,I)),onDragOver:pe(Bn(u,L)),onDragLeave:pe(Bn(d,R)),onDrop:pe(Bn(f,z)),role:typeof i==`string`&&i!==``?i:`presentation`},n,k),!r&&!x?{tabIndex:0}:{}),p)}},[k,ce,le,ue,B,I,L,R,z,x,S,r]),ge=(0,V.useCallback)(function(e){e.stopPropagation()},[]),_e=(0,V.useMemo)(function(){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.refKey,n=t===void 0?`ref`:t,r=e.onChange,i=e.onClick,a=ur(e,Zn);return J(J({},lr({accept:T,multiple:s,type:`file`,style:{border:0,clip:`rect(0, 0, 0, 0)`,clipPath:`inset(50%)`,height:`1px`,margin:`0 -1px -1px 0`,overflow:`hidden`,padding:0,position:`absolute`,width:`1px`,whiteSpace:`nowrap`},onChange:de(Bn(r,z)),onClick:de(Bn(i,ge)),tabIndex:-1},n,A)),a)}},[A,n,s,z,r]);return J(J({},ne),{},{isFocused:re&&!r,getRootProps:he,getInputProps:_e,rootRef:k,inputRef:A,open:de(se)})}function gr(e,t){switch(t.type){case`focus`:return J(J({},e),{},{isFocused:!0});case`blur`:return J(J({},e),{},{isFocused:!1});case`openDialog`:return J(J({},mr),{},{isFileDialogActive:!0});case`closeDialog`:return J(J({},e),{},{isFileDialogActive:!1});case`setDraggedFiles`:return J(J({},e),{},{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case`setFiles`:return J(J({},e),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections,isDragReject:t.isDragReject});case`reset`:return J({},mr);default:return e}}function _r(){}const vr=({initialImageUrl:e,onFileSelected:t,aspectRatio:n=`16 / 9`,label:r})=>{let[i,a]=(0,V.useState)(e??null),{getRootProps:o,getInputProps:s,isDragActive:c}=hr({onDrop:(0,V.useCallback)(e=>{if(!e.length)return;let n=e[0];t(n),a(URL.createObjectURL(n))},[t]),accept:{"image/*":[]},maxFiles:1}),l={aspectRatio:n,width:`100%`,borderRadius:4,border:`1px dashed rgba(148, 163, 184, 0.8)`,backgroundSize:`cover`,backgroundPosition:`center`,backgroundImage:i?`url(${i})`:void 0,display:`flex`,alignItems:`center`,justifyContent:`center`,cursor:`pointer`};return(0,W.jsxs)(`div`,{className:`flex flex-col`,children:[r&&(0,W.jsx)(`label`,{className:`text-sm pb-2 text-foreground`,children:r}),(0,W.jsxs)(`div`,{...o(),style:l,className:`
          bg-input
          hover:bg-input
          focus-visible:outline-none
          text-xs text-default-500
        `,children:[(0,W.jsx)(`input`,{...s()}),!i&&(0,W.jsx)(`span`,{className:`px-2 text-center opacity-80`,children:c?`Drop image hereâ€¦`:`Upload image`})]})]})};var yr=()=>{let{editingMarker:e,setEditingMarker:t,createMarkerRemote:n,updateMarker:r,deleteMarker:i}=At(),{types:a,selectedMap:o}=G(),{fetchWithAuth:s,user:c,setUserModalOpen:l}=ue(),{t:u}=R(),[d,f]=(0,V.useState)(``),[p,m]=(0,V.useState)(``),[h,g]=(0,V.useState)(``),[v,y]=(0,V.useState)(``),[x,S]=(0,V.useState)(``),[ee,w]=(0,V.useState)(null),T=e?.image?se(e.image+`.webp`):``,[E,D]=(0,V.useState)(!1),[k,re]=(0,V.useState)(!1),[N,P]=(0,V.useState)(null);if((0,V.useEffect)(()=>{if(!e)return;f(e.name??``),m(e.description??``),g(e.localType??``);let t=e.subtype??``,n=``;for(let e of a)if(e.subtypes.some(e=>e.id===t)){n=e.id;break}y(n),S(t),P(null),w(null)},[e,a]),!e)return null;let F=a.find(e=>e.id===v)?.subtypes??[],I={inputWrapper:` bg-input hover:!bg-input focus:!bg-input transition-none
                    group-data-[hover=true]:!bg-input
                    group-data-[focus=true]:!bg-input
                    group-data-[focus-visible=true]:!bg-input
                    group-data-[invalid=true]:!bg-input
                  `,innerWrapper:`h-10 py-0`},L=async()=>{if(E)return;let a=u(`common:errors.uploadFailed`,`Upload failed. Please try again.`),c=x||e.subtype||``;console.log(c),D(!0),P(null);try{let l=new FormData;if(ee&&l.append(`file`,ee),e.status){l.append(`subtype_id`,c),l.append(`name`,d),l.append(`description`,p);let n=await s(`/maps/${o?.name}/marker_feedbacks/${e.id}`,{method:`PATCH`,body:l});if(!n.ok){P(a);return}let i=await n.json();i.errorCode!==`Success`&&P(`${a} ${i.errorCode}: ${i.errorMessage}`);let u=i.data;r({...e,name:u.name,description:u.description,subtype:u.subtypeId,image:u.image?.s3Key||``,type:u.type===`create`?`uploaded`:`feedback`,status:u.status,reply:u.reply}),t(null)}else{l.append(`x`,String(Math.round(e.x))),l.append(`y`,String(Math.round(e.y))),l.append(`subtype_id`,c),l.append(`name`,d),l.append(`description`,p),e.type===`feedback`?(l.append(`type`,`update`),l.append(`marker_id`,e.markerId)):l.append(`type`,`create`);let t=await s(`/maps/${o?.name}/marker_feedbacks`,{method:`POST`,body:l});if(!t.ok){P(a);return}let r=await t.json();r.errorCode!==`Success`&&P(`${a} ${r.errorCode}: ${r.errorMessage}`),i(e.id);let u=r.data;n({id:u.id,markerId:u.markerId||``,subtype:u.subtypeId,mapId:u.mapId,x:u.x,y:u.y,name:u.name,description:u.description,image:u.image?.s3Key||``,type:u.type===`create`?`uploaded`:`feedback`,status:u.status,reply:u.reply})}}catch(e){console.error(e),P(u(`common:errors.network`,`Network error. Please check your connection and try again.`))}finally{D(!1)}},oe=async()=>{let n=x||e.subtype||``;r({...e,x:Math.round(e.x),y:Math.round(e.y),subtype:n,name:d,description:p,localType:h||void 0}),t(null)},z=async()=>{if(k)return;let t=u(`common:errors.deleteFailed`,`Delete failed. Please try again.`);re(!0);try{if(e.type===`uploaded`&&!(await s(`/maps/${o?.name}/marker_feedbacks/${e.id}`,{method:`DELETE`})).ok){P(t);return}i(e.id)}catch(e){console.error(e),P(u(`common:errors.network`,`Network error. Please check your connection and try again.`))}finally{re(!1)}};return(0,W.jsx)(ae,{isOpen:!0,onOpenChange:()=>t(null),placement:`center`,size:`md`,classNames:{wrapper:`z-[30000]`},hideCloseButton:!0,backdrop:`transparent`,children:(0,W.jsx)(ne,{className:`bg-sidebar`,children:()=>(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(ie,{className:`flex items-center justify-between gap-3`,children:[(0,W.jsx)(`span`,{className:`text-base font-semibold`,children:e?.type===`feedback`?u(`common:markerActions.feedback`,`Marker Feedback`):u(`common:markerActions.editUserMarker`,`Edit User Marker`)}),e?.type!==`feedback`&&(0,W.jsx)(`span`,{className:`text-sm text-default-700`,children:e?.type===`uploaded`?u(`common:markerActions.uploaded`,`Uploaded marker`):u(`common:markerActions.local`,`Local marker`)})]}),(0,W.jsxs)(A,{className:`flex flex-col gap-3`,children:[N&&(0,W.jsx)(`div`,{className:`mt-1 rounded-md border border-danger-500/60 bg-danger-500/10 px-3 py-2 text-[13px] text-danger-500`,children:N}),e.type===`local`&&(0,W.jsx)(`div`,{className:`flex items-center gap-2 flex-wrap`,children:Mt.map(e=>{let t=h===e,n=jt[e];return(0,W.jsx)(`button`,{type:`button`,onClick:()=>g(e),className:[`w-[30px] h-[30px] rounded-full border flex items-center justify-center shrink-0`,t?`bg-[radial-gradient(50%_50%_at_50%_50%,_#2E97FF_75%,_#B2D9FF_76%)] border-white`:`bg-[radial-gradient(50%_50%_at_50%_50%,_#5D5D5D_75%,_#ADADAD_76%)] border-white`].join(` `),children:(0,W.jsx)(`img`,{src:B(n),alt:``,className:`w-[22px] h-[22px] object-contain pointer-events-none select-none`,draggable:!1})},e)})}),(0,W.jsxs)(`div`,{className:`flex items-center gap-2 flex-wrap text-sm`,children:[(0,W.jsx)(te,{"aria-label":`Category`,selectedKeys:v?new Set([v]):new Set,onSelectionChange:e=>{let t=Array.from(e)[0];y(t??``),S(``)},size:`sm`,className:`w-[100px]`,radius:`none`,children:a.map(e=>(0,W.jsx)(M,{textValue:u(`types:categories.${e.name}.name`,e.name),children:u(`types:categories.${e.name}.name`,e.name)},e.id))}),(0,W.jsx)(`span`,{className:`opacity-60`,children:`/`}),(0,W.jsx)(te,{"aria-label":`Subtype`,selectedKeys:x?new Set([x]):new Set,onSelectionChange:e=>{let t=Array.from(e)[0];S(t??``)},size:`sm`,isDisabled:!v,className:`w-[140px]`,radius:`none`,children:F.map(e=>(0,W.jsx)(M,{textValue:u(`types:subtypes.${e.name}.name`,e.name),children:u(`types:subtypes.${e.name}.name`,e.name)},e.id))}),(0,W.jsxs)(`span`,{className:`opacity-80 whitespace-nowrap`,children:[`(`,Math.round(e.x),`, `,Math.round(e.y),`)`]})]}),(0,W.jsx)(b,{className:`mt-2`}),(0,W.jsx)(O,{label:u(`common:markerActions.name`,`Name`),labelPlacement:`outside-top`,value:d,onValueChange:f,classNames:I,radius:`none`}),(0,W.jsx)(O,{label:u(`common:markerActions.description`,`Description`),labelPlacement:`outside-top`,value:p,onValueChange:m,classNames:I,radius:`none`}),(0,W.jsx)(vr,{label:u(`common:markerActions.image`,`Image`),initialImageUrl:T,onFileSelected:w}),(0,W.jsx)(b,{className:`mt-4`}),e.status&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(O,{label:u(`common:markerActions.status`,`Status`),labelPlacement:`outside-top`,value:u(`common:markerActions.${e.status}`),classNames:I,radius:`none`,disabled:!0}),(0,W.jsx)(O,{label:u(`common:markerActions.reply`,`Reply`),labelPlacement:`outside-top`,value:e.reply,classNames:I,radius:`none`,disabled:!0}),(0,W.jsx)(b,{className:`mt-4`})]})]}),(0,W.jsxs)(j,{className:`flex gap-6`,children:[(0,W.jsx)(`div`,{className:`flex-1`,children:e?.type!==`feedback`&&(0,W.jsx)(C,{color:`danger`,radius:`sm`,className:`w-full text-background`,isLoading:k,isDisabled:k,onPress:z,children:u(`common:ui.delete`,`Delete`)})}),(0,W.jsx)(`div`,{className:`flex-1`,children:e?.type===`local`&&(0,W.jsx)(C,{color:`default`,onPress:oe,radius:`sm`,className:`w-full`,children:u(`common:ui.save`,`Save`)})}),(0,W.jsx)(`div`,{className:`flex-1`,children:(0,W.jsx)(_,{content:u(`common:markerActions.loginRequired`,`You can only upload after login`),isDisabled:!!c,placement:`top`,delay:300,children:(0,W.jsx)(`span`,{className:`block w-full`,children:(0,W.jsx)(C,{color:`primary`,onPress:c?L:()=>l(!0),className:`w-full text-background`,radius:`sm`,isLoading:E,isDisabled:E,children:e?.status?u(`common:ui.update`,`Update`):u(`common:ui.upload`,`Upload`)})})})})]})]})})})},br=({onUpdate:e})=>(c({mousemove(t){let{lat:n,lng:r}=t.latlng;e(r,n)}}),null),xr=()=>{let e=o(),{pickMode:t}=At();return(0,V.useEffect)(()=>{let n=e.getContainer();n.style.cursor=t?`url(${B(`images/CursorAdd.png`)}) 22 63, crosshair`:`grab`},[e,t]),null},Sr=({createMarker:e})=>{let{pickMode:t}=At();return c({click(n){if(!t)return;let r=n.latlng.lng,i=n.latlng.lat;e(r,i)}}),null},Cr=e(m(),1),wr=e(i(),1);function Tr(){let e=(0,wr.renderToString)((0,W.jsx)(`div`,{style:{color:`#df1414`,fontSize:`32px`,transform:`translate(-50%, -100%)`,filter:`drop-shadow(0 2px 4px rgba(0,0,0,0.6))`},children:(0,W.jsx)(P,{icon:k})}));return Cr.default.divIcon({html:e,className:``,iconSize:[24,24],iconAnchor:[12,24]})}var Er=({selectedMarkerId:e,selectedPosition:t})=>{let n=o(),{markersById:r}=tt();return(0,V.useEffect)(()=>{if(!n||!e)return;let t=r[e];if(!t)return;let i=[t.y,t.x];n.flyTo(i,n.getZoom(),{duration:Se})},[n,e,r]),(0,V.useEffect)(()=>{if(!n||!t)return;let e=[t.y,t.x];n.flyTo(e,n.getZoom(),{duration:Se})},[n,t]),t?(0,W.jsx)(a,{position:new Cr.default.LatLng(t.y,t.x),icon:Tr(),interactive:!1}):null};function Dr(e){return Object.prototype.toString.call(e)===`[object Object]`}function Or(e){return Dr(e)||Array.isArray(e)}function kr(){return!!(typeof window<`u`&&window.document&&window.document.createElement)}function Ar(e,t){let n=Object.keys(e),r=Object.keys(t);return n.length!==r.length||JSON.stringify(Object.keys(e.breakpoints||{}))!==JSON.stringify(Object.keys(t.breakpoints||{}))?!1:n.every(n=>{let r=e[n],i=t[n];return typeof r==`function`?`${r}`==`${i}`:!Or(r)||!Or(i)?r===i:Ar(r,i)})}function jr(e){return e.concat().sort((e,t)=>e.name>t.name?1:-1).map(e=>e.options)}function Mr(e,t){if(e.length!==t.length)return!1;let n=jr(e),r=jr(t);return n.every((e,t)=>{let n=r[t];return Ar(e,n)})}function Nr(e={},t=[]){let n=(0,V.useRef)(e),r=(0,V.useRef)(t),[i,a]=(0,V.useState)(),[o,s]=(0,V.useState)(),c=(0,V.useCallback)(()=>{i&&i.reInit(n.current,r.current)},[i]);return(0,V.useEffect)(()=>{Ar(n.current,e)||(n.current=e,c())},[e,c]),(0,V.useEffect)(()=>{Mr(r.current,t)||(r.current=t,c())},[t,c]),(0,V.useEffect)(()=>{if(kr()&&o){N.globalOptions=Nr.globalOptions;let e=N(o,n.current,r.current);return a(e),()=>e.destroy()}else a(void 0)},[o,a]),[s,i]}Nr.globalOptions=void 0;var Pr=({images:e,selectedIndex:t,onSelect:n,options:r,className:i=``})=>{let[a,o]=Nr({dragFree:!0,containScroll:`trimSnaps`,slidesToScroll:`auto`,...r});return(0,V.useEffect)(()=>{o&&o.scrollTo(t,!0)},[o,t]),(0,W.jsx)(`section`,{className:[`embla-thumbs`,i].join(` `),children:(0,W.jsx)(`div`,{className:`embla-thumbs__viewport`,ref:a,children:(0,W.jsx)(`div`,{className:`embla-thumbs__container`,children:e.map((e,r)=>(0,W.jsx)(`button`,{type:`button`,className:[`embla-thumbs__slide`,r===t?`embla-thumbs__slide--selected`:``].filter(Boolean).join(` `),onClick:()=>n(r),children:(0,W.jsx)(`img`,{src:e,alt:``,loading:`lazy`,className:`embla-thumbs__img`})},r))})})})};const Fr=({selected:e=!1,className:t=``,...n})=>(0,W.jsx)(`button`,{type:`button`,className:[`embla__dot`,e?`embla__dot--selected`:``,t].filter(Boolean).join(` `),...n}),Ir=e=>{let[t,n]=(0,V.useState)(!0),[r,i]=(0,V.useState)(!0),a=(0,V.useCallback)(()=>{e&&e.scrollPrev()},[e]),o=(0,V.useCallback)(()=>{e&&e.scrollNext()},[e]),s=(0,V.useCallback)(e=>{n(!e.canScrollPrev()),i(!e.canScrollNext())},[]);return(0,V.useEffect)(()=>{if(e)return s(e),e.on(`reInit`,s).on(`select`,s),()=>{e.off(`reInit`,s).off(`select`,s)}},[e,s]),{prevBtnDisabled:t,nextBtnDisabled:r,onPrevButtonClick:a,onNextButtonClick:o}},Lr=e=>{let{children:t,...n}=e;return(0,W.jsxs)(`button`,{className:`embla__button embla__button--prev`,type:`button`,...n,children:[(0,W.jsx)(`svg`,{className:`embla__button__svg`,viewBox:`0 0 532 532`,children:(0,W.jsx)(`path`,{fill:`currentColor`,d:`M355.66 11.354c13.793-13.805 36.208-13.805 50.001 0 13.785 13.804 13.785 36.238 0 50.034L201.22 266l204.442 204.61c13.785 13.805 13.785 36.239 0 50.044-13.793 13.796-36.208 13.796-50.002 0a5994246.277 5994246.277 0 0 0-229.332-229.454 35.065 35.065 0 0 1-10.326-25.126c0-9.2 3.393-18.26 10.326-25.2C172.192 194.973 332.731 34.31 355.66 11.354Z`})}),t]})},Rr=e=>{let{children:t,...n}=e;return(0,W.jsxs)(`button`,{className:`embla__button embla__button--next`,type:`button`,...n,children:[(0,W.jsx)(`svg`,{className:`embla__button__svg`,viewBox:`0 0 532 532`,children:(0,W.jsx)(`path`,{fill:`currentColor`,d:`M176.34 520.646c-13.793 13.805-36.208 13.805-50.001 0-13.785-13.804-13.785-36.238 0-50.034L330.78 266 126.34 61.391c-13.785-13.805-13.785-36.239 0-50.044 13.793-13.796 36.208-13.796 50.002 0 22.928 22.947 206.395 206.507 229.332 229.454a35.065 35.065 0 0 1 10.326 25.126c0 9.2-3.393 18.26-10.326 25.2-45.865 45.901-206.404 206.564-229.332 229.52Z`})}),t]})};var zr=({images:e,selectedIndex:t,onSelect:n,options:r,className:i=``})=>{let[a,o]=Nr({loop:!0,...r}),[s,c]=(0,V.useState)([]),l=e.length>1,{prevBtnDisabled:u,nextBtnDisabled:d,onPrevButtonClick:f,onNextButtonClick:p}=Ir(o);(0,V.useEffect)(()=>{if(!o)return;let e=e=>{n(e.selectedScrollSnap())},t=t=>{c(t.scrollSnapList()),e(t)};return c(o.scrollSnapList()),e(o),o.on(`select`,e),o.on(`reInit`,t),()=>{o.off(`select`,e),o.off(`reInit`,t)}},[o,n]),(0,V.useEffect)(()=>{o&&o.scrollTo(t,!1)},[o,t]);let m=(0,V.useCallback)(e=>{o&&o.scrollTo(e)},[o]);return(0,W.jsxs)(`div`,{className:`embla-frame-wrapper`,children:[l&&(0,W.jsx)(Lr,{className:`embla-nav-button__prev`,onClick:f,disabled:u}),(0,W.jsxs)(`section`,{className:[`embla embla--gallery`,i].join(` `),children:[(0,W.jsx)(`div`,{className:`embla__viewport`,ref:a,children:(0,W.jsx)(`div`,{className:`embla__container`,children:e.map((e,t)=>(0,W.jsx)(`div`,{className:`embla__slide`,children:(0,W.jsx)(`div`,{className:`embla__slide__inner`,children:(0,W.jsx)(`img`,{src:e,alt:``,className:`embla__slide__img`})})},t))})}),l&&(0,W.jsx)(`div`,{className:`embla__dots`,children:s.map((e,n)=>(0,W.jsx)(Fr,{onClick:()=>m(n),selected:n===t},n))})]}),l&&(0,W.jsx)(Rr,{className:`embla-nav-button__next`,onClick:p,disabled:d})]})},{entries:Br,setPrototypeOf:Vr,isFrozen:Hr,getPrototypeOf:Ur,getOwnPropertyDescriptor:Wr}=Object,{freeze:Y,seal:Gr,create:Kr}=Object,{apply:qr,construct:Jr}=typeof Reflect<`u`&&Reflect;Y||=function(e){return e},Gr||=function(e){return e},qr||=function(e,t){var n=[...arguments].slice(2);return e.apply(t,n)},Jr||=function(e){return new e(...[...arguments].slice(1))};var Yr=Z(Array.prototype.forEach),Xr=Z(Array.prototype.lastIndexOf),Zr=Z(Array.prototype.pop),Qr=Z(Array.prototype.push),$r=Z(Array.prototype.splice),ei=Z(String.prototype.toLowerCase),ti=Z(String.prototype.toString),ni=Z(String.prototype.match),ri=Z(String.prototype.replace),ii=Z(String.prototype.indexOf),ai=Z(String.prototype.trim),oi=Z(Object.prototype.hasOwnProperty),X=Z(RegExp.prototype.test),si=ci(TypeError);function Z(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);var n=[...arguments].slice(1);return qr(e,t,n)}}function ci(e){return function(){return Jr(e,[...arguments])}}function Q(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ei;Vr&&Vr(e,null);let r=t.length;for(;r--;){let i=t[r];if(typeof i==`string`){let e=n(i);e!==i&&(Hr(t)||(t[r]=e),i=e)}e[i]=!0}return e}function li(e){for(let t=0;t<e.length;t++)oi(e,t)||(e[t]=null);return e}function ui(e){let t=Kr(null);for(let[n,r]of Br(e))oi(e,n)&&(Array.isArray(r)?t[n]=li(r):r&&typeof r==`object`&&r.constructor===Object?t[n]=ui(r):t[n]=r);return t}function di(e,t){for(;e!==null;){let n=Wr(e,t);if(n){if(n.get)return Z(n.get);if(typeof n.value==`function`)return Z(n.value)}e=Ur(e)}function n(){return null}return n}var fi=Y(`a.abbr.acronym.address.area.article.aside.audio.b.bdi.bdo.big.blink.blockquote.body.br.button.canvas.caption.center.cite.code.col.colgroup.content.data.datalist.dd.decorator.del.details.dfn.dialog.dir.div.dl.dt.element.em.fieldset.figcaption.figure.font.footer.form.h1.h2.h3.h4.h5.h6.head.header.hgroup.hr.html.i.img.input.ins.kbd.label.legend.li.main.map.mark.marquee.menu.menuitem.meter.nav.nobr.ol.optgroup.option.output.p.picture.pre.progress.q.rp.rt.ruby.s.samp.search.section.select.shadow.slot.small.source.spacer.span.strike.strong.style.sub.summary.sup.table.tbody.td.template.textarea.tfoot.th.thead.time.tr.track.tt.u.ul.var.video.wbr`.split(`.`)),pi=Y(`svg.a.altglyph.altglyphdef.altglyphitem.animatecolor.animatemotion.animatetransform.circle.clippath.defs.desc.ellipse.enterkeyhint.exportparts.filter.font.g.glyph.glyphref.hkern.image.inputmode.line.lineargradient.marker.mask.metadata.mpath.part.path.pattern.polygon.polyline.radialgradient.rect.stop.style.switch.symbol.text.textpath.title.tref.tspan.view.vkern`.split(`.`)),mi=Y([`feBlend`,`feColorMatrix`,`feComponentTransfer`,`feComposite`,`feConvolveMatrix`,`feDiffuseLighting`,`feDisplacementMap`,`feDistantLight`,`feDropShadow`,`feFlood`,`feFuncA`,`feFuncB`,`feFuncG`,`feFuncR`,`feGaussianBlur`,`feImage`,`feMerge`,`feMergeNode`,`feMorphology`,`feOffset`,`fePointLight`,`feSpecularLighting`,`feSpotLight`,`feTile`,`feTurbulence`]),hi=Y([`animate`,`color-profile`,`cursor`,`discard`,`font-face`,`font-face-format`,`font-face-name`,`font-face-src`,`font-face-uri`,`foreignobject`,`hatch`,`hatchpath`,`mesh`,`meshgradient`,`meshpatch`,`meshrow`,`missing-glyph`,`script`,`set`,`solidcolor`,`unknown`,`use`]),gi=Y(`math.menclose.merror.mfenced.mfrac.mglyph.mi.mlabeledtr.mmultiscripts.mn.mo.mover.mpadded.mphantom.mroot.mrow.ms.mspace.msqrt.mstyle.msub.msup.msubsup.mtable.mtd.mtext.mtr.munder.munderover.mprescripts`.split(`.`)),_i=Y([`maction`,`maligngroup`,`malignmark`,`mlongdiv`,`mscarries`,`mscarry`,`msgroup`,`mstack`,`msline`,`msrow`,`semantics`,`annotation`,`annotation-xml`,`mprescripts`,`none`]),vi=Y([`#text`]),yi=Y(`accept.action.align.alt.autocapitalize.autocomplete.autopictureinpicture.autoplay.background.bgcolor.border.capture.cellpadding.cellspacing.checked.cite.class.clear.color.cols.colspan.controls.controlslist.coords.crossorigin.datetime.decoding.default.dir.disabled.disablepictureinpicture.disableremoteplayback.download.draggable.enctype.enterkeyhint.exportparts.face.for.headers.height.hidden.high.href.hreflang.id.inert.inputmode.integrity.ismap.kind.label.lang.list.loading.loop.low.max.maxlength.media.method.min.minlength.multiple.muted.name.nonce.noshade.novalidate.nowrap.open.optimum.part.pattern.placeholder.playsinline.popover.popovertarget.popovertargetaction.poster.preload.pubdate.radiogroup.readonly.rel.required.rev.reversed.role.rows.rowspan.spellcheck.scope.selected.shape.size.sizes.slot.span.srclang.start.src.srcset.step.style.summary.tabindex.title.translate.type.usemap.valign.value.width.wrap.xmlns.slot`.split(`.`)),bi=Y(`accent-height.accumulate.additive.alignment-baseline.amplitude.ascent.attributename.attributetype.azimuth.basefrequency.baseline-shift.begin.bias.by.class.clip.clippathunits.clip-path.clip-rule.color.color-interpolation.color-interpolation-filters.color-profile.color-rendering.cx.cy.d.dx.dy.diffuseconstant.direction.display.divisor.dur.edgemode.elevation.end.exponent.fill.fill-opacity.fill-rule.filter.filterunits.flood-color.flood-opacity.font-family.font-size.font-size-adjust.font-stretch.font-style.font-variant.font-weight.fx.fy.g1.g2.glyph-name.glyphref.gradientunits.gradienttransform.height.href.id.image-rendering.in.in2.intercept.k.k1.k2.k3.k4.kerning.keypoints.keysplines.keytimes.lang.lengthadjust.letter-spacing.kernelmatrix.kernelunitlength.lighting-color.local.marker-end.marker-mid.marker-start.markerheight.markerunits.markerwidth.maskcontentunits.maskunits.max.mask.mask-type.media.method.mode.min.name.numoctaves.offset.operator.opacity.order.orient.orientation.origin.overflow.paint-order.path.pathlength.patterncontentunits.patterntransform.patternunits.points.preservealpha.preserveaspectratio.primitiveunits.r.rx.ry.radius.refx.refy.repeatcount.repeatdur.restart.result.rotate.scale.seed.shape-rendering.slope.specularconstant.specularexponent.spreadmethod.startoffset.stddeviation.stitchtiles.stop-color.stop-opacity.stroke-dasharray.stroke-dashoffset.stroke-linecap.stroke-linejoin.stroke-miterlimit.stroke-opacity.stroke.stroke-width.style.surfacescale.systemlanguage.tabindex.tablevalues.targetx.targety.transform.transform-origin.text-anchor.text-decoration.text-rendering.textlength.type.u1.u2.unicode.values.viewbox.visibility.version.vert-adv-y.vert-origin-x.vert-origin-y.width.word-spacing.wrap.writing-mode.xchannelselector.ychannelselector.x.x1.x2.xmlns.y.y1.y2.z.zoomandpan`.split(`.`)),xi=Y(`accent.accentunder.align.bevelled.close.columnsalign.columnlines.columnspan.denomalign.depth.dir.display.displaystyle.encoding.fence.frame.height.href.id.largeop.length.linethickness.lspace.lquote.mathbackground.mathcolor.mathsize.mathvariant.maxsize.minsize.movablelimits.notation.numalign.open.rowalign.rowlines.rowspacing.rowspan.rspace.rquote.scriptlevel.scriptminsize.scriptsizemultiplier.selection.separator.separators.stretchy.subscriptshift.supscriptshift.symmetric.voffset.width.xmlns`.split(`.`)),Si=Y([`xlink:href`,`xml:id`,`xlink:title`,`xml:space`,`xmlns:xlink`]),Ci=Gr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),wi=Gr(/<%[\w\W]*|[\w\W]*%>/gm),Ti=Gr(/\$\{[\w\W]*/gm),Ei=Gr(/^data-[\-\w.\u00B7-\uFFFF]+$/),Di=Gr(/^aria-[\-\w]+$/),Oi=Gr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ki=Gr(/^(?:\w+script|data):/i),Ai=Gr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),ji=Gr(/^html$/i),Mi=Gr(/^[a-z][.\w]*(-[.\w]+)+$/i),Ni=Object.freeze({__proto__:null,ARIA_ATTR:Di,ATTR_WHITESPACE:Ai,CUSTOM_ELEMENT:Mi,DATA_ATTR:Ei,DOCTYPE_NAME:ji,ERB_EXPR:wi,IS_ALLOWED_URI:Oi,IS_SCRIPT_OR_DATA:ki,MUSTACHE_EXPR:Ci,TMPLIT_EXPR:Ti}),Pi={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},Fi=function(){return typeof window>`u`?null:window},Ii=function(e,t){if(typeof e!=`object`||typeof e.createPolicy!=`function`)return null;let n=null,r=`data-tt-policy-suffix`;t&&t.hasAttribute(r)&&(n=t.getAttribute(r));let i=`dompurify`+(n?`#`+n:``);try{return e.createPolicy(i,{createHTML(e){return e},createScriptURL(e){return e}})}catch{return console.warn(`TrustedTypes policy `+i+` could not be created.`),null}},Li=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Ri(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fi(),t=e=>Ri(e);if(t.version=`3.3.0`,t.removed=[],!e||!e.document||e.document.nodeType!==Pi.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e,r=n,i=r.currentScript,{DocumentFragment:a,HTMLTemplateElement:o,Node:s,Element:c,NodeFilter:l,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:f,trustedTypes:p}=e,m=c.prototype,h=di(m,`cloneNode`),g=di(m,`remove`),_=di(m,`nextSibling`),v=di(m,`childNodes`),y=di(m,`parentNode`);if(typeof o==`function`){let e=n.createElement(`template`);e.content&&e.content.ownerDocument&&(n=e.content.ownerDocument)}let b,x=``,{implementation:S,createNodeIterator:C,createDocumentFragment:ee,getElementsByTagName:w}=n,{importNode:T}=r,E=Li();t.isSupported=typeof Br==`function`&&typeof y==`function`&&S&&S.createHTMLDocument!==void 0;let{MUSTACHE_EXPR:D,ERB_EXPR:O,TMPLIT_EXPR:k,DATA_ATTR:A,ARIA_ATTR:te,IS_SCRIPT_OR_DATA:ne,ATTR_WHITESPACE:j,CUSTOM_ELEMENT:re}=Ni,{IS_ALLOWED_URI:ie}=Ni,M=null,ae=Q({},[...fi,...pi,...mi,...gi,...vi]),N=null,P=Q({},[...yi,...bi,...xi,...Si]),F=Object.seal(Kr(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),I=null,L=null,R=Object.seal(Kr(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}})),oe=!0,z=!0,se=!1,ce=!0,le=!1,ue=!0,B=!1,de=!1,fe=!1,pe=!1,me=!1,he=!1,ge=!0,_e=!1,ve=!0,ye=!1,be={},xe=null,Se=Q({},[`annotation-xml`,`audio`,`colgroup`,`desc`,`foreignobject`,`head`,`iframe`,`math`,`mi`,`mn`,`mo`,`ms`,`mtext`,`noembed`,`noframes`,`noscript`,`plaintext`,`script`,`style`,`svg`,`template`,`thead`,`title`,`video`,`xmp`]),Ce=null,we=Q({},[`audio`,`video`,`img`,`source`,`image`,`track`]),Te=null,Ee=Q({},[`alt`,`class`,`for`,`id`,`label`,`name`,`pattern`,`placeholder`,`role`,`summary`,`title`,`value`,`style`,`xmlns`]),De=`http://www.w3.org/1998/Math/MathML`,Oe=`http://www.w3.org/2000/svg`,ke=`http://www.w3.org/1999/xhtml`,Ae=ke,je=!1,V=null,Me=Q({},[De,Oe,ke],ti),Ne=Q({},[`mi`,`mo`,`mn`,`ms`,`mtext`]),Pe=Q({},[`annotation-xml`]),Fe=Q({},[`title`,`style`,`font`,`a`,`script`]),Ie=null,Le=[`application/xhtml+xml`,`text/html`],H=null,Re=null,ze=n.createElement(`form`),Be=function(e){return e instanceof RegExp||e instanceof Function},Ve=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Re&&Re===e)){if((!e||typeof e!=`object`)&&(e={}),e=ui(e),Ie=Le.indexOf(e.PARSER_MEDIA_TYPE)===-1?`text/html`:e.PARSER_MEDIA_TYPE,H=Ie===`application/xhtml+xml`?ti:ei,M=oi(e,`ALLOWED_TAGS`)?Q({},e.ALLOWED_TAGS,H):ae,N=oi(e,`ALLOWED_ATTR`)?Q({},e.ALLOWED_ATTR,H):P,V=oi(e,`ALLOWED_NAMESPACES`)?Q({},e.ALLOWED_NAMESPACES,ti):Me,Te=oi(e,`ADD_URI_SAFE_ATTR`)?Q(ui(Ee),e.ADD_URI_SAFE_ATTR,H):Ee,Ce=oi(e,`ADD_DATA_URI_TAGS`)?Q(ui(we),e.ADD_DATA_URI_TAGS,H):we,xe=oi(e,`FORBID_CONTENTS`)?Q({},e.FORBID_CONTENTS,H):Se,I=oi(e,`FORBID_TAGS`)?Q({},e.FORBID_TAGS,H):ui({}),L=oi(e,`FORBID_ATTR`)?Q({},e.FORBID_ATTR,H):ui({}),be=oi(e,`USE_PROFILES`)?e.USE_PROFILES:!1,oe=e.ALLOW_ARIA_ATTR!==!1,z=e.ALLOW_DATA_ATTR!==!1,se=e.ALLOW_UNKNOWN_PROTOCOLS||!1,ce=e.ALLOW_SELF_CLOSE_IN_ATTR!==!1,le=e.SAFE_FOR_TEMPLATES||!1,ue=e.SAFE_FOR_XML!==!1,B=e.WHOLE_DOCUMENT||!1,pe=e.RETURN_DOM||!1,me=e.RETURN_DOM_FRAGMENT||!1,he=e.RETURN_TRUSTED_TYPE||!1,fe=e.FORCE_BODY||!1,ge=e.SANITIZE_DOM!==!1,_e=e.SANITIZE_NAMED_PROPS||!1,ve=e.KEEP_CONTENT!==!1,ye=e.IN_PLACE||!1,ie=e.ALLOWED_URI_REGEXP||Oi,Ae=e.NAMESPACE||ke,Ne=e.MATHML_TEXT_INTEGRATION_POINTS||Ne,Pe=e.HTML_INTEGRATION_POINTS||Pe,F=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&Be(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(F.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&Be(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(F.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements==`boolean`&&(F.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),le&&(z=!1),me&&(pe=!0),be&&(M=Q({},vi),N=[],be.html===!0&&(Q(M,fi),Q(N,yi)),be.svg===!0&&(Q(M,pi),Q(N,bi),Q(N,Si)),be.svgFilters===!0&&(Q(M,mi),Q(N,bi),Q(N,Si)),be.mathMl===!0&&(Q(M,gi),Q(N,xi),Q(N,Si))),e.ADD_TAGS&&(typeof e.ADD_TAGS==`function`?R.tagCheck=e.ADD_TAGS:(M===ae&&(M=ui(M)),Q(M,e.ADD_TAGS,H))),e.ADD_ATTR&&(typeof e.ADD_ATTR==`function`?R.attributeCheck=e.ADD_ATTR:(N===P&&(N=ui(N)),Q(N,e.ADD_ATTR,H))),e.ADD_URI_SAFE_ATTR&&Q(Te,e.ADD_URI_SAFE_ATTR,H),e.FORBID_CONTENTS&&(xe===Se&&(xe=ui(xe)),Q(xe,e.FORBID_CONTENTS,H)),ve&&(M[`#text`]=!0),B&&Q(M,[`html`,`head`,`body`]),M.table&&(Q(M,[`tbody`]),delete I.tbody),e.TRUSTED_TYPES_POLICY){if(typeof e.TRUSTED_TYPES_POLICY.createHTML!=`function`)throw si(`TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.`);if(typeof e.TRUSTED_TYPES_POLICY.createScriptURL!=`function`)throw si(`TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.`);b=e.TRUSTED_TYPES_POLICY,x=b.createHTML(``)}else b===void 0&&(b=Ii(p,i)),b!==null&&typeof x==`string`&&(x=b.createHTML(``));Y&&Y(e),Re=e}},He=Q({},[...pi,...mi,...hi]),Ue=Q({},[...gi,..._i]),We=function(e){let t=y(e);(!t||!t.tagName)&&(t={namespaceURI:Ae,tagName:`template`});let n=ei(e.tagName),r=ei(t.tagName);return V[e.namespaceURI]?e.namespaceURI===Oe?t.namespaceURI===ke?n===`svg`:t.namespaceURI===De?n===`svg`&&(r===`annotation-xml`||Ne[r]):!!He[n]:e.namespaceURI===De?t.namespaceURI===ke?n===`math`:t.namespaceURI===Oe?n===`math`&&Pe[r]:!!Ue[n]:e.namespaceURI===ke?t.namespaceURI===Oe&&!Pe[r]||t.namespaceURI===De&&!Ne[r]?!1:!Ue[n]&&(Fe[n]||!He[n]):!!(Ie===`application/xhtml+xml`&&V[e.namespaceURI]):!1},Ge=function(e){Qr(t.removed,{element:e});try{y(e).removeChild(e)}catch{g(e)}},U=function(e,n){try{Qr(t.removed,{attribute:n.getAttributeNode(e),from:n})}catch{Qr(t.removed,{attribute:null,from:n})}if(n.removeAttribute(e),e===`is`)if(pe||me)try{Ge(n)}catch{}else try{n.setAttribute(e,``)}catch{}},Ke=function(e){let t=null,r=null;if(fe)e=`<remove></remove>`+e;else{let t=ni(e,/^[\r\n\t ]+/);r=t&&t[0]}Ie===`application/xhtml+xml`&&Ae===ke&&(e=`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>`+e+`</body></html>`);let i=b?b.createHTML(e):e;if(Ae===ke)try{t=new f().parseFromString(i,Ie)}catch{}if(!t||!t.documentElement){t=S.createDocument(Ae,`template`,null);try{t.documentElement.innerHTML=je?x:i}catch{}}let a=t.body||t.documentElement;return e&&r&&a.insertBefore(n.createTextNode(r),a.childNodes[0]||null),Ae===ke?w.call(t,B?`html`:`body`)[0]:B?t.documentElement:a},W=function(e){return C.call(e.ownerDocument||e,e,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null)},qe=function(e){return e instanceof d&&(typeof e.nodeName!=`string`||typeof e.textContent!=`string`||typeof e.removeChild!=`function`||!(e.attributes instanceof u)||typeof e.removeAttribute!=`function`||typeof e.setAttribute!=`function`||typeof e.namespaceURI!=`string`||typeof e.insertBefore!=`function`||typeof e.hasChildNodes!=`function`)},Je=function(e){return typeof s==`function`&&e instanceof s};function G(e,n,r){Yr(e,e=>{e.call(t,n,r,Re)})}let Ye=function(e){let n=null;if(G(E.beforeSanitizeElements,e,null),qe(e))return Ge(e),!0;let r=H(e.nodeName);if(G(E.uponSanitizeElement,e,{tagName:r,allowedTags:M}),ue&&e.hasChildNodes()&&!Je(e.firstElementChild)&&X(/<[/\w!]/g,e.innerHTML)&&X(/<[/\w!]/g,e.textContent)||e.nodeType===Pi.progressingInstruction||ue&&e.nodeType===Pi.comment&&X(/<[/\w]/g,e.data))return Ge(e),!0;if(!(R.tagCheck instanceof Function&&R.tagCheck(r))&&(!M[r]||I[r])){if(!I[r]&&Ze(r)&&(F.tagNameCheck instanceof RegExp&&X(F.tagNameCheck,r)||F.tagNameCheck instanceof Function&&F.tagNameCheck(r)))return!1;if(ve&&!xe[r]){let t=y(e)||e.parentNode,n=v(e)||e.childNodes;if(n&&t){let r=n.length;for(let i=r-1;i>=0;--i){let r=h(n[i],!0);r.__removalCount=(e.__removalCount||0)+1,t.insertBefore(r,_(e))}}}return Ge(e),!0}return e instanceof c&&!We(e)||(r===`noscript`||r===`noembed`||r===`noframes`)&&X(/<\/no(script|embed|frames)/i,e.innerHTML)?(Ge(e),!0):(le&&e.nodeType===Pi.text&&(n=e.textContent,Yr([D,O,k],e=>{n=ri(n,e,` `)}),e.textContent!==n&&(Qr(t.removed,{element:e.cloneNode()}),e.textContent=n)),G(E.afterSanitizeElements,e,null),!1)},Xe=function(e,t,r){if(ge&&(t===`id`||t===`name`)&&(r in n||r in ze))return!1;if(!(z&&!L[t]&&X(A,t))&&!(oe&&X(te,t))&&!(R.attributeCheck instanceof Function&&R.attributeCheck(t,e))){if(!N[t]||L[t]){if(!(Ze(e)&&(F.tagNameCheck instanceof RegExp&&X(F.tagNameCheck,e)||F.tagNameCheck instanceof Function&&F.tagNameCheck(e))&&(F.attributeNameCheck instanceof RegExp&&X(F.attributeNameCheck,t)||F.attributeNameCheck instanceof Function&&F.attributeNameCheck(t,e))||t===`is`&&F.allowCustomizedBuiltInElements&&(F.tagNameCheck instanceof RegExp&&X(F.tagNameCheck,r)||F.tagNameCheck instanceof Function&&F.tagNameCheck(r))))return!1}else if(!Te[t]&&!X(ie,ri(r,j,``))&&!((t===`src`||t===`xlink:href`||t===`href`)&&e!==`script`&&ii(r,`data:`)===0&&Ce[e])&&!(se&&!X(ne,ri(r,j,``)))&&r)return!1}return!0},Ze=function(e){return e!==`annotation-xml`&&ni(e,re)},Qe=function(e){G(E.beforeSanitizeAttributes,e,null);let{attributes:n}=e;if(!n||qe(e))return;let r={attrName:``,attrValue:``,keepAttr:!0,allowedAttributes:N,forceKeepAttr:void 0},i=n.length;for(;i--;){let{name:a,namespaceURI:o,value:s}=n[i],c=H(a),l=s,u=a===`value`?l:ai(l);if(r.attrName=c,r.attrValue=u,r.keepAttr=!0,r.forceKeepAttr=void 0,G(E.uponSanitizeAttribute,e,r),u=r.attrValue,_e&&(c===`id`||c===`name`)&&(U(a,e),u=`user-content-`+u),ue&&X(/((--!?|])>)|<\/(style|title|textarea)/i,u)){U(a,e);continue}if(c===`attributename`&&ni(u,`href`)){U(a,e);continue}if(r.forceKeepAttr)continue;if(!r.keepAttr){U(a,e);continue}if(!ce&&X(/\/>/i,u)){U(a,e);continue}le&&Yr([D,O,k],e=>{u=ri(u,e,` `)});let d=H(e.nodeName);if(!Xe(d,c,u)){U(a,e);continue}if(b&&typeof p==`object`&&typeof p.getAttributeType==`function`&&!o)switch(p.getAttributeType(d,c)){case`TrustedHTML`:u=b.createHTML(u);break;case`TrustedScriptURL`:u=b.createScriptURL(u);break}if(u!==l)try{o?e.setAttributeNS(o,a,u):e.setAttribute(a,u),qe(e)?Ge(e):Zr(t.removed)}catch{U(a,e)}}G(E.afterSanitizeAttributes,e,null)},$e=function e(t){let n=null,r=W(t);for(G(E.beforeSanitizeShadowDOM,t,null);n=r.nextNode();)G(E.uponSanitizeShadowNode,n,null),Ye(n),Qe(n),n.content instanceof a&&e(n.content);G(E.afterSanitizeShadowDOM,t,null)};return t.sanitize=function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=null,o=null,c=null,l=null;if(je=!e,je&&(e=`<!-->`),typeof e!=`string`&&!Je(e))if(typeof e.toString==`function`){if(e=e.toString(),typeof e!=`string`)throw si(`dirty is not a string, aborting`)}else throw si(`toString is not a function`);if(!t.isSupported)return e;if(de||Ve(n),t.removed=[],typeof e==`string`&&(ye=!1),ye){if(e.nodeName){let t=H(e.nodeName);if(!M[t]||I[t])throw si(`root node is forbidden and cannot be sanitized in-place`)}}else if(e instanceof s)i=Ke(`<!---->`),o=i.ownerDocument.importNode(e,!0),o.nodeType===Pi.element&&o.nodeName===`BODY`||o.nodeName===`HTML`?i=o:i.appendChild(o);else{if(!pe&&!le&&!B&&e.indexOf(`<`)===-1)return b&&he?b.createHTML(e):e;if(i=Ke(e),!i)return pe?null:he?x:``}i&&fe&&Ge(i.firstChild);let u=W(ye?e:i);for(;c=u.nextNode();)Ye(c),Qe(c),c.content instanceof a&&$e(c.content);if(ye)return e;if(pe){if(me)for(l=ee.call(i.ownerDocument);i.firstChild;)l.appendChild(i.firstChild);else l=i;return(N.shadowroot||N.shadowrootmode)&&(l=T.call(r,l,!0)),l}let d=B?i.outerHTML:i.innerHTML;return B&&M[`!doctype`]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&X(ji,i.ownerDocument.doctype.name)&&(d=`<!DOCTYPE `+i.ownerDocument.doctype.name+`>
`+d),le&&Yr([D,O,k],e=>{d=ri(d,e,` `)}),b&&he?b.createHTML(d):d},t.setConfig=function(){Ve(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}),de=!0},t.clearConfig=function(){Re=null,de=!1},t.isValidAttribute=function(e,t,n){return Re||Ve({}),Xe(H(e),H(t),n)},t.addHook=function(e,t){typeof t==`function`&&Qr(E[e],t)},t.removeHook=function(e,t){if(t!==void 0){let n=Xr(E[e],t);return n===-1?void 0:$r(E[e],n,1)[0]}return Zr(E[e])},t.removeHooks=function(e){E[e]=[]},t.removeAllHooks=function(){E=Li()},t}var zi=Ri();function Bi(e){return{__html:zi.sanitize(e)}}var Vi=({marker:e,onSelectMarker:t})=>{let{selectedMap:n,types:r}=G(),{allSubtypes:i}=ot(),a=`regions/${n?.name}`,{t:o}=R([a]),{user:s,setUserModalOpen:c,fetchWithAuth:l}=ue(),{completedBySubtype:u,toggleMarkerCompleted:d}=tt(),{setEditingMarker:f,userMarkersByMarkerId:p}=At(),[m,h]=(0,V.useState)(!1),[g,_]=(0,V.useState)(0),[v,y]=(0,V.useState)(!1),[x,S]=(0,V.useState)(``),[w,T]=(0,V.useState)([]);if(!n)return null;let D=e.images&&e.images.length>0,k=e.images?.map(e=>se(e+`.small.webp`)),te=e.images?.map(e=>se(e+`.normal.webp`)),j=i.get(e.subtype),re=r.find(e=>e.name===j?.category),ie=o(`types:categories.${re?.name}.name`),M=o(`types:subtypes.${j?.name}.name`),N=`${a}:${e.region}`,F=e.region?o(`${N}.name`):``,I=!!j?.canComplete,L=e.localizedName;L||=!e.name||re?.name==`collection`?M:e.name;let oe=e.localizedDescription||``,z=!1;j?.name&&u[j.name]&&(z=u[j.name].has(e.indexInSubtype));let ce=async()=>{let t=await l(`/maps/${n?.name}/markers/${e.id}/comments`,{method:`GET`,headers:{"Content-Type":`application/json`}});if(!t.ok)return;let r=await t.json();!r.data||r?.errorCode!=`Success`||(console.log(r.data),T(r.data.results))};return(0,W.jsxs)(E,{className:`
      w-[360px]
      p-5 text-xs leading-snug
      text-foreground
      bg-sidebar
      space-y-5
    `,radius:`sm`,children:[(0,W.jsxs)(`div`,{children:[(0,W.jsx)(`div`,{className:`text-[18px] leading-[18px] font-bold`,children:L}),e.contributors.length>0&&(0,W.jsx)(`div`,{className:`text-[14px] leading-[14px] mt-2`,children:(0,W.jsx)(Ge,{t:o,i18nKey:`common:markerActions.providedBy`,defaults:`This location is provided by <emph>{{contributor}}</emph>`,values:{contributor:e.contributors.join(`, `)},components:{emph:(0,W.jsx)(`span`,{className:`text-success-600`})}})})]}),(0,W.jsxs)(`div`,{className:`text-[14px] leading-[14px]`,children:[ie,` / `,M,` `,(0,W.jsxs)(`span`,{className:`opacity-80`,children:[`(`,e.x.toFixed(0),`, `,e.y.toFixed(0),`)`]}),F?` / ${F}`:null]}),(0,W.jsx)(b,{}),oe&&(0,W.jsx)(`div`,{className:`text-[14px] leading-[14px]`,children:oe}),D&&(0,W.jsx)(`div`,{className:`w-full h-28 rounded-md `,children:(0,W.jsx)(Pr,{images:k,selectedIndex:g,onSelect:e=>{_(e),h(!0)}})}),!s&&(0,W.jsxs)(`div`,{className:`text-[14px] leading-[14px] flex items-center justify-between`,children:[(0,W.jsx)(`button`,{type:`button`,className:`text-primary hover:underline`,onClick:()=>c(!0),children:o(`common:auth.loginPrompt`,`You can submit issue after login!`)}),(0,W.jsxs)(`button`,{type:`button`,className:`text-primary hover:underline`,onClick:()=>c(!0),children:[o(`common:auth.loginGo`,`Go to login`),` >`]})]}),(0,W.jsx)(b,{}),(0,W.jsxs)(`div`,{className:`flex gap-6`,children:[(0,W.jsx)(`div`,{className:`flex-1`,children:s&&(0,W.jsx)(C,{size:`sm`,variant:`light`,color:`default`,onPress:async()=>{v||await ce(),y(!v)},startContent:(0,W.jsx)(P,{icon:ee,className:`text-sm`}),children:o(`common:markerActions:comments`,`Comments`)})}),(0,W.jsx)(`div`,{className:`flex-1`,children:s&&(0,W.jsx)(C,{size:`sm`,color:`danger`,variant:`flat`,onPress:()=>{let t;p[e.id]?(t={...p[e.id]},t.image||=e.images?e.images[0]+`.full`:``):t={id:Tt(),markerId:e.id,subtype:j?.id||``,mapId:n.id,x:e.x,y:e.y,name:e.localizedName,description:e.localizedDescription||``,image:e.images?e.images[0]+`.full`:``,type:`feedback`},f(t)},children:o(`common:markerActions.feedback`,`Marker Feedback`)})}),(0,W.jsx)(`div`,{className:`flex-1`,children:I&&(0,W.jsx)(C,{size:`sm`,variant:`flat`,color:z?`success`:`primary`,onPress:()=>{t(null),d(e)},children:z?o(`common:markerActions:markNotCompleted`,`Completed`):o(`common:markerActions:markCompleted`,`Mark as completed`)})})]}),v&&(0,W.jsxs)(`div`,{className:`flex flex-col gap-2`,children:[w.length>0&&(0,W.jsx)(`div`,{className:`flex flex-col gap-3`,children:w.map(e=>(0,W.jsxs)(`div`,{className:`p-3 rounded-md text-sm leading-snug`,children:[(0,W.jsx)(`div`,{className:`text-foreground`,dangerouslySetInnerHTML:Bi(e.content)}),(0,W.jsx)(`div`,{className:`text-xs text-default-700 mt-1`,children:new Date(e.createdAt).toLocaleString()})]},e.id))}),(0,W.jsx)(O,{placeholder:o(`common:markerActions:enterComment`,`Write a commentâ€¦`),value:x,onValueChange:S,radius:`sm`,size:`sm`,className:`w-full mb-3`}),(0,W.jsx)(`div`,{className:`flex justify-end`,children:(0,W.jsx)(C,{size:`sm`,color:`primary`,radius:`sm`,onPress:async()=>{console.log(`Comment submit:`,x),x&&(await l(`/maps/${n?.name}/markers/${e.id}/comments`,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({content:x})})).ok&&(await ce(),S(``))},className:`text-background`,children:o(`common:ui.submit`,`Submit`)})})]}),(0,W.jsx)(ae,{isOpen:m,onOpenChange:e=>h(e),size:`5xl`,backdrop:`blur`,placement:`center`,isDismissable:!0,hideCloseButton:!0,classNames:{wrapper:`z-[20000]`,base:`bg-transparent shadow-none`},children:(0,W.jsx)(ne,{children:()=>(0,W.jsx)(A,{className:`p-0 flex items-center justify-center`,children:(0,W.jsxs)(`div`,{className:`relative w-[90vw] max-w-5xl h-[80vh] bg-black/60 dark:bg-black/70 rounded-xl overflow-hidden backdrop-blur-md p-4`,children:[(0,W.jsx)(`button`,{type:`button`,onClick:()=>h(!1),className:`
                    absolute top-3 right-3 z-20
                    inline-flex h-8 w-8 items-center justify-center
                    rounded-full
                    bg-black/60 text-white
                    hover:bg-black/80
                    dark:bg-white/80 dark:text-black dark:hover:bg-white
                    shadow-md
                  `,"aria-label":`Close gallery`,children:`âœ•`}),(0,W.jsx)(zr,{images:te,selectedIndex:g,onSelect:_})]})})})})]})},Hi=({onSelectMarker:e,selectedMarkerId:t})=>{let{markersById:n}=tt();if(c({click(){e(null)}}),!t)return null;let r=n[t];return r?(0,W.jsx)(l,{position:[r.y+10,r.x],maxWidth:360,minWidth:360,autoPan:!0,closeButton:!1,children:(0,W.jsx)(Vi,{marker:r,onSelectMarker:e})}):null},Ui=({onOpenMenu:e,onCloseMenu:t})=>{let{setPickMode:n,pickMode:r}=At(),i=c({contextmenu(t){if(t.originalEvent.preventDefault(),r){n(!1);return}let a=t.latlng.lng,o=t.latlng.lat,s=i.latLngToContainerPoint(t.latlng);e({x:s.x,y:s.y,mapX:a,mapY:o})},click(){t()},movestart(){t()},zoomstart(){t()}});return null},Wi=e(m(),1),Gi=({mapRef:e,onSelectMarker:t,selectedMarkerId:n,selectedPosition:r})=>{let[i,a]=(0,V.useState)(null),[o,s]=(0,V.useState)(null),[c,l]=(0,V.useState)(void 0),{selectedMap:d}=G(),{visibleSubtypes:f}=ot(),{markers:p}=tt(),{pickMode:m,createMarker:h,userMarkers:g,hideUserMarkers:_}=At(),v=`regions/${d?.name}`,{t:y}=R([v]),b=c?y(`${v}:${c.name}.name`):``,x=(0,V.useCallback)((e,t)=>{let n=`${Math.round(e)}, ${Math.round(t)}`;typeof navigator<`u`&&navigator.clipboard?.writeText?navigator.clipboard.writeText(n).catch(e=>console.error(`Clipboard error`,e)):console.log(`Copied position:`,n)},[]),S=(0,V.useMemo)(()=>n?(0,W.jsx)(Hi,{selectedMarkerId:n,onSelectMarker:t}):null,[n,t]);if(!d)return(0,W.jsx)(`div`,{className:`flex-1 flex items-center justify-center text-sm text-default-500`,children:`No map selected.`});let C=d.tileWidth*d.tilesCountX,ee=d.tileHeight*d.tilesCountY,w=[[0,0],[ee,C]],T=[ee/2,C/2];return(0,W.jsxs)(`div`,{className:`flex-1 relative`,onClick:()=>s(null),style:{cursor:m?`crosshair`:`default`},children:[(0,W.jsxs)(u,{center:T,bounds:w,zoom:0,minZoom:-3,maxZoom:2,zoomSnap:.25,zoomDelta:.25,crs:Wi.default.CRS.Simple,className:`w-full h-full`,attributionControl:!1,ref:e,children:[(0,W.jsx)(br,{onUpdate:(e,t)=>{a({x:e,y:t})}}),(0,W.jsx)(xr,{}),(0,W.jsx)(Sr,{createMarker:h}),(0,W.jsx)(Ui,{onOpenMenu:e=>s(e),onCloseMenu:()=>s(null)}),(0,W.jsx)(pt,{selectedMap:d}),(0,W.jsx)(_t,{hoveredRegion:c,setHoveredRegion:l}),p.filter(e=>n===e.id||f?.has(e.subtype)).map(e=>(0,W.jsx)(ut,{marker:e,onSelectMarker:t},e.id)),_?null:g.filter(e=>e.type!==`feedback`).map(e=>(0,W.jsx)(Ft,{marker:e},e.id)),(0,W.jsx)(Er,{selectedMarkerId:n,selectedPosition:r}),S]},d.id),(0,W.jsx)(`div`,{className:`
          absolute bottom-15 left-3 z-[1000]
          font-medium
          text-[15px]
          leading-[15px]
          text-white/80
          text-left
          not-italic
          normal-case
          drop-shadow-[0_2px_4px_rgba(0,0,0,0.7)]
        `,children:`æ²ªICPå¤‡2025152827å·-1`}),i&&(0,W.jsxs)(`div`,{className:`absolute bottom-3 left-3 z-[1000] rounded bg-black/80 text-white text-sm px-3 py-1.5 pointer-events-none shadow-lg backdrop-blur-sm`,children:[`x: `,i.x.toFixed(0),`, y: `,i.y.toFixed(0),` `,b]}),o&&(0,W.jsx)(`div`,{className:`absolute z-[5000]`,style:{left:o.x,top:o.y},onClick:e=>e.stopPropagation(),children:(0,W.jsx)(`div`,{className:`min-w-[190px] rounded-md border border-default-200 bg-content1 shadow-lg text-sm py-1`,children:(0,W.jsxs)(`button`,{type:`button`,className:`w-full px-3 py-1.5 text-left hover:bg-default-100`,onClick:e=>{e.stopPropagation(),x(o.mapX,o.mapY),s(null)},children:[`Copy position (`,Math.round(o.mapX),`,`,` `,Math.round(o.mapY),`)`]})})}),(0,W.jsx)(yr,{}),!1]})},Ki=({side:e=`left`,width:t=370,collapsedWidth:n=0,collapsed:r=!1,onToggleCollapsed:i,children:a,extraControls:o})=>{let{t:s}=R(`common`),[c,l]=(0,V.useState)(r),{theme:u}=oe(),d=B(u===`dark`?`images/Sidebar_Dark.webp`:`images/Sidebar_Light.webp`),f=e===`left`,p=()=>{i&&i(!r),l(e=>!e)},m=f?`right-0 translate-x-full rounded-r-md rounded-l-none`:`left-0 -translate-x-full rounded-l-md rounded-r-none`;return(0,W.jsxs)(`aside`,{className:`
        relative h-full flex flex-col bg-sidebar transition-all duration-300 
      `,style:{width:c?n:t,maxWidth:t},children:[(0,W.jsx)(`div`,{className:`absolute inset-0 pointer-events-none opacity-70 bg-no-repeat bg-top-left`,style:{backgroundImage:`url(${d})`,backgroundSize:`370px auto`}}),(0,W.jsx)(`div`,{className:`flex-1 overflow-y-scroll sidebar-scroll`,children:a}),(0,W.jsxs)(`button`,{onClick:p,className:`
          absolute top-[100px] flex flex-col items-center justify-center z-[20000] 
          w-8 h-12 bg-sidebar-collapse text-default-700 select-none
          ${m}
        `,children:[(0,W.jsx)(P,{icon:f?c?re:T:c?T:re,className:`text-sm`}),(0,W.jsx)(`span`,{className:`text-[10px] leading-tight mt-0.5 whitespace-normal text-center px-0.5`,children:c?s(`menu.expand`,`Expand`):s(`menu.collapse`,`Collapse`)})]}),o&&(0,W.jsx)(`div`,{className:`
            absolute top-[160px] z-[20000]
            flex flex-col items-center
            ${f?`right-0 translate-x-full`:`left-0 -translate-x-full`}
          `,children:o})]})},qi=()=>{let{t:e}=R(),t=B(`images/Logo.webp`),n=e(`common:siteTitle`,`AION2
Interactive Map`).replace(/\n/g,`<br />`);return(0,W.jsxs)(`div`,{className:`w-full flex items-center justify-center select-none gap-6`,children:[(0,W.jsx)(`img`,{src:t,alt:`AION2 Logo`,className:`w-[100px] h-[100px] object-contain`}),(0,W.jsx)(`div`,{className:`text-[22px] leading-[30px] font-bold text-primary text-center`,dangerouslySetInnerHTML:{__html:n}})]})},Ji=()=>{let{maps:e,selectedMap:t,setSelectedMap:n}=G(),{t:r}=R();return(0,W.jsx)(`div`,{className:`w-full flex justify-center mt-5`,children:(0,W.jsx)(`div`,{className:`
          w-[323px] h-[38px]
          flex items-center justify-center
          border border-transparent
          rounded-none
        `,style:{background:`linear-gradient(90deg, rgba(190,211,222,0) 0%, rgba(190,211,222,0.5) 54%, rgba(190,211,222,0) 100%)`,borderImage:`linear-gradient(90deg, rgba(165,187,200,0), rgba(165,187,200,1), rgba(165,187,200,0)) 1`},children:(0,W.jsx)(te,{"aria-label":`Select map`,size:`sm`,selectedKeys:t?[t.name]:[],onSelectionChange:t=>{let r=Array.from(t)[0],i=e.find(e=>e.name===r);i&&setTimeout(()=>{n(i)},50)},classNames:{trigger:[`w-auto`,`px-2 py-1`,`bg-transparent shadow-none`,`flex items-center justify-center gap-2`,`hover:bg-transparent`,`data-[hover=true]:bg-transparent`,`active:bg-transparent`,`focus:bg-transparent`].join(` `),value:`text-sm font-medium text-center text-[18px] leading-[18px] `,innerWrapper:`static flex items-center justify-center`,selectorIcon:[`text-default-900`].join(` `),popoverContent:`bg-content1`},className:`text-center max-w-[260px]`,radius:`none`,children:e.map(e=>(0,W.jsx)(M,{children:r(`maps:${e.name}.name`,e.name)},e.name))})})})},Yi=({isOpen:e,onClose:t,onConfirm:n})=>{let{t:r}=R();return(0,W.jsx)(ae,{isOpen:e,onOpenChange:e=>{e||t()},classNames:{wrapper:`z-[20000]`},children:(0,W.jsx)(ne,{children:e=>(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(ie,{children:r(`common:menu.clearMarkerCompleted`)}),(0,W.jsx)(A,{children:r(`common:menu.clearMarkerCompletedBody`)}),(0,W.jsxs)(j,{children:[(0,W.jsx)(C,{variant:`light`,onPress:e,children:r(`common:ui.cancel`)}),(0,W.jsx)(C,{color:`danger`,onPress:()=>{n(),e()},children:r(`common:ui.confirm`)})]})]})})})},Xi=()=>{let{types:e,selectedMap:t}=G(),{handleShowAllSubtypes:n,handleHideAllSubtypes:r,visibleSubtypes:i,handleToggleSubtype:a,showBorders:o,handleToggleBorders:s}=ot(),{clearMarkerCompleted:c,showLabels:l,setShowLabels:u,subtypeCounts:d,completedCounts:f}=tt(),{hideUserMarkers:p,setHideUserMarkers:m}=At(),{t:h}=R(`common`),[v,b]=(0,V.useState)(!1),x=(e=!1)=>{let t={radius:`sm`,fullWidth:!0,className:`text-[14px] leading-[14px] font-normal h-[30px] gap-2 px-2`,variant:e?`solid`:`flat`,color:e?`primary`:`default`};return e?t.className+=` text-background`:t.className+=` bg-sidebar-button text-default-700`,t};return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsxs)(`div`,{className:`w-full flex flex-col px-2 my-0 pb-4`,children:[(0,W.jsxs)(`div`,{className:`grid grid-cols-2 gap-2`,children:[(0,W.jsx)(C,{...x(),onPress:n,children:h(`menu.showAllMarkers`,`Show All`)}),(0,W.jsx)(C,{...x(),onPress:r,children:h(`menu.hideAllMarkers`,`Hide All`)}),(0,W.jsx)(C,{...x(l),onPress:()=>u(!l),children:h(`menu.showNamesOnPins`,`Show Names`)}),(0,W.jsx)(C,{...x(),onPress:()=>b(!0),children:h(`menu.clearMarkerCompleted`,`Clear Completed`)}),(0,W.jsx)(C,{...x(o),onPress:s,children:h(`menu.showBorders`,`Show Borders`)}),(0,W.jsx)(C,{...x(p),onPress:()=>m(!p),children:h(`menu.hideUserMarkers`,`Hide User Markers`)})]}),(0,W.jsx)(y,{variant:`light`,selectionMode:`multiple`,showDivider:!1,defaultExpandedKeys:e.map(e=>e.name),itemClasses:{base:`!bg-transparent !shadow-none !backdrop-filter-none !backdrop-blur-none`,trigger:`pt-3 pb-0 min-h-0 px-0`,title:`text-[16px] leading-[16px] font-bold`,content:`py-0`},className:`bg-transparent shadow-none px-0`,children:e.filter(e=>e.subtypes.length>0).map(e=>{let n=e.subtypes.map(n=>{let r=n.name,o=d[r]??0;if(o===0)return null;let s=f[r]??0,c=i?.has(r)||!1,l=n.canComplete===!0,u=n.icon||e.icon||``,p=(n.iconScale||1)*20;return(0,W.jsx)(C,{...x(c),onPress:()=>{a(n.name)},children:(0,W.jsxs)(`div`,{className:`
                      flex w-full items-center justify-between
                      ${c?`text-background`:`text-default-700`}
                    `,children:[(0,W.jsxs)(`span`,{className:`flex items-center gap-1 min-w-0`,children:[u&&t&&(0,W.jsx)(`div`,{className:`relative w-5 h-5 overflow-visible flex items-center justify-center`,children:(0,W.jsx)(`img`,{src:le(u,t),alt:``,className:`absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 object-contain pointer-events-none`,style:{width:p,height:p}})}),(0,W.jsx)(`span`,{className:`truncate text-left`,children:h(`types:subtypes.${n.name}.name`,n.name)})]}),(0,W.jsx)(`span`,{className:`text-[12px] shrink-0 ml-2`,children:l?`${s}/${o}`:o})]})})}).filter(e=>e!==null);return n.length===0?null:(0,W.jsx)(D,{title:(()=>{let t=e.subtypes.map(e=>e.name).filter(e=>(d[e]??0)>0),n=t.length>0&&t.every(e=>i?.has(e)),r=t.length>0&&t.some(e=>i?.has(e)),o=n?g:F,s=n?h(`menu.hideCategory`,`Hide all in this category`):h(`menu.showCategory`,`Show all in this category`);return(0,W.jsxs)(`div`,{className:`my-2 px-1 flex items-center justify-between gap-2`,children:[(0,W.jsx)(`div`,{className:`text-[14px] leading-[14px] font-medium`,children:h(`types:categories.${e.name}.name`,e.name)}),t.length>0&&(0,W.jsx)(_,{content:s,placement:`top`,delay:300,children:(0,W.jsx)(`button`,{type:`button`,onClick:e=>{e.preventDefault(),e.stopPropagation();let r=!n;for(let e of t){let t=i?.has(e)??!1;r&&!t&&a(e),!r&&t&&a(e)}},className:`shrink-0 p-1 rounded-sm hover:bg-default-100 ${r?`text-default-700`:`text-default-400`}`,"aria-label":s,children:(0,W.jsx)(P,{icon:o,className:`text-[13px]`})})})]})})(),classNames:{indicator:`text-default-700`},children:(0,W.jsx)(`div`,{className:`grid grid-cols-2 gap-2`,children:n})},e.name)})})]}),(0,W.jsx)(Yi,{isOpen:v,onClose:()=>b(!1),onConfirm:c})]})},Zi=`ENTRIES`,Qi=`KEYS`,$i=`VALUES`,$=``,ea=class{constructor(e,t){let n=e._tree,r=Array.from(n.keys());this.set=e,this._type=t,this._path=r.length>0?[{node:n,keys:r}]:[]}next(){let e=this.dive();return this.backtrack(),e}dive(){if(this._path.length===0)return{done:!0,value:void 0};let{node:e,keys:t}=ta(this._path);if(ta(t)===$)return{done:!1,value:this.result()};let n=e.get(ta(t));return this._path.push({node:n,keys:Array.from(n.keys())}),this.dive()}backtrack(){if(this._path.length===0)return;let e=ta(this._path).keys;e.pop(),!(e.length>0)&&(this._path.pop(),this.backtrack())}key(){return this.set._prefix+this._path.map(({keys:e})=>ta(e)).filter(e=>e!==$).join(``)}value(){return ta(this._path).node.get($)}result(){switch(this._type){case $i:return this.value();case Qi:return this.key();default:return[this.key(),this.value()]}}[Symbol.iterator](){return this}},ta=e=>e[e.length-1],na=(e,t,n)=>{let r=new Map;if(t===void 0)return r;let i=t.length+1,a=i+n,o=new Uint8Array(a*i).fill(n+1);for(let e=0;e<i;++e)o[e]=e;for(let e=1;e<a;++e)o[e*i]=e;return ra(e,t,n,r,o,1,i,``),r},ra=(e,t,n,r,i,a,o,s)=>{let c=a*o;key:for(let l of e.keys())if(l===$){let t=i[c-1];t<=n&&r.set(s,[e.get(l),t])}else{let c=a;for(let e=0;e<l.length;++e,++c){let r=l[e],a=o*c,s=a-o,u=i[a],d=Math.max(0,c-n-1),f=Math.min(o-1,c+n);for(let e=d;e<f;++e){let n=r!==t[e],o=i[s+e]+ +n,c=i[s+e+1]+1,l=i[a+e]+1,d=i[a+e+1]=Math.min(o,c,l);d<u&&(u=d)}if(u>n)continue key}ra(e.get(l),t,n,r,i,c,o,s+l)}},ia=class e{constructor(e=new Map,t=``){this._size=void 0,this._tree=e,this._prefix=t}atPrefix(t){if(!t.startsWith(this._prefix))throw Error(`Mismatched prefix`);let[n,r]=aa(this._tree,t.slice(this._prefix.length));if(n===void 0){let[n,i]=da(r);for(let r of n.keys())if(r!==$&&r.startsWith(i)){let a=new Map;return a.set(r.slice(i.length),n.get(r)),new e(a,t)}}return new e(n,t)}clear(){this._size=void 0,this._tree.clear()}delete(e){return this._size=void 0,ca(this._tree,e)}entries(){return new ea(this,Zi)}forEach(e){for(let[t,n]of this)e(t,n,this)}fuzzyGet(e,t){return na(this._tree,e,t)}get(e){let t=oa(this._tree,e);return t===void 0?void 0:t.get($)}has(e){let t=oa(this._tree,e);return t!==void 0&&t.has($)}keys(){return new ea(this,Qi)}set(e,t){if(typeof e!=`string`)throw Error(`key must be a string`);return this._size=void 0,sa(this._tree,e).set($,t),this}get size(){if(this._size)return this._size;this._size=0;let e=this.entries();for(;!e.next().done;)this._size+=1;return this._size}update(e,t){if(typeof e!=`string`)throw Error(`key must be a string`);this._size=void 0;let n=sa(this._tree,e);return n.set($,t(n.get($))),this}fetch(e,t){if(typeof e!=`string`)throw Error(`key must be a string`);this._size=void 0;let n=sa(this._tree,e),r=n.get($);return r===void 0&&n.set($,r=t()),r}values(){return new ea(this,$i)}[Symbol.iterator](){return this.entries()}static from(t){let n=new e;for(let[e,r]of t)n.set(e,r);return n}static fromObject(t){return e.from(Object.entries(t))}},aa=(e,t,n=[])=>{if(t.length===0||e==null)return[e,n];for(let r of e.keys())if(r!==$&&t.startsWith(r))return n.push([e,r]),aa(e.get(r),t.slice(r.length),n);return n.push([e,t]),aa(void 0,``,n)},oa=(e,t)=>{if(t.length===0||e==null)return e;for(let n of e.keys())if(n!==$&&t.startsWith(n))return oa(e.get(n),t.slice(n.length))},sa=(e,t)=>{let n=t.length;outer:for(let r=0;e&&r<n;){for(let i of e.keys())if(i!==$&&t[r]===i[0]){let a=Math.min(n-r,i.length),o=1;for(;o<a&&t[r+o]===i[o];)++o;let s=e.get(i);if(o===i.length)e=s;else{let n=new Map;n.set(i.slice(o),s),e.set(t.slice(r,r+o),n),e.delete(i),e=n}r+=o;continue outer}let i=new Map;return e.set(t.slice(r),i),i}return e},ca=(e,t)=>{let[n,r]=aa(e,t);if(n!==void 0){if(n.delete($),n.size===0)la(r);else if(n.size===1){let[e,t]=n.entries().next().value;ua(r,e,t)}}},la=e=>{if(e.length===0)return;let[t,n]=da(e);if(t.delete(n),t.size===0)la(e.slice(0,-1));else if(t.size===1){let[n,r]=t.entries().next().value;n!==$&&ua(e.slice(0,-1),n,r)}},ua=(e,t,n)=>{if(e.length===0)return;let[r,i]=da(e);r.set(i+t,n),r.delete(i)},da=e=>e[e.length-1],fa=`or`,pa=`and`,ma=`and_not`,ha=class e{constructor(e){if(e?.fields==null)throw Error(`MiniSearch: option "fields" must be provided`);let t=e.autoVacuum==null||e.autoVacuum===!0?Ea:e.autoVacuum;this._options={...xa,...e,autoVacuum:t,searchOptions:{...Sa,...e.searchOptions||{}},autoSuggestOptions:{...Ca,...e.autoSuggestOptions||{}}},this._index=new ia,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldIds={},this._fieldLength=new Map,this._avgFieldLength=[],this._nextId=0,this._storedFields=new Map,this._dirtCount=0,this._currentVacuum=null,this._enqueuedVacuum=null,this._enqueuedVacuumConditions=Ta,this.addFields(this._options.fields)}add(e){let{extractField:t,stringifyField:n,tokenize:r,processTerm:i,fields:a,idField:o}=this._options,s=t(e,o);if(s==null)throw Error(`MiniSearch: document does not have ID field "${o}"`);if(this._idToShortId.has(s))throw Error(`MiniSearch: duplicate ID ${s}`);let c=this.addDocumentId(s);this.saveStoredFields(c,e);for(let o of a){let a=t(e,o);if(a==null)continue;let s=r(n(a,o),o),l=this._fieldIds[o],u=new Set(s).size;this.addFieldLength(c,l,this._documentCount-1,u);for(let e of s){let t=i(e,o);if(Array.isArray(t))for(let e of t)this.addTerm(l,c,e);else t&&this.addTerm(l,c,t)}}}addAll(e){for(let t of e)this.add(t)}addAllAsync(e,t={}){let{chunkSize:n=10}=t,r={chunk:[],promise:Promise.resolve()},{chunk:i,promise:a}=e.reduce(({chunk:e,promise:t},r,i)=>(e.push(r),(i+1)%n===0?{chunk:[],promise:t.then(()=>new Promise(e=>setTimeout(e,0))).then(()=>this.addAll(e))}:{chunk:e,promise:t}),r);return a.then(()=>this.addAll(i))}remove(e){let{tokenize:t,processTerm:n,extractField:r,stringifyField:i,fields:a,idField:o}=this._options,s=r(e,o);if(s==null)throw Error(`MiniSearch: document does not have ID field "${o}"`);let c=this._idToShortId.get(s);if(c==null)throw Error(`MiniSearch: cannot remove document with ID ${s}: it is not in the index`);for(let o of a){let a=r(e,o);if(a==null)continue;let s=t(i(a,o),o),l=this._fieldIds[o],u=new Set(s).size;this.removeFieldLength(c,l,this._documentCount,u);for(let e of s){let t=n(e,o);if(Array.isArray(t))for(let e of t)this.removeTerm(l,c,e);else t&&this.removeTerm(l,c,t)}}this._storedFields.delete(c),this._documentIds.delete(c),this._idToShortId.delete(s),this._fieldLength.delete(c),--this._documentCount}removeAll(e){if(e)for(let t of e)this.remove(t);else if(arguments.length>0)throw Error(`Expected documents to be present. Omit the argument to remove all documents.`);else this._index=new ia,this._documentCount=0,this._documentIds=new Map,this._idToShortId=new Map,this._fieldLength=new Map,this._avgFieldLength=[],this._storedFields=new Map,this._nextId=0}discard(e){let t=this._idToShortId.get(e);if(t==null)throw Error(`MiniSearch: cannot discard document with ID ${e}: it is not in the index`);this._idToShortId.delete(e),this._documentIds.delete(t),this._storedFields.delete(t),(this._fieldLength.get(t)||[]).forEach((e,n)=>{this.removeFieldLength(t,n,this._documentCount,e)}),this._fieldLength.delete(t),--this._documentCount,this._dirtCount+=1,this.maybeAutoVacuum()}maybeAutoVacuum(){if(this._options.autoVacuum===!1)return;let{minDirtFactor:e,minDirtCount:t,batchSize:n,batchWait:r}=this._options.autoVacuum;this.conditionalVacuum({batchSize:n,batchWait:r},{minDirtCount:t,minDirtFactor:e})}discardAll(e){let t=this._options.autoVacuum;try{this._options.autoVacuum=!1;for(let t of e)this.discard(t)}finally{this._options.autoVacuum=t}this.maybeAutoVacuum()}replace(e){let{idField:t,extractField:n}=this._options,r=n(e,t);this.discard(r),this.add(e)}vacuum(e={}){return this.conditionalVacuum(e)}conditionalVacuum(e,t){return this._currentVacuum?(this._enqueuedVacuumConditions=this._enqueuedVacuumConditions&&t,this._enqueuedVacuum??=this._currentVacuum.then(()=>{let t=this._enqueuedVacuumConditions;return this._enqueuedVacuumConditions=Ta,this.performVacuuming(e,t)}),this._enqueuedVacuum):this.vacuumConditionsMet(t)===!1?Promise.resolve():(this._currentVacuum=this.performVacuuming(e),this._currentVacuum)}async performVacuuming(e,t){let n=this._dirtCount;if(this.vacuumConditionsMet(t)){let t=e.batchSize||wa.batchSize,r=e.batchWait||wa.batchWait,i=1;for(let[e,n]of this._index){for(let[e,t]of n)for(let[r]of t)this._documentIds.has(r)||(t.size<=1?n.delete(e):t.delete(r));this._index.get(e).size===0&&this._index.delete(e),i%t===0&&await new Promise(e=>setTimeout(e,r)),i+=1}this._dirtCount-=n}await null,this._currentVacuum=this._enqueuedVacuum,this._enqueuedVacuum=null}vacuumConditionsMet(e){if(e==null)return!0;let{minDirtCount:t,minDirtFactor:n}=e;return t||=Ea.minDirtCount,n||=Ea.minDirtFactor,this.dirtCount>=t&&this.dirtFactor>=n}get isVacuuming(){return this._currentVacuum!=null}get dirtCount(){return this._dirtCount}get dirtFactor(){return this._dirtCount/(1+this._documentCount+this._dirtCount)}has(e){return this._idToShortId.has(e)}getStoredFields(e){let t=this._idToShortId.get(e);if(t!=null)return this._storedFields.get(t)}search(t,n={}){let{searchOptions:r}=this._options,i={...r,...n},a=this.executeQuery(t,n),o=[];for(let[e,{score:t,terms:n,match:r}]of a){let a=n.length||1,s={id:this._documentIds.get(e),score:t*a,terms:Object.keys(r),queryTerms:n,match:r};Object.assign(s,this._storedFields.get(e)),(i.filter==null||i.filter(s))&&o.push(s)}return t===e.wildcard&&i.boostDocument==null||o.sort(ka),o}autoSuggest(e,t={}){t={...this._options.autoSuggestOptions,...t};let n=new Map;for(let{score:r,terms:i}of this.search(e,t)){let e=i.join(` `),t=n.get(e);t==null?n.set(e,{score:r,terms:i,count:1}):(t.score+=r,t.count+=1)}let r=[];for(let[e,{score:t,terms:i,count:a}]of n)r.push({suggestion:e,terms:i,score:t/a});return r.sort(ka),r}get documentCount(){return this._documentCount}get termCount(){return this._index.size}static loadJSON(e,t){if(t==null)throw Error(`MiniSearch: loadJSON should be given the same options used when serializing the index`);return this.loadJS(JSON.parse(e),t)}static async loadJSONAsync(e,t){if(t==null)throw Error(`MiniSearch: loadJSON should be given the same options used when serializing the index`);return this.loadJSAsync(JSON.parse(e),t)}static getDefault(e){if(xa.hasOwnProperty(e))return ga(xa,e);throw Error(`MiniSearch: unknown option "${e}"`)}static loadJS(e,t){let{index:n,documentIds:r,fieldLength:i,storedFields:a,serializationVersion:o}=e,s=this.instantiateMiniSearch(e,t);s._documentIds=ja(r),s._fieldLength=ja(i),s._storedFields=ja(a);for(let[e,t]of s._documentIds)s._idToShortId.set(t,e);for(let[e,t]of n){let n=new Map;for(let e of Object.keys(t)){let r=t[e];o===1&&(r=r.ds),n.set(parseInt(e,10),ja(r))}s._index.set(e,n)}return s}static async loadJSAsync(e,t){let{index:n,documentIds:r,fieldLength:i,storedFields:a,serializationVersion:o}=e,s=this.instantiateMiniSearch(e,t);s._documentIds=await Ma(r),s._fieldLength=await Ma(i),s._storedFields=await Ma(a);for(let[e,t]of s._documentIds)s._idToShortId.set(t,e);let c=0;for(let[e,t]of n){let n=new Map;for(let e of Object.keys(t)){let r=t[e];o===1&&(r=r.ds),n.set(parseInt(e,10),await Ma(r))}++c%1e3==0&&await Na(0),s._index.set(e,n)}return s}static instantiateMiniSearch(t,n){let{documentCount:r,nextId:i,fieldIds:a,averageFieldLength:o,dirtCount:s,serializationVersion:c}=t;if(c!==1&&c!==2)throw Error(`MiniSearch: cannot deserialize an index created with an incompatible version`);let l=new e(n);return l._documentCount=r,l._nextId=i,l._idToShortId=new Map,l._fieldIds=a,l._avgFieldLength=o,l._dirtCount=s||0,l._index=new ia,l}executeQuery(t,n={}){if(t===e.wildcard)return this.executeWildcardQuery(n);if(typeof t!=`string`){let e={...n,...t,queries:void 0},r=t.queries.map(t=>this.executeQuery(t,e));return this.combineResults(r,e.combineWith)}let{tokenize:r,processTerm:i,searchOptions:a}=this._options,o={tokenize:r,processTerm:i,...a,...n},{tokenize:s,processTerm:c}=o,l=s(t).flatMap(e=>c(e)).filter(e=>!!e).map(ba(o)).map(e=>this.executeQuerySpec(e,o));return this.combineResults(l,o.combineWith)}executeQuerySpec(e,t){let n={...this._options.searchOptions,...t},r=(n.fields||this._options.fields).reduce((e,t)=>({...e,[t]:ga(n.boost,t)||1}),{}),{boostDocument:i,weights:a,maxFuzzy:o,bm25:s}=n,{fuzzy:c,prefix:l}={...Sa.weights,...a},u=this._index.get(e.term),d=this.termResults(e.term,e.term,1,e.termBoost,u,r,i,s),f,p;if(e.prefix&&(f=this._index.atPrefix(e.term)),e.fuzzy){let t=e.fuzzy===!0?.2:e.fuzzy,n=t<1?Math.min(o,Math.round(e.term.length*t)):t;n&&(p=this._index.fuzzyGet(e.term,n))}if(f)for(let[t,n]of f){let a=t.length-e.term.length;if(!a)continue;p?.delete(t);let o=l*t.length/(t.length+.3*a);this.termResults(e.term,t,o,e.termBoost,n,r,i,s,d)}if(p)for(let t of p.keys()){let[n,a]=p.get(t);if(!a)continue;let o=c*t.length/(t.length+a);this.termResults(e.term,t,o,e.termBoost,n,r,i,s,d)}return d}executeWildcardQuery(e){let t=new Map,n={...this._options.searchOptions,...e};for(let[e,r]of this._documentIds){let i=n.boostDocument?n.boostDocument(r,``,this._storedFields.get(e)):1;t.set(e,{score:i,terms:[],match:{}})}return t}combineResults(e,t=fa){if(e.length===0)return new Map;let n=_a[t.toLowerCase()];if(!n)throw Error(`Invalid combination operator: ${t}`);return e.reduce(n)||new Map}toJSON(){let e=[];for(let[t,n]of this._index){let r={};for(let[e,t]of n)r[e]=Object.fromEntries(t);e.push([t,r])}return{documentCount:this._documentCount,nextId:this._nextId,documentIds:Object.fromEntries(this._documentIds),fieldIds:this._fieldIds,fieldLength:Object.fromEntries(this._fieldLength),averageFieldLength:this._avgFieldLength,storedFields:Object.fromEntries(this._storedFields),dirtCount:this._dirtCount,index:e,serializationVersion:2}}termResults(e,t,n,r,i,a,o,s,c=new Map){if(i==null)return c;for(let l of Object.keys(a)){let u=a[l],d=this._fieldIds[l],f=i.get(d);if(f==null)continue;let p=f.size,m=this._avgFieldLength[d];for(let i of f.keys()){if(!this._documentIds.has(i)){this.removeTerm(d,i,t),--p;continue}let a=o?o(this._documentIds.get(i),t,this._storedFields.get(i)):1;if(!a)continue;let h=f.get(i),g=this._fieldLength.get(i)[d],_=ya(h,p,this._documentCount,g,m,s),v=n*r*u*a*_,y=c.get(i);if(y){y.score+=v,Da(y.terms,e);let n=ga(y.match,t);n?n.push(l):y.match[t]=[l]}else c.set(i,{score:v,terms:[e],match:{[t]:[l]}})}}return c}addTerm(e,t,n){let r=this._index.fetch(n,Aa),i=r.get(e);if(i==null)i=new Map,i.set(t,1),r.set(e,i);else{let e=i.get(t);i.set(t,(e||0)+1)}}removeTerm(e,t,n){if(!this._index.has(n)){this.warnDocumentChanged(t,e,n);return}let r=this._index.fetch(n,Aa),i=r.get(e);i==null||i.get(t)==null?this.warnDocumentChanged(t,e,n):i.get(t)<=1?i.size<=1?r.delete(e):i.delete(t):i.set(t,i.get(t)-1),this._index.get(n).size===0&&this._index.delete(n)}warnDocumentChanged(e,t,n){for(let r of Object.keys(this._fieldIds))if(this._fieldIds[r]===t){this._options.logger(`warn`,`MiniSearch: document with ID ${this._documentIds.get(e)} has changed before removal: term "${n}" was not present in field "${r}". Removing a document after it has changed can corrupt the index!`,`version_conflict`);return}}addDocumentId(e){let t=this._nextId;return this._idToShortId.set(e,t),this._documentIds.set(t,e),this._documentCount+=1,this._nextId+=1,t}addFields(e){for(let t=0;t<e.length;t++)this._fieldIds[e[t]]=t}addFieldLength(e,t,n,r){let i=this._fieldLength.get(e);i??this._fieldLength.set(e,i=[]),i[t]=r;let a=(this._avgFieldLength[t]||0)*n+r;this._avgFieldLength[t]=a/(n+1)}removeFieldLength(e,t,n,r){if(n===1){this._avgFieldLength[t]=0;return}let i=this._avgFieldLength[t]*n-r;this._avgFieldLength[t]=i/(n-1)}saveStoredFields(e,t){let{storeFields:n,extractField:r}=this._options;if(n==null||n.length===0)return;let i=this._storedFields.get(e);i??this._storedFields.set(e,i={});for(let e of n){let n=r(t,e);n!==void 0&&(i[e]=n)}}};ha.wildcard=Symbol(`*`);var ga=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0,_a={[fa]:(e,t)=>{for(let n of t.keys()){let r=e.get(n);if(r==null)e.set(n,t.get(n));else{let{score:e,terms:i,match:a}=t.get(n);r.score+=e,r.match=Object.assign(r.match,a),Oa(r.terms,i)}}return e},[pa]:(e,t)=>{let n=new Map;for(let r of t.keys()){let i=e.get(r);if(i==null)continue;let{score:a,terms:o,match:s}=t.get(r);Oa(i.terms,o),n.set(r,{score:i.score+a,terms:i.terms,match:Object.assign(i.match,s)})}return n},[ma]:(e,t)=>{for(let n of t.keys())e.delete(n);return e}},va={k:1.2,b:.7,d:.5},ya=(e,t,n,r,i,a)=>{let{k:o,b:s,d:c}=a;return Math.log(1+(n-t+.5)/(t+.5))*(c+e*(o+1)/(e+o*(1-s+s*r/i)))},ba=e=>(t,n,r)=>({term:t,fuzzy:typeof e.fuzzy==`function`?e.fuzzy(t,n,r):e.fuzzy||!1,prefix:typeof e.prefix==`function`?e.prefix(t,n,r):e.prefix===!0,termBoost:typeof e.boostTerm==`function`?e.boostTerm(t,n,r):1}),xa={idField:`id`,extractField:(e,t)=>e[t],stringifyField:(e,t)=>e.toString(),tokenize:e=>e.split(Pa),processTerm:e=>e.toLowerCase(),fields:void 0,searchOptions:void 0,storeFields:[],logger:(e,t)=>{typeof(console==null?void 0:console[e])==`function`&&console[e](t)},autoVacuum:!0},Sa={combineWith:fa,prefix:!1,fuzzy:!1,maxFuzzy:6,boost:{},weights:{fuzzy:.45,prefix:.375},bm25:va},Ca={combineWith:pa,prefix:(e,t,n)=>t===n.length-1},wa={batchSize:1e3,batchWait:10},Ta={minDirtFactor:.1,minDirtCount:20},Ea={...wa,...Ta},Da=(e,t)=>{e.includes(t)||e.push(t)},Oa=(e,t)=>{for(let n of t)e.includes(n)||e.push(n)},ka=({score:e},{score:t})=>t-e,Aa=()=>new Map,ja=e=>{let t=new Map;for(let n of Object.keys(e))t.set(parseInt(n,10),e[n]);return t},Ma=async e=>{let t=new Map,n=0;for(let r of Object.keys(e))t.set(parseInt(r,10),e[r]),++n%1e3==0&&await Na(0);return t},Na=e=>new Promise(t=>setTimeout(t,e)),Pa=/[\n\r\p{Z}\p{P}]+/u;function Fa(e){let t=e.trim(),n=t.match(/^\(?\s*(-?\d+(?:\.\d+)?)\s*[, ]\s*(-?\d+(?:\.\d+)?)\s*\)?$/);if(n)return{x:Number(n[1]),y:Number(n[2])};let r=t.match(/x\s*[:=]\s*(-?\d+(?:\.\d+)?)\s*y\s*[:=]\s*(-?\d+(?:\.\d+)?)$/i);return r?{x:Number(r[1]),y:Number(r[2])}:null}function Ia(e){return e.replace(/[.*+?^${}()|[\]\\]/g,`\\$&`)}function La(e,t){if(!e)return null;let n=t.map(e=>e.trim()).filter(Boolean);if(!n.length)return e;let r=RegExp(`(${n.map(Ia).join(`|`)})`,`ig`);return e.split(r).map((e,t)=>n.some(t=>e.toLowerCase()===t.toLowerCase())?(0,W.jsx)(`mark`,{className:`bg-yellow-300/70 text-inherit px-0.5 rounded-[2px]`,children:e},t):(0,W.jsx)(`span`,{children:e},t))}var Ra=({onSelectMarker:e,onSelectPosition:t})=>{let{markers:n}=tt(),{t:r}=R(`common`),[i,a]=(0,V.useState)(``),o=(0,V.useMemo)(()=>{let e=new ha({fields:[`localizedName`,`localizedDescription`],storeFields:[`x`,`y`,`localizedName`,`localizedDescription`],searchOptions:{prefix:!0,fuzzy:.2},tokenize:e=>[...e]}),t=n.filter(e=>e.subtype.startsWith(`creature`));return e.addAll(t),e},[n]),s=(0,V.useMemo)(()=>{let e=Fa(i);return!e||!Number.isFinite(e.x)||!Number.isFinite(e.y)?null:{kind:`position`,x:e.x,y:e.y}},[i]),c=(0,V.useMemo)(()=>{let e=i.trim();if(!e)return[];let t=o.search(e);return s?[s,...t]:t},[i,o,s]),l=(0,V.useMemo)(()=>i.trim().split(/\s+/).filter(Boolean),[i]);return(0,W.jsxs)(`div`,{className:`w-full flex flex-col gap-2.5 px-6 mt-2.5`,children:[(0,W.jsx)(O,{size:`sm`,radius:`sm`,variant:`flat`,placeholder:r(`markerActions.search`,`Search markersâ€¦`),value:i,onValueChange:a,color:`default`,classNames:{inputWrapper:`h-9`,input:`text-[14px]`},startContent:i?(0,W.jsx)(`button`,{type:`button`,onClick:()=>a(``),className:`
                inline-flex
                items-center
                justify-center
                h-4 w-4
                leading-none
                text-default-700
                hover:text-foreground
              `,"aria-label":`Clear search`,children:(0,W.jsx)(P,{icon:S,className:`text-default-700 text-sm hover:text-foreground`})}):(0,W.jsx)(P,{icon:x,className:`text-default-700 text-sm opacity-70`})}),i.trim()&&(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(`div`,{className:`text-[12px] text-default-700 text-center`,children:r(`markerActions.searchCount`,`{{count}} search results`,{count:c.length})}),c.slice(0,50).map(n=>{let i;i=n.kind===`position`?`position`:`marker`;let a=n;return(0,W.jsx)(`div`,{className:``,children:(0,W.jsx)(`button`,{type:`button`,className:`
                    w-full text-left
                    rounded-lg
                    bg-transparent
                    hover:bg-search-item
                    px-3 py-2
                    text-xs
                    flex flex-col gap-1
                  `,onClick:()=>{i===`position`?t?.(n.x,n.y):e?.(a.id)},children:i===`position`?(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(`div`,{className:`font-semibold text-[16px]`,children:r(`markerActions.inputPosition`,`Jump to input position`)}),(0,W.jsxs)(`div`,{className:`text-[14px] text-default-700`,children:[r(`markerActions.position`,`Position`),`: (`,Math.round(n.x),`, `,Math.round(n.y),`)`]})]}):(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(`div`,{className:`font-semibold text-[16px]`,children:a.localizedName?La(a.localizedName,l):r(`markerSearch.unnamed`,`Unnamed marker`)}),a.localizedDescription&&(0,W.jsxs)(`div`,{className:`text-[14px] text-default-700 line-clamp-2`,children:[r(`markerActions.description`,`Description`),`: `,La(a.localizedDescription,l)]}),(0,W.jsxs)(`div`,{className:`text-[14px] text-default-700`,children:[r(`markerActions.position`,`Position`),`: (`,Math.round(a.x),`, `,Math.round(a.y),`)`]})]})})},a.id)})]})]})},za=({onSelectMarker:e,onSelectPosition:t})=>{let{t:n}=R(),{realTheme:r}=oe(),{selectedMap:i}=G(),{setPickMode:a}=At();return(0,W.jsx)(Ki,{side:`left`,width:370,extraControls:(0,W.jsx)(_,{content:n(`common:markerActions.createUserMarker`,`Create a user marker`),placement:`right`,delay:300,children:(0,W.jsx)(`button`,{type:`button`,onClick:()=>a(!0),className:`
              w-8 h-12 bg-sidebar-collapse text-default-700
              flex items-center justify-center rounded-r-md
            `,children:(0,W.jsx)(`img`,{src:B(r==`light`?`images/LocationAddLight.webp`:`images/LocationAddDark.webp`),alt:n(`common:markerActions.createUserMarker`),className:`w-5 h-5 object-contain`})})}),children:(0,W.jsx)(`div`,{className:`flex flex-col h-full relative`,children:(0,W.jsxs)(`div`,{className:`flex-1 px-0 pb-4`,children:[(0,W.jsx)(qi,{}),(0,W.jsx)(Ji,{}),(0,W.jsx)(Ra,{onSelectMarker:e,onSelectPosition:t}),(0,W.jsx)(y,{variant:`shadow`,selectionMode:`multiple`,defaultExpandedKeys:[`maps`,`types`],itemClasses:{base:`!bg-transparent !shadow-none !backdrop-filter-none !backdrop-blur-none`,trigger:`py-4 min-h-0 px-2`,title:`text-[16px] leading-[16px] font-bold`,content:`py-0`},className:`bg-transparent shadow-none`,children:i?(0,W.jsx)(D,{title:fe(n(`common:menu.markerTypes`,`Marker Types`)),classNames:{indicator:`text-default-700`},children:(0,W.jsx)(Xi,{})},`types`):null})]})})})};function Ba(){let{selectedMap:e}=G(),{setThemeHint:t}=oe();return(0,V.useEffect)(()=>{t(e?.type===`light`||e?.type===`dark`||e?.type===`abyss`?e.type:null)},[e?.type,t]),null}var Va=()=>{let{loading:e,selectedMap:t}=G(),n=(0,V.useRef)(null),{markersById:r}=tt(),[i,a]=(0,V.useState)(null),[o,s]=(0,V.useState)(null),c=(0,V.useCallback)(e=>{if(!e){a(null);return}r[e]&&(a(e),s(null))},[r]),l=(0,V.useCallback)((e,t)=>{s({x:e,y:t}),a(null)},[]);return e&&!t?(0,W.jsx)(`div`,{className:`h-screen w-screen flex items-center justify-center`,children:(0,W.jsx)(w,{label:`Loading maps...`})}):(B(`images/PangXieRight.webp`),B(`images/QiyouRight.webp`),(0,W.jsxs)(W.Fragment,{children:[!1,(0,W.jsxs)(`div`,{className:`flex flex-1 overflow-hidden`,children:[(0,W.jsx)(za,{onSelectMarker:c,onSelectPosition:l}),(0,W.jsx)(Gi,{mapRef:n,onSelectMarker:c,selectedMarkerId:i,selectedPosition:o})]})]}))},Ha=()=>(0,W.jsxs)(Je,{children:[(0,W.jsx)(Ba,{}),(0,W.jsx)(et,{children:(0,W.jsx)(kt,{children:(0,W.jsx)(at,{children:(0,W.jsx)(Va,{})})})})]});export{Ha as component};
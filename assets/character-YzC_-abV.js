import{s as e}from"./rolldown-runtime-Cb2Vi1zU.js";import{a as t,n}from"./vendor-react-Pim_c09P.js";import"./vendor-i18n-BM8K3Wqw.js";import{A as r,At as i,Bt as a,D as o,Dt as s,Et as c,Ft as l,It as u,Lt as d,Mt as f,Nt as p,Ot as m,Pt as h,Rt as g,U as _,Vt as v,Y as y,_t as b,at as x,bt as S,gt as C,it as w,jt as T,kt as E,ot as D,tt as O,vt as k,xt as A,zt as j}from"./vendor-ui-K_TnsoAz.js";import{_ as M,c as ee,l as te,m as N,o as P,s as ne,t as re,u as ie}from"./index-B7vsoVD6.js";import{t as F}from"./useYamlLoader-CF9JHQeN.js";import{n as ae,r as oe,s as se,t as I}from"./lodash-DmxRirzj.js";import{n as L,t as ce}from"./ItemDataContext-C066D3l1.js";import{n as le,t as ue}from"./ClassDataContext-CBRQxXVw.js";import{t as de}from"./Footer-B2Eh3UAr.js";var R=e(t(),1),z=e(n(),1),fe=(0,R.createContext)(null);const pe=({children:e})=>{let[t,n]=(0,R.useState)([]),[r,i]=(0,R.useState)(!0),a=F();return(0,R.useEffect)(()=>{let e=!1;async function t(){try{let t=await a(`data/servers.yaml`);if(e)return;n(t.servers??[])}catch(e){console.error(e)}finally{e||i(!1)}}return t(),()=>{e=!0}},[a]),(0,z.jsx)(fe.Provider,{value:{servers:t,loading:r},children:e})};function me(){let e=(0,R.useContext)(fe);if(!e)throw Error(`useServerData must be used inside <ServerDataProvider>`);return e}var he=(0,R.createContext)(null);async function ge(e){let t=te()+`/characters/info?server=${e.serverId}&character=${encodeURIComponent(e.characterId)}&region=${e.region}`,n=await fetch(t,{method:`GET`});if(!n.ok)throw Error(`Search failed: ${n.status}`);let r=await n.json();if(r?.errorCode&&r.errorCode!==`Success`)throw Error(r.errorMessage||`API Error`);return r?.data}const _e=({children:e})=>{let t=P({from:re.fullPath}),n=ne({from:re.fullPath}),[r,i]=(0,R.useState)(n.serverId??null),[a,o]=(0,R.useState)(n.characterId??null),[s,c]=(0,R.useState)(n.region??null),[l,u]=(0,R.useState)(null),[d,f]=(0,R.useState)(null),[p,m]=(0,R.useState)(null),[h,g]=(0,R.useState)(null),[_,v]=(0,R.useState)(null),[y,b]=(0,R.useState)([]),[x,S]=(0,R.useState)(!1),[C,w]=(0,R.useState)(!1),[T,E]=(0,R.useState)(null),D=R.useRef(null),O=F();(0,R.useEffect)(()=>{let e=!1;async function t(){try{let t=await O(`data/stats.yaml`);if(e)return;v(t)}catch{e||E(`Failed to load stats data`)}}return t(),()=>{e=!0}},[O]),(0,R.useEffect)(()=>{let e=!1;async function t(){try{let t=await O(`data/skills.yaml`);if(e)return;b(t.skills??[])}catch{e||E(`Failed to load skills data`)}}return t(),()=>{e=!0}},[O]);let k=(0,R.useMemo)(()=>{let e=new Map;for(let t of y)e.set(t.id,t);return e},[y]);(0,R.useEffect)(()=>{i(n.serverId??null),o(n.characterId??null),c(n.region??null)},[n.serverId,n.characterId,n.region]);let A=(0,R.useCallback)(e=>{i(e.serverId),o(e.characterId),c(e.region),u(null),f(null),m(null),g(null),E(null);try{let t=localStorage.getItem(ae),n=t?JSON.parse(t):[];n=n.filter(t=>{let n=t.serverId??t.item?.serverId??(t.id?t.serverId:void 0),r=t.id??t.characterId??t.item?.id;return!(n===e.serverId&&r===e.characterId)}),e.item?n.unshift(e.item):n.unshift(e),n.length>20&&(n=n.slice(0,20)),localStorage.setItem(ae,JSON.stringify(n))}catch(e){console.error(`Failed to update character history`,e)}t({replace:!1,search:t=>({...t,serverId:e.serverId,characterId:e.characterId,region:e.region})})},[t]),j=(0,R.useCallback)(()=>{i(null),o(null),c(null),u(null),f(null),m(null),g(null),E(null),S(!1),t({replace:!1,search:e=>({...e,serverId:void 0,characterId:void 0,region:void 0})})},[t]);(0,R.useEffect)(()=>{let e=!1,t=()=>{D.current&&=(D.current.close(),null),w(!1)};async function n(){if(!r||!a||!s){u(null),f(null),m(null),g(null),S(!1),E(null),t();return}S(!0),E(null);try{let n=await ge({serverId:r,characterId:a,region:s});if(e)return;c(n);let i=n.status;i!==`cached`&&i!==`failed`?d(r,a,s):t(),S(!1)}catch(n){if(e)return;E(n instanceof Error?n.message:String(n)),S(!1),t()}}function i(e,t){return e?.profile?{profile:e.profile,stats:e.stats||[],titles:e.titles||[],rankings:e.rankings||[],boards:e.boards||[],updatedAt:t?new Date(t*1e3).toISOString():new Date().toISOString()}:null}function o(e){return{skills:(e?.skills||[]).map(e=>({id:e.id,skillLevel:e.skillLevel,acquired:e.acquired,equip:e.equip})),equipments:(e?.equipments||[]).map(e=>({id:e.id,enchantLevel:e.enchantLevel,exceedLevel:e.exceedLevel,slotPos:e.slotPos,slotPosName:e.slotPosName})),skins:(e?.skins||[]).map(e=>({id:e.id,name:e.name,slotPos:e.slotPos,slotPosName:e.slotPosName?.includes(`Main`)?`MainHand`:e.slotPosName,icon:e.icon})),pet:e?.pet?{id:e.pet.id,name:e.pet.name,level:e.pet.level,icon:e.pet.icon}:null,wing:e?.wing?{id:e.wing.id,name:e.wing.name,grade:e.wing.grade,icon:e.wing.icon}:null}}function c(e){let t=e.items||{},n=e.meta||{};if(t.info){let e=i(t.info,n.updatedAt);e&&u(e)}t.equipments&&f(o(t.equipments));let r=Object.entries(t).filter(([e])=>e.startsWith(`equipments:`)).reduce((e,[t,n])=>(e[t]=n,e),{});Object.keys(r).length>0&&m(r);let a=Object.entries(t).filter(([e])=>e.startsWith(`boards:`)).reduce((e,[t,n])=>(e[t]=n,e),{});Object.keys(a).length>0&&g(a)}async function l(t,n,r){w(!0);try{let i=await ge({serverId:t,characterId:n,region:r});if(e)return;c(i);let a=i.status;a!==`cached`&&a!==`failed`?d(t,n,r):w(!1)}catch(e){console.error(`Re-fetch failed`,e),w(!1)}}function d(n,r,a){t(),w(!0);let s=ie()+`/characters/ws?server=${n}&character=${encodeURIComponent(r)}&region=${a}`,c=new WebSocket(s);D.current=c,c.onmessage=e=>{try{let t=JSON.parse(e.data);if(!t||!t.key)return;let n=t.key,r=t.value;if(n===`info`){let e=i(r,t.updated_at);e&&u(e)}else n===`equipments`?f(o(r)):n.startsWith(`equipments:`)?m(e=>({...e||{},[n]:r})):n.startsWith(`boards:`)&&g(e=>({...e||{},[n]:r}))}catch(e){console.error(`WS parse error`,e)}},c.onclose=()=>{e||(D.current=null,setTimeout(()=>{e||l(n,r,a)},1e3))},c.onerror=e=>{console.error(`WS Error:`,e)}}return n(),()=>{e=!0,t()}},[r,a,s]);let M=(0,R.useMemo)(()=>({serverId:r,characterId:a,region:s,info:l,equipments:d,equipmentDetails:p,boardDetails:h,stats:_,skills:y,skillsById:k,loading:x,isUpdating:C,error:T,selectCharacter:A,clearSelection:j}),[r,a,s,l,d,p,h,_,k,x,C,T,A,j]);return(0,z.jsx)(he.Provider,{value:M,children:e})};function B(){let e=(0,R.useContext)(he);if(!e)throw Error(`useCharacter must be used inside <CharacterProvider>`);return e}var ve=(0,R.createContext)(null);const ye=({children:e})=>{let[t,n]=(0,R.useState)([]),[r,i]=(0,R.useState)(!1),[a,o]=(0,R.useState)(null),s=F(),c=(0,R.useCallback)(async e=>{if(e){i(!0),o(null);try{n((await s(`data/boards/${e}.yaml`)).boards??[])}catch(t){console.error(`Failed to load boards for class ${e}:`,t),o(`Failed to load boards for class ${e}`),n([])}finally{i(!1)}}},[s]);return(0,z.jsx)(ve.Provider,{value:{boards:t,loading:r,error:a,loadBoardsForClass:c},children:e})};function be(){let e=(0,R.useContext)(ve);if(!e)throw Error(`useBoardData must be used inside <BoardDataProvider>`);return e}function xe(e,t){let[n,r]=(0,R.useState)(e);return(0,R.useEffect)(()=>{let n=setTimeout(()=>{r(e)},t);return()=>{clearTimeout(n)}},[e,t]),n}function Se(){let{servers:e,loading:t}=me(),{selectCharacter:n,characterId:r,region:i}=B(),{t:a}=M(),[o,s]=(0,R.useState)(i||`tw`),[c,l]=(0,R.useState)(`1`),[f,m]=(0,R.useState)(`all`),[h,_]=(0,R.useState)(``),v=xe(h,300),[b,S]=(0,R.useState)(!1),[C,T]=(0,R.useState)([]),[k,A]=(0,R.useState)([]),[j,ee]=(0,R.useState)([]),N=(0,R.useRef)(0);(0,R.useEffect)(()=>{let e=localStorage.getItem(ae);if(e)try{A(JSON.parse(e).filter(e=>e.name).map(e=>({...e,region:e.region||`tw`})).filter((e,t,n)=>t===n.findIndex(t=>t.id===e.id&&t.serverId===e.serverId)))}catch(e){console.error(`Failed to parse character history`,e)}let t=localStorage.getItem(oe);if(t)try{ee(JSON.parse(t).map(e=>({...e,region:e.region||`tw`})))}catch(e){console.error(`Failed to parse starred characters`,e)}},[r]),(0,R.useEffect)(()=>{i&&s(i)},[i]);let P=(0,R.useMemo)(()=>{let t=Number(c);return e.filter(e=>e.raceId===t)},[e,c]);(0,R.useEffect)(()=>{f!==`all`&&(P.some(e=>String(e.serverId)===f)||m(`all`))},[P,f]),(0,R.useEffect)(()=>{let t=v.trim(),n=Number(c),r=f===`all`?void 0:Number(f),i=t.match(/^(.+)\[(.+)]$/);if(i){let[,a,o]=i,s=e.find(e=>e.serverShortName===o||e.serverName===o);s&&(t=a,n=s.raceId,r=s.serverId)}if(T([]),!t||!n)return;let a=++N.current;(async()=>{try{S(!0);let e=await ne({keyword:t,raceId:n,serverId:r,region:o});if(N.current!==a)return;T(e)}catch(e){console.error(e),N.current===a&&T([])}finally{N.current===a&&S(!1)}})()},[v,c,f,o,e]);async function ne(e){let t=te()+`/characters/search?race=${e.raceId}&keyword=${encodeURIComponent(e.keyword)}&region=${e.region}`,n=e.serverId?`${t}&server=${e.serverId}`:t,r=await fetch(n,{method:`GET`});if(!r.ok)throw Error(`Search failed: ${r.status}`);return((await r.json()).data?.results??[]).map(t=>({...t,region:e.region}))}let re=(0,R.useCallback)((e,t,n)=>{let r=n%1e3;return`${e} (${t===1?a(`common:server.lightAbbr`,`Light `):a(`common:server.darkAbbr`,`Dark `)}${r})`},[a]),ie=(0,R.useMemo)(()=>{let e=[{key:`all`,label:a(`common:server.allServers`,`All servers`)}];for(let t of P)e.push({key:String(t.serverId),label:re(t.serverName,t.raceId,t.serverId)});return e},[P,a,re]),F=`
    !bg-character-card hover:!bg-character-card focus:!bg-character-card !transition-none 
    border-crafting-border border-1 sm:border-r-0
    shadow-none rounded-sm sm:rounded-none
    group-data-[hover=true]:!bg-character-card
    group-data-[focus=true]:!bg-character-card
    group-data-[focus-visible=true]:!bg-character-card
    group-data-[invalid=true]:!bg-character-card
  `,se={inputWrapper:F,innerWrapper:`h-10 py-0`,popoverContent:`rounded-none p-0`},I={trigger:F,innerWrapper:`h-10 py-0`,popoverContent:`rounded-none p-0`},L={itemClasses:{base:`rounded-none`}},ce=(0,R.useCallback)((e,t)=>{e.stopPropagation(),ee(e=>{let n=e.some(e=>e.id===t.id),r;return r=n?e.filter(e=>e.id!==t.id):[t,...e],localStorage.setItem(oe,JSON.stringify(r)),r})},[]),le=(e,t)=>(0,z.jsx)(p,{isPressable:!0,onPress:()=>n({serverId:e.serverId,characterId:e.id,region:e.region,item:e}),className:`bg-character-card border-1 border-crafting-border hover:border-primary transition-colors`,shadow:`sm`,children:(0,z.jsxs)(u,{className:`p-3 overflow-hidden relative`,children:[(0,z.jsx)(d,{isIconOnly:!0,variant:`light`,size:`sm`,className:`absolute top-1 right-1 z-10 min-w-0 w-8 h-8`,onClick:t=>ce(t,e),children:(0,z.jsx)(O,{icon:y,className:j.some(t=>t.id===e.id)?`text-warning`:`text-default-300`})}),(0,z.jsxs)(`div`,{className:`flex items-center gap-3`,children:[(0,z.jsx)(`img`,{src:`https://profileimg.plaync.com${e.profileImageUrl}`,alt:e.name,className:`w-[48px] h-[48px] object-cover rounded-md shrink-0`,draggable:!1}),(0,z.jsxs)(`div`,{className:`min-w-0 flex-1`,children:[(0,z.jsx)(`div`,{className:`flex justify-between items-baseline gap-1`,children:(0,z.jsx)(`span`,{className:`truncate text-base font-bold text-foregound`,children:e.name})}),(0,z.jsxs)(`div`,{className:`truncate text-sm text-default-800 mt-0.5`,children:[e.serverName,` | Lv.`,e.level]})]})]})]})},`${t}-${e.id}`);return r?(0,z.jsxs)(`div`,{className:`flex flex-col sm:flex-row gap-2 sm:gap-0 items-stretch sm:items-end w-full justify-end`,children:[(0,z.jsxs)(`div`,{className:`flex flex-row gap-2 sm:gap-0 flex-none sm:flex-none`,children:[(0,z.jsxs)(x,{placeholder:a(`common:server.region`,`Region`),isRequired:!0,selectedKeys:new Set([o]),onSelectionChange:e=>{let t=e.currentKey;t&&s(String(t))},className:`flex-1 sm:w-[100px] sm:flex-none`,radius:`none`,popoverProps:{radius:`none`},listboxProps:L,classNames:I,children:[(0,z.jsx)(D,{children:a(`common:server.tw`,`台服`)},`tw`),(0,z.jsx)(D,{children:a(`common:server.kr`,`韩服`)},`kr`)]}),(0,z.jsxs)(x,{placeholder:a(`common:server.race`,`Race`),isRequired:!0,selectedKeys:new Set([c]),onSelectionChange:e=>{let t=e.currentKey;(t===`1`||t===`2`)&&l(t)},className:`flex-1 sm:w-[100px] sm:flex-none`,radius:`none`,popoverProps:{radius:`none`},listboxProps:L,classNames:I,children:[(0,z.jsx)(D,{children:a(`common:server.light`,`Light`)},`1`),(0,z.jsx)(D,{children:a(`common:server.dark`,`Dark`)},`2`)]}),(0,z.jsx)(x,{placeholder:a(`common:server.server`,`Server`),isRequired:!1,isDisabled:t||P.length===0,items:ie,selectedKeys:new Set([f]),onSelectionChange:e=>{let t=e.currentKey;m(t?String(t):`all`)},className:`flex-[2] sm:w-[160px] sm:flex-none`,renderValue:e=>e[0]?.textValue??``,radius:`none`,popoverProps:{radius:`none`},listboxProps:L,classNames:I,children:e=>(0,z.jsx)(D,{textValue:e.label,children:e.label},e.key)})]}),(0,z.jsx)(w,{placeholder:a(`common:server.search`,`Type to search...`),inputValue:h,onInputChange:_,onSelectionChange:e=>{let t=C.find(t=>t.id===e);t&&n({serverId:t.serverId,characterId:t.id,region:t.region,item:t})},isDisabled:t,isLoading:b,items:C,className:`flex-[2] w-full sm:w-[180px] sm:flex-none`,radius:`none`,popoverProps:{radius:`none`},listboxProps:L,inputProps:{classNames:{...se,inputWrapper:se.inputWrapper+`!border-r-1`}},children:e=>(0,z.jsx)(D,{textValue:e.name,children:(0,z.jsxs)(`div`,{className:`flex items-center gap-2 w-full`,children:[(0,z.jsx)(`img`,{src:`https://profileimg.plaync.com${e.profileImageUrl}`,alt:e.name,className:`w-[40px] h-[40px] object-cover rounded-md shrink-0`,draggable:!1}),(0,z.jsxs)(`div`,{className:`min-w-0 flex-1`,children:[(0,z.jsxs)(`div`,{className:`flex justify-between text-sm font-medium`,children:[(0,z.jsx)(`span`,{className:`truncate text-default-800`,children:e.name}),(0,z.jsxs)(`span`,{className:`shrink-0 text-default-600`,children:[`Lv.`,e.level]})]}),(0,z.jsx)(`div`,{className:`truncate text-xs text-default-700`,children:e.serverName})]})]})},e.id)})]}):(0,z.jsxs)(`div`,{className:`flex flex-col w-full space-y-8 pt-10 min-h-[600px]`,children:[(0,z.jsxs)(`div`,{className:`flex flex-col`,children:[(0,z.jsx)(`h1`,{className:`text-[22px] font-bold text-foreground`,children:`搜寻AION2角色`}),(0,z.jsx)(`p`,{className:`text-[14px] text-default-800 mt-2`,children:`查詢角色詳細資訊`})]}),(0,z.jsxs)(`div`,{className:`flex flex-col items-center w-full space-y-4 max-w-2xl mx-auto`,children:[(0,z.jsx)(E,{placeholder:a(`common:server.search`,`Type to search...`),value:h,onValueChange:_,classNames:{inputWrapper:F+`!border-r-1`,input:`text-lg`},size:`lg`,radius:`sm`,isClearable:!0}),(0,z.jsxs)(`div`,{className:`flex flex-row w-full gap-2 sm:gap-4`,children:[(0,z.jsxs)(x,{placeholder:a(`common:server.region`,`Publisher`),isRequired:!0,selectedKeys:new Set([o]),onSelectionChange:e=>{let t=e.currentKey;t&&s(String(t))},className:`flex-1`,radius:`sm`,classNames:{trigger:F+`!border-r-1`,popoverContent:`rounded-none p-0`},popoverProps:{radius:`none`},listboxProps:L,size:`lg`,children:[(0,z.jsx)(D,{children:a(`common:server.tw`,`台服`)},`tw`),(0,z.jsx)(D,{children:a(`common:server.kr`,`韩服`)},`kr`)]}),(0,z.jsxs)(x,{placeholder:a(`common:server.race`,`Race`),isRequired:!0,selectedKeys:new Set([c]),onSelectionChange:e=>{let t=e.currentKey;(t===`1`||t===`2`)&&l(t)},className:`flex-1`,radius:`sm`,classNames:{trigger:F+`!border-r-1`,popoverContent:`rounded-none p-0`},popoverProps:{radius:`none`},listboxProps:L,size:`lg`,children:[(0,z.jsx)(D,{children:a(`common:server.light`,`Light`)},`1`),(0,z.jsx)(D,{children:a(`common:server.dark`,`Dark`)},`2`)]}),(0,z.jsx)(x,{placeholder:a(`common:server.server`,`Server`),isRequired:!1,isDisabled:t||P.length===0,items:ie,selectedKeys:new Set([f]),onSelectionChange:e=>{let t=e.currentKey;m(t?String(t):`all`)},className:`flex-[2]`,renderValue:e=>e[0]?.textValue??``,radius:`sm`,classNames:{trigger:F+`!border-r-1`,popoverContent:`rounded-none p-0`},popoverProps:{radius:`none`},listboxProps:L,size:`lg`,children:e=>(0,z.jsx)(D,{textValue:e.label,children:e.label},e.key)})]})]}),(0,z.jsxs)(`div`,{className:`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 w-full`,children:[C.map(e=>le(e,`search`)),b&&(0,z.jsx)(`div`,{className:`col-span-full flex justify-center py-10`,children:(0,z.jsx)(g,{color:`primary`,label:a(`common:server.searching`,`Searching characters...`)})}),!b&&h.trim()!==``&&C.length===0&&(0,z.jsx)(`div`,{className:`col-span-full flex justify-center py-10`,children:(0,z.jsx)(`span`,{className:`text-default-800`,children:a(`common:server.noResults`,{keyword:h})})})]}),j.length>0&&(0,z.jsxs)(`div`,{className:`flex flex-col space-y-4`,children:[(0,z.jsx)(`h2`,{className:`text-[18px] font-bold text-foreground`,children:a(`common:server.starred`,`Favorites`)}),(0,z.jsx)(`div`,{className:`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 w-full`,children:j.map(e=>le(e,`starred`))})]}),k.length>0&&(0,z.jsxs)(`div`,{className:`flex flex-col space-y-4`,children:[(0,z.jsx)(`h2`,{className:`text-[18px] font-bold text-foreground`,children:a(`common:server.history`,`Search History`)}),(0,z.jsx)(`div`,{className:`grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 w-full`,children:k.map(e=>le(e,`history`))})]})]})}function Ce(){let{info:e}=B(),{classes:t}=le();return(0,R.useMemo)(()=>{if(!e?.boards||e.boards.length===0)return null;let n=e.boards[0].id,r=Math.floor(n/10);return t.find(e=>e.order===r)?.name||null},[e?.boards,t])}var we=e(I(),1),Te=e(I(),1),Ee=R.memo(()=>{let{info:e,isUpdating:t}=B();if(!e)return null;let n=(0,Te.keyBy)(e.stats,`type`);return(0,z.jsx)(p,{className:`shadow-none bg-character-input border-1 border-crafting-border rounded-lg`,children:(0,z.jsxs)(u,{className:`flex flex-col items-center gap-2`,children:[(0,z.jsx)(`div`,{className:`w-[72px] h-[72px] rounded-full overflow-hidden bg-default-100 flex justify-center items-center`,children:(0,z.jsx)(`img`,{src:e.profile.profileImage,alt:`avatar`,className:`w-full h-full object-cover`,draggable:!1})}),(0,z.jsxs)(`div`,{className:`w-full text-center text-default-800`,children:[(0,z.jsxs)(`div`,{className:`text-[18px]`,children:[e.profile.characterName,e.profile.titleName?(0,z.jsxs)(`span`,{className:`text-grade-${(0,we.lowerCase)(e.profile.titleGrade)}`,children:[` [`,e.profile.titleName,`]`]}):null]}),(0,z.jsxs)(`div`,{className:`mt-2 text-[14px] flex flex-wrap justify-center items-center gap-x-2 gap-y-1 text-default-800`,children:[(0,z.jsx)(`span`,{children:e.profile.raceName}),(0,z.jsx)(`span`,{children:`|`}),(0,z.jsx)(`span`,{children:e.profile.serverName}),(0,z.jsx)(`span`,{children:`|`}),(0,z.jsx)(`span`,{children:e.profile.className}),(0,z.jsx)(`span`,{children:`|`}),e.profile.regionName?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(`span`,{children:e.profile.regionName}),(0,z.jsx)(`span`,{children:`|`})]}):null,(0,z.jsxs)(`span`,{className:`font-semibold`,children:[`战力值`,n.ItemLevel?.value??`-`]}),(0,z.jsx)(`span`,{children:`|`}),t?(0,z.jsxs)(`span`,{className:`flex items-center gap-1`,children:[(0,z.jsx)(`span`,{children:`更新中`}),(0,z.jsx)(g,{size:`sm`,className:`scale-75 origin-left`})]}):(0,z.jsxs)(`span`,{children:[`更新于 `,ee(e.updatedAt).fromNow()]})]})]})]})})});function De(){let[e,t]=(0,R.useState)(!1);return(0,R.useEffect)(()=>{let e=window.matchMedia(`(pointer: coarse)`);t(e.matches);let n=e=>t(e.matches);return e.addEventListener(`change`,n),()=>e.removeEventListener(`change`,n)},[]),e}const V=({content:e,children:t,popoverProps:n,...r})=>De()?(0,z.jsxs)(c,{placement:r.placement,isDisabled:r.isDisabled,portalContainer:r.portalContainer,...n,children:[(0,z.jsx)(s,{children:t}),(0,z.jsx)(m,{className:r.classNames?.content||r.className,children:e})]}):(0,z.jsx)(f,{content:e,...r,children:t});var Oe=e(I(),1),ke=R.memo(()=>{let{info:e,stats:t}=B(),{t:n}=M(),[i,a]=(0,R.useState)(!0);if(!e||!t)return null;let s=(0,Oe.keyBy)(e.stats,`type`),c=e=>{let r=t[e];return(0,z.jsx)(`div`,{className:`grid grid-cols-6 gap-1 sm:gap-3`,children:r?.map((t,r)=>{let i=((s[t.type]?.value??0)*(e===`mainStats`?.1:.2)).toFixed(1),a=n(`stats:${t.type}.name`),o=n(`stats:${t.type}.description`,``);return(0,z.jsx)(V,{content:(0,z.jsxs)(`div`,{className:`px-1 py-1`,children:[(0,z.jsxs)(`div`,{className:`flex justify-between items-center mb-1 gap-4`,children:[(0,z.jsxs)(`span`,{className:`font-bold text-default-800`,children:[a,o&&`[${o}]`]}),(0,z.jsx)(`span`,{className:`font-bold text-foreground`,children:s[t.type]?.value??`-`})]}),t.secondStats?.map((e,t)=>(0,z.jsxs)(`div`,{className:`flex justify-between gap-4`,children:[(0,z.jsx)(`span`,{className:`text-default-800`,children:n(`stats:${e.type}.name`)}),(0,z.jsxs)(`span`,{className:`font-bold`,children:[e.type===`CooldownDecrease`||e.type===`MPCostDecrease`?`-`:`+`,i,`%`]})]},t))]}),placement:`top`,radius:`sm`,delay:0,closeDelay:0,children:(0,z.jsxs)(`div`,{className:`text-center bg-character-card rounded-md border-1 border-crafting-border p-1 sm:p-2 cursor-help outline-none focus-visible:ring-2 focus-visible:ring-primary`,tabIndex:0,children:[(0,z.jsx)(`div`,{className:`w-full max-w-[60px] aspect-square mx-auto rounded-lg overflow-hidden`,children:(0,z.jsx)(`img`,{src:N(t.icon),alt:t.type,className:`w-full h-full object-cover`,draggable:!1})}),(0,z.jsx)(`div`,{className:`text-[12px] sm:text-[18px] text-default-800 truncate`,children:n(`stats:${t.type}.name`)}),(0,z.jsx)(`div`,{className:`text-[12px] sm:text-[18px] text-default-800 font-semibold`,children:s[t.type]?.value??`-`})]})},r)})})};return(0,z.jsxs)(p,{className:`shadow-none bg-character-input border-1 border-crafting-border rounded-lg`,children:[(0,z.jsxs)(u,{className:`space-y-4`,children:[(0,z.jsx)(`div`,{className:`mb-0`,children:c(`mainStats`)}),!i&&(0,z.jsx)(`div`,{className:`mt-3`,children:c(`lordStats`)})]}),(0,z.jsx)(v,{}),(0,z.jsx)(l,{className:`p-0`,children:(0,z.jsxs)(d,{variant:`light`,disableRipple:!0,disableAnimation:!0,onPress:()=>a(!i),className:`
            w-full text-default-700 gap-2 shadow-none bg-transparent
            hover:bg-transparent active:bg-transparent focus:bg-transparent focus-visible:bg-transparent
            data-[hover=true]:bg-transparent data-[pressed=true]:bg-transparent data-[focus-visible=true]:bg-transparent
          `,size:`md`,radius:`none`,children:[i?n(`common:menu.expand`,`Expand`):n(`common:menu.collapse`,`Collapse`),(0,z.jsx)(O,{icon:i?o:r})]})})]})}),Ae=R.memo(()=>{let{equipments:e,skillsById:t}=B(),{t:n}=M(),r=r=>{let i=(e?.skills??[]).filter(e=>t.get(e.id)?.category===r)??[];return(0,z.jsxs)(`div`,{className:`flex gap-0 border-1 border-crafting-border bg-character-card rounded-lg`,children:[(0,z.jsx)(`div`,{className:`w-[38px] shrink-0 flex items-center justify-center border-r-1 border-crafting-border`,children:(0,z.jsx)(`div`,{className:`w-[18px] text-center text-[18px] font-semibold text-default-700 break-words`,children:n(`common:skills.category.${r.toLowerCase()}`,r)})}),(0,z.jsx)(`div`,{className:`flex flex-wrap gap-3 p-3`,children:i.map(e=>{let r=t.get(e.id),i=r?.icon?N(`UI/Resource/Texture/Skill/${r.icon}`):void 0;return(0,z.jsx)(V,{content:(0,z.jsxs)(`div`,{className:`px-1 py-1`,children:[(0,z.jsx)(`div`,{className:`text-small font-bold`,children:n(`skills:${e.id}.name`,String(e.id))}),(0,z.jsx)(`div`,{className:`text-tiny`,children:e.skillLevel===0?`未解锁`:`Lv.${e.skillLevel}`})]}),placement:`top`,radius:`sm`,delay:0,closeDelay:0,children:(0,z.jsxs)(`div`,{className:`relative h-[48px] w-[48px] overflow-hidden rounded-md cursor-help outline-none focus-visible:ring-2 focus-visible:ring-primary`,tabIndex:0,children:[i?(0,z.jsx)(`img`,{src:i,alt:String(e.id),className:`h-full w-full object-cover ${e.skillLevel===0?`grayscale brightness-50`:``}`,draggable:!1}):(0,z.jsx)(`div`,{className:`h-full w-full bg-default-200`}),e.skillLevel===0?(0,z.jsx)(`div`,{className:`absolute inset-0 bg-black/20 flex items-center justify-center text-white/80`,children:(0,z.jsx)(O,{icon:_})}):(0,z.jsxs)(`div`,{className:`absolute bottom-0 right-0 bg-black/60 text-white text-[14px] px-1 rounded-tl-md`,children:[`LV`,e.skillLevel]})]})},String(e.id))})})]})};return(0,z.jsxs)(`div`,{className:`space-y-4`,children:[r(`Active`),r(`Passive`),r(`Dp`)]})}),je=R.memo(()=>{let{info:e}=B();return!e||!e.rankings||e.rankings.length===0?(0,z.jsx)(`div`,{className:`flex justify-center items-center py-4 w-full`,children:(0,z.jsx)(g,{size:`sm`})}):(0,z.jsx)(`div`,{className:`grid grid-cols-1 sm:grid-cols-2 gap-3 w-full`,children:e.rankings.map((e,t)=>(0,z.jsx)(p,{className:`shadow-none bg-character-card border-1 border-crafting-border rounded-lg`,children:(0,z.jsxs)(u,{className:`p-2 flex flex-row items-center gap-3`,children:[(0,z.jsxs)(`div`,{className:`flex flex-col flex-1 min-w-0 justify-between h-full`,children:[(0,z.jsxs)(`div`,{className:`flex items-center gap-1`,children:[(0,z.jsxs)(`span`,{className:`text-[18px] text-primary`,children:[`第 `,e.rank??`-`,` 名`]}),e.rankChange!==null&&e.rankChange!==0&&!isNaN(e.rankChange)&&(0,z.jsx)(`span`,{className:`text-[14px] ${e.rankChange>0?`text-danger`:`text-success`}`,children:e.rankChange>0?`↓ ${e.rankChange}`:`↑ ${Math.abs(e.rankChange)}`})]}),(0,z.jsx)(`div`,{className:`text-[14px] text-default-800`,children:e.rankingContentsName})]}),(0,z.jsxs)(`div`,{className:`flex flex-col items-center shrink-0 justify-between h-full`,children:[e.gradeIcon&&(0,z.jsx)(`img`,{src:e.gradeIcon,alt:e.gradeName||`grade`,className:`w-10 h-10 object-contain`}),e.point!==null&&(0,z.jsx)(`div`,{className:`text-[12px] text-default-800 font-medium`,children:e.point})]})]})},t))})});function Me(){let[e,t]=(0,R.useState)(!1);return(0,R.useEffect)(()=>{let e=window.matchMedia(`(max-width: 767px)`);t(e.matches);let n=e=>t(e.matches);return e.addEventListener(`change`,n),()=>e.removeEventListener(`change`,n)},[]),e}var H=e(I(),1),Ne=[`MainHand`,`SubHand`,`Helmet`,`Shoulder`,`Torso`,`Belt`,`Pants`,`Gloves`,`Boots`,`Cape`],Pe=[`Earring1`,`Earring2`,`Necklace`,`Amulet`,`Ring1`,`Ring2`,`Bracelet1`,`Bracelet2`,`Rune1`,`Rune2`],Fe=R.memo(()=>{let{equipments:e,equipmentDetails:t}=B(),{itemsById:n}=L(),{t:r}=M(),a=Me(),o=(0,H.keyBy)(e?.equipments??[],`slotPosName`),s=(0,H.keyBy)(e?.skins??[],`slotPosName`),c=e=>e===0?(0,z.jsx)(`div`,{className:`h-[16px] w-[16px] shrink-0`}):(0,z.jsx)(`div`,{className:`mt-2 flex items-center justify-start gap-0`,children:Array.from({length:5}).map((t,n)=>(0,z.jsx)(`div`,{className:`h-[16px] w-[16px] overflow-hidden rounded-sm flex justify-center items-center`,children:n<e&&(0,z.jsx)(`img`,{src:N(`UI/Resource/Texture/Icon/UT_NP_QuestMonolith_Acquired.webp`),alt:`exceed-level`,className:`h-full w-full object-contain`,style:{objectFit:`contain`,objectPosition:`0% 50%`,transform:`scale(3)`},draggable:!1})},n))}),l=e=>{let l=o[e],u=s[e],d=l?.slotPos||u?.slotPos,f=d?t?.[`equipments:${d}`]:null,p=(l?n.get(l.id):null)||(f?n.get(f.id):null),m=N(`UI/Resource/Texture/ETC/UT_ItemTooltipGrade_${p?.grade??`Common`}.webp`),h=N(p?.icon||``),_=r(`items/items:${p?.id||l?.id}.name`,String(p?.id||l?.id||``));return(0,z.jsx)(V,{content:f?(0,z.jsxs)(`div`,{className:`space-y-2 w-full text-[14px]`,children:[(0,z.jsx)(`div`,{className:`font-bold text-[18px] text-center pb-1`,children:`装备详情`}),(0,z.jsxs)(`div`,{className:`p-2 rounded flex justify-between items-center bg-contain bg-center bg-no-repeat`,style:{backgroundImage:`url(${m})`,backgroundSize:`100% 100%`},children:[(0,z.jsxs)(`div`,{className:`flex flex-col justify-between h-full`,children:[(0,z.jsxs)(`div`,{className:`mb-1 text-[18px] font-bold text-stroke text-grade-${(0,H.lowerCase)(p?.grade||`Common`)}`,children:[l?.enchantLevel?`+${l.enchantLevel} `:``,_]}),(0,z.jsxs)(`div`,{className:`text-[14px]`,children:[(0,z.jsx)(`span`,{className:`font-bold text-stroke text-grade-${(0,H.lowerCase)(p?.grade||`Common`)}`,children:r(`items/grades:${p?.grade}.name`)}),(0,z.jsx)(`span`,{className:`font-bold text-background`,children:r(`items/types:subtypes.${p?.subtype}.name`)})]}),(0,z.jsx)(`div`,{className:`text-[14px] font-bold text-background`,children:`道具等级`}),(0,z.jsxs)(`div`,{className:`text-[14px] font-bold text-background`,children:[f.level,` (+`,f.levelValue,`)`]})]}),(0,z.jsxs)(`div`,{className:`flex flex-col items-center`,children:[(0,z.jsx)(`div`,{className:`relative`,children:(0,z.jsx)(`img`,{src:h,alt:_,className:`w-16 h-16 object-contain`})}),c(l?.exceedLevel||0)]})]}),f.mainStats&&f.mainStats.length>0&&(0,z.jsx)(`div`,{className:`bg-character-card p-2 rounded space-y-1`,children:f.mainStats.map((e,t)=>(0,z.jsxs)(`div`,{className:`flex justify-between`,children:[(0,z.jsx)(`span`,{className:`${e.exceed?`text-grade-epic`:`text-default-800`} font-[700]`,children:r(`stats:${e.id}.name`,e.id)}),(0,z.jsxs)(`span`,{className:`text-foreground font-[700]`,children:[!e.exceed&&(e.minValue&&e.minValue!==``?`${e.minValue} - ${e.value}`:e.value),e.extra!==`0`&&e.extra!==`0%`&&(e.exceed?(0,z.jsx)(`span`,{className:`text-grade-epic ml-1`,children:e.extra}):(0,z.jsxs)(`span`,{className:`text-grade-rare ml-1`,children:[`(+`,e.extra,`)`]}))]})]},`${e.id}-${t}`))}),(f.subStats&&f.subStats.length>0||f.subSkills&&f.subSkills.length>0)&&(0,z.jsxs)(`div`,{className:`bg-character-card p-2 rounded space-y-1`,children:[(0,z.jsx)(i,{"aria-label":`Loading...`,color:`primary`,value:Number(f.soulBindRate),label:`灵魂刻印率`,valueLabel:`${f.soulBindRate}%`,showValueLabel:!0,classNames:{label:`text-[14px] text-default-800 font-[700]`,value:`text-[14px] text-foreground font-[700]`,base:`gap-0.5`},size:`sm`}),f.subStats&&f.subStats.map((e,t)=>(0,z.jsxs)(`div`,{className:`flex justify-between`,children:[(0,z.jsx)(`span`,{className:`text-default-800 font-[700]`,children:r(`stats:${e.id}.name`,e.id)}),(0,z.jsx)(`span`,{className:`text-foreground font-[700]`,children:e.value})]},`${e.id}-${t}`)),f.subSkills&&f.subSkills.map((e,t)=>(0,z.jsxs)(`div`,{className:`flex justify-between items-center`,children:[(0,z.jsx)(`span`,{className:`text-default-800 font-[700]`,children:r(`skills:${e.id}.name`,String(e.id))}),(0,z.jsxs)(`span`,{className:`text-foreground font-[700]`,children:[`Lv.+`,e.level]})]},`${e.id}-${t}`))]}),f.magicStoneStat?.length>0&&(0,z.jsx)(`div`,{className:`pt-1`,children:(0,z.jsx)(`div`,{className:`bg-character-card p-2 rounded grid grid-cols-2 gap-x-4 gap-y-1`,children:f.magicStoneStat.map((e,t)=>(0,z.jsxs)(`div`,{className:`flex justify-between text-grade-${(0,H.lowerCase)(e.grade)}`,children:[(0,z.jsx)(`span`,{className:`font-[700] whitespace-nowrap`,children:r(`stats:${e.id}.name`,e.id)}),(0,z.jsx)(`span`,{className:`font-[700]`,children:e.value})]},t))})}),f.godStoneStat?.length>0&&(0,z.jsx)(`div`,{className:`pt-1 space-y-1`,children:(0,z.jsx)(`div`,{className:`bg-character-card p-2 rounded space-y-1`,children:f.godStoneStat.map((e,t)=>(0,z.jsxs)(`div`,{className:`flex flex-col`,children:[(0,z.jsx)(`div`,{className:`flex justify-between items-center`,children:(0,z.jsx)(`span`,{className:`text-grade-${(0,H.lowerCase)(e.grade)} font-[700]`,children:e.name})}),(0,z.jsx)(`div`,{className:`text-default-800 text-[12px] mt-1`,children:e.desc})]},t))})})]}):(0,z.jsx)(`div`,{className:`flex justify-center items-center py-2`,children:(0,z.jsx)(g,{size:`sm`})}),classNames:{content:`bg-character-equipment shadow-none px-2 py-4 w-[330px] max-w-[calc(100vw-32px)]`},placement:a?`bottom`:`left`,radius:`lg`,isDisabled:!l,delay:0,closeDelay:0,children:(0,z.jsx)(`div`,{className:`relative h-14 bg-contain bg-center bg-no-repeat rounded-sm shadow-none cursor-help outline-none focus-visible:ring-2 focus-visible:ring-primary`,style:{backgroundImage:`url(${m})`,backgroundSize:`100% 100%`},tabIndex:0,children:(0,z.jsxs)(`div`,{className:`flex h-full w-full items-center rounded-[4px] px-2`,children:[(0,z.jsx)(`div`,{className:`relative shrink-0`,children:l||f?(0,z.jsx)(`img`,{src:h,alt:_,className:`h-12 w-12 object-contain`,draggable:!1}):(0,z.jsx)(`div`,{className:`h-12 w-12`})}),(0,z.jsxs)(`div`,{className:`ml-2 flex h-[48px] min-w-0 flex-1 flex-col justify-center`,children:[(0,z.jsx)(`div`,{className:`truncate text-left text-[13px] font-bold leading-[13px] text-white [text-shadow:0px_2px_4px_rgba(0,0,0,0.35)]`,children:l||f?`${_} +${l?.enchantLevel??f?.enchantLevel??0}`:``}),c(l?.exceedLevel||0)]}),u&&(0,z.jsx)(V,{content:u.name,placement:`top`,radius:`sm`,children:(0,z.jsx)(`div`,{className:`ml-2 shrink-0`,children:(0,z.jsx)(`img`,{src:u.icon,alt:u.name,className:`w-10 h-10 object-contain border-1 bg-transparent border-primary`,draggable:!1})})})]})})},e)};return(0,z.jsxs)(`div`,{className:`space-y-3`,children:[(0,z.jsxs)(`div`,{className:`grid grid-cols-2 gap-3`,children:[(0,z.jsx)(`div`,{className:`flex flex-col gap-3`,children:Ne.map(e=>l(e))}),(0,z.jsx)(`div`,{className:`flex flex-col gap-3`,children:Pe.map(e=>l(e))})]}),(0,z.jsxs)(`div`,{className:`grid grid-cols-2 gap-3`,children:[e?.pet?.id&&(0,z.jsxs)(`div`,{className:`relative h-[56px] bg-character-card border-1 border-crafting-border rounded-md flex items-center px-2`,children:[(0,z.jsx)(`img`,{src:e.pet.icon,alt:e.pet.name,className:`h-12 w-12 shrink-0 object-contain rounded-md`,draggable:!1}),(0,z.jsxs)(`div`,{className:`ml-2 flex flex-col justify-center min-w-0`,children:[(0,z.jsx)(`div`,{className:`truncate text-[14px] font-bold text-default-800`,children:e.pet.name}),(0,z.jsxs)(`div`,{className:`text-[12px] text-default-600`,children:[`Lv.`,e.pet.level]})]})]}),e?.wing?.id&&(0,z.jsxs)(`div`,{className:`relative h-[56px] bg-character-card border-1 border-crafting-border rounded-md flex items-center px-2`,children:[(0,z.jsx)(`img`,{src:e.wing.icon,alt:e.wing.name,className:`h-12 w-12 shrink-0 object-contain rounded-md`,draggable:!1}),(0,z.jsxs)(`div`,{className:`ml-2 flex flex-col justify-center min-w-0`,children:[(0,z.jsx)(`div`,{className:`truncate text-[14px] font-bold text-grade-${(0,H.lowerCase)(e.wing.grade)}`,children:e.wing.name}),(0,z.jsx)(`div`,{className:`text-[12px] text-default-600`,children:r(`items/grades:${e.wing.grade}.name`,e.wing.grade)})]})]})]})]})}),Ie=e(I(),1),Le=R.memo(()=>{let{equipments:e,equipmentDetails:t}=B(),{itemsById:n}=L(),{t:r}=M(),i=(0,Ie.keyBy)(e?.equipments??[],`slotPos`);return(0,z.jsx)(`div`,{className:`grid grid-cols-5 w-full gap-2 sm:gap-4 justify-items-center`,children:[41,42,43,44,45].map(e=>{let a=i[e],o=t?.[`equipments:${e}`],s=(a?n.get(a.id):null)||(o?n.get(o.id):null),c=N(s?.icon||``),l=r(`items/items:${s?.id||a?.id}.name`,String(s?.id||a?.id||``)),u=N(`UI/Resource/Texture/ETC/UT_ItemTooltipGrade_${s?.grade??`Common`}.webp`);return(0,z.jsx)(V,{content:o?(0,z.jsxs)(`div`,{className:`space-y-2 w-full text-[14px]`,children:[(0,z.jsx)(`div`,{className:`font-bold text-[18px] text-center pb-1`,children:`装备详情`}),(0,z.jsxs)(`div`,{className:`p-2 rounded flex justify-between items-center bg-contain bg-center bg-no-repeat`,style:{backgroundImage:`url(${u})`,backgroundSize:`100% 100%`},children:[(0,z.jsxs)(`div`,{className:`flex flex-col justify-between h-full`,children:[(0,z.jsxs)(`div`,{className:`mb-1 text-[18px] font-bold text-stroke text-grade-${(0,Ie.lowerCase)(s?.grade||`Common`)}`,children:[a?.enchantLevel?`+${a.enchantLevel} `:``,l]}),(0,z.jsx)(`div`,{className:`text-[14px]`,children:(0,z.jsx)(`span`,{className:`font-bold text-stroke text-grade-${(0,Ie.lowerCase)(s?.grade||`Common`)}`,children:r(`items/grades:${s?.grade}.name`)})}),(0,z.jsx)(`div`,{className:`text-[14px] font-bold text-background`,children:`道具等级`}),(0,z.jsxs)(`div`,{className:`text-[14px] font-bold text-background`,children:[o.level,` (+`,o.levelValue,`)`]})]}),(0,z.jsx)(`div`,{className:`flex flex-col items-center`,children:(0,z.jsx)(`div`,{className:`relative`,children:(0,z.jsx)(`img`,{src:c,alt:l,className:`w-16 h-16 object-contain`})})})]}),(0,z.jsxs)(`div`,{className:`bg-character-card p-2 rounded space-y-1`,children:[o.mainStats&&o.mainStats.length>0&&o.mainStats.map((e,t)=>(0,z.jsxs)(`div`,{className:`flex justify-between`,children:[(0,z.jsx)(`span`,{className:`${e.exceed?`text-grade-epic`:`text-default-800`} font-[700]`,children:r(`stats:${e.id}.name`,e.id)}),(0,z.jsxs)(`span`,{className:`text-foreground font-[700]`,children:[!e.exceed&&(e.minValue&&e.minValue!==``?`${e.minValue} - ${e.value}`:e.value),e.extra!==`0`&&e.extra!==`0%`&&(e.exceed?(0,z.jsx)(`span`,{className:`text-grade-epic ml-1`,children:e.extra}):(0,z.jsxs)(`span`,{className:`text-grade-rare ml-1`,children:[`(+`,e.extra,`)`]}))]})]},`${e.id}-${t}`)),o.subSkills&&o.subSkills.length>0&&o.subSkills.map((e,t)=>(0,z.jsxs)(`div`,{className:`flex justify-between items-center`,children:[(0,z.jsx)(`span`,{className:`text-default-800 font-[700]`,children:r(`skills:${e.id}.name`,String(e.id))}),(0,z.jsxs)(`span`,{className:`text-foreground font-[700]`,children:[`Lv.+`,e.level]})]},`${e.id}-${t}`))]})]}):(0,z.jsx)(`div`,{className:`flex justify-center items-center py-2`,children:(0,z.jsx)(g,{size:`sm`})}),isDisabled:!a,placement:`top`,classNames:{content:`bg-character-equipment rounded-lg shadow-none px-2 py-4 w-[330px] max-w-[calc(100vw-32px)]`},delay:0,closeDelay:0,children:(0,z.jsx)(`div`,{className:`relative flex justify-center items-start cursor-help outline-none focus-visible:ring-2 focus-visible:ring-primary rounded-lg w-full max-w-24 aspect-square`,tabIndex:0,children:a?(0,z.jsxs)(z.Fragment,{children:[(0,z.jsx)(`img`,{src:c,alt:l,className:`object-contain rounded-lg w-full h-full`,draggable:!1}),(0,z.jsxs)(`div`,{className:`absolute left-1/2 -translate-x-1/2 bottom-[4px] text-white bg-black/60 px-2 rounded-lg text-[14px] font-bold pointer-events-none`,children:[`+`,a?.enchantLevel??0]})]}):(0,z.jsx)(`div`,{className:`bg-default-800 rounded-lg w-full h-full relative`,children:(0,z.jsx)(`div`,{className:`absolute inset-0 bg-black/20 flex items-center justify-center text-white/80 rounded-lg`,children:(0,z.jsx)(O,{icon:_,size:`xl`})})})})},e)})})}),Re=e(I(),1),ze=R.memo(()=>{let{info:e}=B(),{t}=M();if(!e)return null;let n=[`Attack`,`Defense`,`Etc`],r=[`UT_Stat_GrowthSummary_Title_First.webp`,`UT_Stat_GrowthSummary_Title_Second.webp`,`UT_Stat_GrowthSummary_Title_Third.webp`];return(0,z.jsx)(`div`,{className:`grid grid-cols-1 sm:grid-cols-3 gap-4`,children:n.map((n,i)=>{let a=e.titles?.find(e=>e.equipCategory===n);return(0,z.jsxs)(p,{className:`shadow-none bg-character-card border-1 border-crafting-border rounded-lg overflow-hidden`,children:[(0,z.jsxs)(h,{className:`flex gap-3 p-3 bg-character-input border-b-1 border-crafting-border`,children:[(0,z.jsx)(`div`,{className:`h-10 w-10 shrink-0 overflow-hidden rounded-full bg-foreground p-1 flex items-center justify-center`,children:(0,z.jsx)(`img`,{src:N(`UI/Resource/Texture/ETC/${r[i]}`),alt:n,draggable:!1,className:`h-full w-full object-contain scale-125`})}),(0,z.jsxs)(`div`,{className:`flex flex-col gap-0.5 text-[14px]`,children:[(0,z.jsx)(`p`,{className:`text-default-800`,children:t(`common:titles.${n}`,n)}),(0,z.jsxs)(`p`,{className:`text-default-700`,children:[(0,z.jsx)(`span`,{className:`text-foreground font-bold`,children:a?.ownedCount??0}),` / `,a?.totalCount??0]})]})]}),(0,z.jsxs)(u,{className:`p-3`,children:[(0,z.jsx)(`div`,{className:`text-[15px] font-bold mb-1 text-grade-${(0,Re.lowerCase)(a?.grade||`Common`)}`,children:a?.name||`尚未装备`}),(0,z.jsx)(`div`,{className:`space-y-0.5`,children:a?.equipStats&&a?.equipStats.map((e,t)=>(0,z.jsx)(`div`,{className:`text-[13px] text-default-800`,children:e},t))})]})]},n)})})}),U=function(e,t){return Number(e.toFixed(t))},Be=function(e,t){return typeof e==`number`?e:t},W=function(e,t,n){n&&typeof n==`function`&&n(e,t)},Ve={easeOut:function(e){return-Math.cos(e*Math.PI)/2+.5},linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return e*(2-e)},easeInOutQuad:function(e){return e<.5?2*e*e:-1+(4-2*e)*e},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return--e*e*e+1},easeInOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1- --e*e*e*e},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1+--e*e*e*e*e},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e}},He=function(e){typeof e==`number`&&cancelAnimationFrame(e)},G=function(e){e.mounted&&(He(e.animation),e.animate=!1,e.animation=null,e.velocity=null)};function Ue(e,t,n,r){if(e.mounted){var i=new Date().getTime(),a=1;G(e),e.animation=function(){if(!e.mounted)return He(e.animation);var o=new Date().getTime()-i,s=o/n,c=Ve[t],l=c(s);o>=n?(r(a),e.animation=null):e.animation&&(r(l),requestAnimationFrame(e.animation))},requestAnimationFrame(e.animation)}}function We(e){var t=e.scale,n=e.positionX,r=e.positionY;return!(Number.isNaN(t)||Number.isNaN(n)||Number.isNaN(r))}function K(e,t,n,r){var i=We(t);if(!(!e.mounted||!i)){var a=e.setTransformState,o=e.transformState,s=o.scale,c=o.positionX,l=o.positionY,u=t.scale-s,d=t.positionX-c,f=t.positionY-l;n===0?a(t.scale,t.positionX,t.positionY):Ue(e,r,n,function(e){a(s+u*e,c+d*e,l+f*e)})}}function Ge(e,t,n){var r=e.offsetWidth,i=e.offsetHeight,a=t.offsetWidth,o=t.offsetHeight,s=a*n,c=o*n;return{wrapperWidth:r,wrapperHeight:i,newContentWidth:s,newDiffWidth:r-s,newContentHeight:c,newDiffHeight:i-c}}var Ke=function(e,t,n,r,i,a,o){var s=e>t?n*(o?1:.5):0,c=r>i?a*(o?1:.5):0;return{minPositionX:e-t-s,maxPositionX:s,minPositionY:r-i-c,maxPositionY:c}},qe=function(e,t){var n=e.wrapperComponent,r=e.contentComponent,i=e.setup.centerZoomedOut;if(!n||!r)throw Error(`Components are not mounted`);var a=Ge(n,r,t),o=a.wrapperWidth,s=a.wrapperHeight,c=a.newContentWidth,l=a.newDiffWidth,u=a.newContentHeight,d=a.newDiffHeight;return Ke(o,c,l,s,u,d,!!i)},Je=function(e,t,n,r){return U(r?e<t?t:e>n?n:e:e,2)},q=function(e,t){var n=qe(e,t);return e.bounds=n,n};function J(e,t,n,r,i,a,o){var s=n.minPositionX,c=n.minPositionY,l=n.maxPositionX,u=n.maxPositionY,d=0,f=0;return o&&(d=i,f=a),{x:Je(e,s-d,l+d,r),y:Je(t,c-f,u+f,r)}}function Ye(e,t,n,r,i,a){var o=e.transformState,s=o.scale,c=o.positionX,l=o.positionY,u=r-s;return typeof t!=`number`||typeof n!=`number`?(console.error(`Mouse X and Y position were not provided!`),{x:c,y:l}):J(c-t*u,l-n*u,i,a,0,0,null)}function Y(e,t,n,r,i){var a=t-(i?r:0);return!Number.isNaN(n)&&e>=n?n:!Number.isNaN(t)&&e<=a?a:e}var Xe=function(e,t){var n=e.setup.panning.excluded,r=e.isInitialized,i=e.wrapperComponent,a=t.target,o=`shadowRoot`in a&&`composedPath`in t?t.composedPath().some(function(e){return e instanceof Element?i?.contains(e):!1}):i?.contains(a);return!(!(r&&a&&o)||Lt(a,n))},Ze=function(e){var t=e.isInitialized,n=e.isPanning,r=e.setup.panning.disabled;return!!(t&&n&&!r)},Qe=function(e,t){var n=e.transformState,r=n.positionX,i=n.positionY;e.isPanning=!0;var a=t.clientX,o=t.clientY;e.startCoords={x:a-r,y:o-i}},$e=function(e,t){var n=t.touches,r=e.transformState,i=r.positionX,a=r.positionY;if(e.isPanning=!0,n.length===1){var o=n[0].clientX,s=n[0].clientY;e.startCoords={x:o-i,y:s-a}}};function et(e){var t=e.transformState,n=t.positionX,r=t.positionY,i=t.scale,a=e.setup,o=a.disabled,s=a.limitToBounds,c=a.centerZoomedOut,l=e.wrapperComponent;if(!(o||!l||!e.bounds)){var u=e.bounds,d=u.maxPositionX,f=u.minPositionX,p=u.maxPositionY,m=u.minPositionY,h=n>d||n<f,g=r>p||r<m,_=Ye(e,n>d?l.offsetWidth:e.setup.minPositionX||0,r>p?l.offsetHeight:e.setup.minPositionY||0,i,e.bounds,s||c),v=_.x,y=_.y;return{scale:i,positionX:h?v:n,positionY:g?y:r}}}function tt(e,t,n,r,i){var a=e.setup.limitToBounds,o=e.wrapperComponent,s=e.bounds,c=e.transformState,l=c.scale,u=c.positionX,d=c.positionY;if(!(o===null||s===null||t===u&&n===d)){var f=J(t,n,s,a,r,i,o),p=f.x,m=f.y;e.setTransformState(l,p,m)}}var nt=function(e,t,n){var r=e.startCoords,i=e.transformState,a=e.setup.panning,o=a.lockAxisX,s=a.lockAxisY,c=i.positionX,l=i.positionY;if(!r)return{x:c,y:l};var u=t-r.x,d=n-r.y;return{x:o?c:u,y:s?l:d}},X=function(e,t){var n=e.setup,r=e.transformState.scale,i=n.minScale,a=n.disablePadding;return t>0&&r>=i&&!a?t:0},rt=function(e){var t=e.mounted,n=e.setup,r=n.disabled,i=n.velocityAnimation,a=e.transformState.scale;return!!(!i.disabled||a>1||!r||t)},it=function(e){var t=e.mounted,n=e.velocity,r=e.bounds,i=e.setup,a=i.disabled,o=i.velocityAnimation,s=e.transformState.scale;return!(!(!o.disabled||s>1||!a||t)||!n||!r)};function at(e,t){var n=e.setup.velocityAnimation,r=n.equalToMove,i=n.animationTime,a=n.sensitivity;return r?i*t*a:i}function ot(e,t,n,r,i,a,o,s,c,l){if(i){if(t>o&&n>o){var u=o+(e-o)*l;return u>c?c:u<o?o:u}if(t<a&&n<a){var u=a+(e-a)*l;return u<s?s:u>a?a:u}}return r?t:Je(e,a,o,i)}function st(e,t){var n=1;return t?Math.min(n,e.offsetWidth/window.innerWidth):n}function ct(e,t){if(rt(e)){var n=e.lastMousePosition,r=e.velocityTime,i=e.setup,a=e.wrapperComponent,o=i.velocityAnimation.equalToMove,s=Date.now();if(n&&r&&a){var c=st(a,o),l=t.x-n.x,u=t.y-n.y,d=l/c,f=u/c,p=s-r,m=l*l+u*u;e.velocity={velocityX:d,velocityY:f,total:Math.sqrt(m)/p}}e.lastMousePosition=t,e.velocityTime=s}}function lt(e){var t=e.velocity,n=e.bounds,r=e.setup,i=e.wrapperComponent;if(!(!it(e)||!t||!n||!i)){var a=t.velocityX,o=t.velocityY,s=t.total,c=n.maxPositionX,l=n.minPositionX,u=n.maxPositionY,d=n.minPositionY,f=r.limitToBounds,p=r.alignmentAnimation,m=r.zoomAnimation,h=r.panning,g=h.lockAxisY,_=h.lockAxisX,v=m.animationType,y=p.sizeX,b=p.sizeY,x=p.velocityAlignmentTime,S=at(e,s),C=Math.max(S,x),w=X(e,y),T=X(e,b),E=w*i.offsetWidth/100,D=T*i.offsetHeight/100,O=c+E,k=l-E,A=u+D,j=d-D,M=e.transformState,ee=new Date().getTime();Ue(e,v,C,function(t){var n=e.transformState,r=n.scale,i=n.positionX,s=n.positionY,m=(new Date().getTime()-ee)/x,h=Ve[p.animationType],v=1-h(Math.min(1,m)),y=1-t,b=i+a*y,S=s+o*y,C=ot(b,M.positionX,i,_,f,l,c,k,O,v),w=ot(S,M.positionY,s,g,f,d,u,j,A,v);(i!==b||s!==S)&&e.setTransformState(r,C,w)})}}function ut(e,t){var n=e.transformState.scale;G(e),q(e,n),window.TouchEvent!==void 0&&t instanceof TouchEvent?$e(e,t):Qe(e,t)}function dt(e,t){var n=e.transformState.scale,r=e.setup,i=r.minScale,a=r.alignmentAnimation,o=a.disabled,s=a.sizeX,c=a.sizeY,l=a.animationTime,u=a.animationType;if(!(o||n<i||!s&&!c)){var d=et(e);d&&K(e,d,t??l,u)}}function ft(e,t,n){var r=e.startCoords,i=e.setup.alignmentAnimation,a=i.sizeX,o=i.sizeY;if(r){var s=nt(e,t,n),c=s.x,l=s.y,u=X(e,a),d=X(e,o);ct(e,{x:c,y:l}),tt(e,c,l,u,d)}}function pt(e){if(e.isPanning){var t=e.setup.panning.velocityDisabled,n=e.velocity,r=e.wrapperComponent,i=e.contentComponent;e.isPanning=!1,e.animate=!1,e.animation=null;var a=r?.getBoundingClientRect(),o=i?.getBoundingClientRect(),s=a?.width||0,c=a?.height||0,l=o?.width||0,u=o?.height||0,d=s<l||c<u;!t&&n&&n?.total>.1&&d?lt(e):dt(e)}}function mt(e,t,n,r){var i=e.setup,a=i.minScale,o=i.maxScale,s=i.limitToBounds,c=Y(U(t,2),a,o,0,!1),l=Ye(e,n,r,c,q(e,c),s);return{scale:c,positionX:l.x,positionY:l.y}}function ht(e,t,n){var r=e.transformState.scale,i=e.wrapperComponent,a=e.setup,o=a.minScale,s=a.limitToBounds,c=a.zoomAnimation,l=c.disabled,u=c.animationTime,d=c.animationType,f=l||r>=o;if((r>=1||s)&&dt(e),!(f||!i||!e.mounted)){var p=mt(e,o,t||i.offsetWidth/2,n||i.offsetHeight/2);p&&K(e,p,u,d)}}var Z=function(){return Z=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n],t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Z.apply(this,arguments)};function gt(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||=Array.prototype.slice.call(t,0,r),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}var _t={previousScale:1,scale:1,positionX:0,positionY:0},Q={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:`zoomIn`,animationType:`easeOut`,animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:`easeOut`},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:`easeOut`},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:`easeOut`,equalToMove:!0}},vt={wrapperClass:`react-transform-wrapper`,contentClass:`react-transform-component`},yt=function(e){return{previousScale:e.initialScale??_t.scale,scale:e.initialScale??_t.scale,positionX:e.initialPositionX??_t.positionX,positionY:e.initialPositionY??_t.positionY}},bt=function(e){var t=Z({},Q);return Object.keys(e).forEach(function(n){var r=e[n]!==void 0;if(Q[n]!==void 0&&r){var i=Object.prototype.toString.call(Q[n]);i===`[object Object]`?t[n]=Z(Z({},Q[n]),e[n]):i===`[object Array]`?t[n]=gt(gt([],Q[n],!0),e[n],!0):t[n]=e[n]}}),t},xt=function(e,t,n){var r=e.transformState.scale,i=e.wrapperComponent,a=e.setup,o=a.maxScale,s=a.minScale,c=a.zoomAnimation,l=a.smooth,u=c.size;if(!i)throw Error(`Wrapper is not mounted`);return Y(U(l?r*Math.exp(t*n):r+t*n,3),s,o,u,!1)};function St(e,t,n,r,i){var a=e.wrapperComponent,o=e.transformState,s=o.scale,c=o.positionX,l=o.positionY;if(!a)return console.error(`No WrapperComponent found`);var u=a.offsetWidth,d=a.offsetHeight,f=(u/2-c)/s,p=(d/2-l)/s,m=mt(e,xt(e,t,n),f,p);if(!m)return console.error(`Error during zoom event. New transformation state was not calculated.`);K(e,m,r,i)}function Ct(e,t,n,r){var i=e.setup,a=e.wrapperComponent,o=i.limitToBounds,s=yt(e.props),c=e.transformState,l=c.scale,u=c.positionX,d=c.positionY;if(a){var f=qe(e,s.scale),p=J(s.positionX,s.positionY,f,o,0,0,a),m={scale:s.scale,positionX:p.x,positionY:p.y};l===s.scale&&u===s.positionX&&d===s.positionY||(r?.(),K(e,m,t,n))}}function wt(e,t,n,r){var i=e.getBoundingClientRect(),a=t.getBoundingClientRect(),o=n.getBoundingClientRect(),s=a.x*r.scale,c=a.y*r.scale;return{x:(i.x-o.x+s)/r.scale,y:(i.y-o.y+c)/r.scale}}function Tt(e,t,n){var r=e.wrapperComponent,i=e.contentComponent,a=e.transformState,o=e.setup,s=o.limitToBounds,c=o.minScale,l=o.maxScale;if(!r||!i)return a;var u=r.getBoundingClientRect(),d=t.getBoundingClientRect(),f=wt(t,r,i,a),p=f.x,m=f.y,h=d.width/a.scale,g=d.height/a.scale,_=r.offsetWidth/h,v=r.offsetHeight/g,y=Y(n||Math.min(_,v),c,l,0,!1),b=(u.width-h*y)/2,x=(u.height-g*y)/2,S=J((u.left-p)*y+b,(u.top-m)*y+x,qe(e,y),s,0,0,r);return{positionX:S.x,positionY:S.y,scale:y}}var Et=function(e){return function(t,n,r){t===void 0&&(t=.5),n===void 0&&(n=300),r===void 0&&(r=`easeOut`),St(e,1,t,n,r)}},Dt=function(e){return function(t,n,r){t===void 0&&(t=.5),n===void 0&&(n=300),r===void 0&&(r=`easeOut`),St(e,-1,t,n,r)}},Ot=function(e){return function(t,n,r,i,a){i===void 0&&(i=300),a===void 0&&(a=`easeOut`);var o=e.transformState,s=o.positionX,c=o.positionY,l=o.scale,u=e.wrapperComponent,d=e.contentComponent;e.setup.disabled||!u||!d||K(e,{positionX:Number.isNaN(t)?s:t,positionY:Number.isNaN(n)?c:n,scale:Number.isNaN(r)?l:r},i,a)}},kt=function(e){return function(t,n){t===void 0&&(t=200),n===void 0&&(n=`easeOut`),Ct(e,t,n)}},At=function(e){return function(t,n,r){n===void 0&&(n=200),r===void 0&&(r=`easeOut`);var i=e.transformState,a=e.wrapperComponent,o=e.contentComponent;a&&o&&K(e,Bt(t||i.scale,a,o),n,r)}},jt=function(e){return function(t,n,r,i){r===void 0&&(r=600),i===void 0&&(i=`easeOut`),G(e);var a=e.wrapperComponent,o=typeof t==`string`?document.getElementById(t):t;a&&o&&a.contains(o)&&K(e,Tt(e,o,n),r,i)}},Mt=function(e){return{instance:e,zoomIn:Et(e),zoomOut:Dt(e),setTransform:Ot(e),resetTransform:kt(e),centerView:At(e),zoomToElement:jt(e)}},Nt=function(e){return{instance:e,state:e.transformState}},$=function(e){var t={};return Object.assign(t,Nt(e)),Object.assign(t,Mt(e)),t},Pt=!1;function Ft(){try{return{get passive(){return Pt=!0,!1}}}catch{return Pt=!1,Pt}}var It=`.${vt.wrapperClass}`,Lt=function(e,t){return t.some(function(t){return e.matches(`${It} ${t}, ${It} .${t}, ${It} ${t} *, ${It} .${t} *`)})},Rt=function(e){e&&clearTimeout(e)},zt=function(e,t,n){return`translate(${e}px, ${t}px) scale(${n})`},Bt=function(e,t,n){var r=n.offsetWidth*e,i=n.offsetHeight*e;return{scale:e,positionX:(t.offsetWidth-r)/2,positionY:(t.offsetHeight-i)/2}};function Vt(e){return function(t){e.forEach(function(e){typeof e==`function`?e(t):e!=null&&(e.current=t)})}}var Ht=function(e,t){var n=e.setup.wheel,r=n.disabled,i=n.wheelDisabled,a=n.touchPadDisabled,o=n.excluded,s=e.isInitialized,c=e.isPanning,l=t.target;return!(!(s&&!c&&!r&&l)||i&&!t.ctrlKey||a&&t.ctrlKey||Lt(l,o))},Ut=function(e){return e?e.deltaY<0?1:-1:0};function Wt(e,t){return Be(t,Ut(e))}function Gt(e,t,n){var r=t.getBoundingClientRect(),i=0,a=0;if(`clientX`in e)i=(e.clientX-r.left)/n,a=(e.clientY-r.top)/n;else{var o=e.touches[0];i=(o.clientX-r.left)/n,a=(o.clientY-r.top)/n}return(Number.isNaN(i)||Number.isNaN(a))&&console.error(`No mouse or touch offset found`),{x:i,y:a}}var Kt=function(e,t,n,r,i){var a=e.transformState.scale,o=e.wrapperComponent,s=e.setup,c=s.maxScale,l=s.minScale,u=s.zoomAnimation,d=s.disablePadding,f=u.size,p=u.disabled;if(!o)throw Error(`Wrapper is not mounted`);var m=a+t*n;if(i)return m;var h=r?!1:!p;return Y(U(m,3),l,c,f,h&&!d)},qt=function(e,t){var n=e.previousWheelEvent,r=e.transformState.scale,i=e.setup,a=i.maxScale,o=i.minScale;return n?r<a||r>o||Math.sign(n.deltaY)!==Math.sign(t.deltaY)||n.deltaY>0&&n.deltaY<t.deltaY||n.deltaY<0&&n.deltaY>t.deltaY||Math.sign(n.deltaY)!==Math.sign(t.deltaY):!1},Jt=function(e,t){var n=e.setup.pinch,r=n.disabled,i=n.excluded,a=e.isInitialized,o=t.target;return!(!(a&&!r&&o)||Lt(o,i))},Yt=function(e){var t=e.setup.pinch.disabled,n=e.isInitialized,r=e.pinchStartDistance;return!!(n&&!t&&r)},Xt=function(e,t,n){var r=n.getBoundingClientRect(),i=e.touches,a=U(i[0].clientX-r.left,5),o=U(i[0].clientY-r.top,5),s=U(i[1].clientX-r.left,5),c=U(i[1].clientY-r.top,5);return{x:(a+s)/2/t,y:(o+c)/2/t}},Zt=function(e){return Math.sqrt((e.touches[0].pageX-e.touches[1].pageX)**2+(e.touches[0].pageY-e.touches[1].pageY)**2)},Qt=function(e,t){var n=e.pinchStartScale,r=e.pinchStartDistance,i=e.setup,a=i.maxScale,o=i.minScale,s=i.zoomAnimation,c=i.disablePadding,l=s.size,u=s.disabled;if(!n||r===null||!t)throw Error(`Pinch touches distance was not provided`);return t<0?e.transformState.scale:Y(U(t/r*n,2),o,a,l,!u&&!c)},$t=160,en=100,tn=function(e,t){var n=e.props,r=n.onWheelStart,i=n.onZoomStart;e.wheelStopEventTimer||(G(e),W($(e),t,r),W($(e),t,i))},nn=function(e,t){var n=e.props,r=n.onWheel,i=n.onZoom,a=e.contentComponent,o=e.setup,s=e.transformState.scale,c=o.limitToBounds,l=o.centerZoomedOut,u=o.zoomAnimation,d=o.wheel,f=o.disablePadding,p=o.smooth,m=u.size,h=u.disabled,g=d.step,_=d.smoothStep;if(!a)throw Error(`Component not mounted`);t.preventDefault(),t.stopPropagation();var v=Kt(e,Wt(t,null),p?_*Math.abs(t.deltaY):g,!t.ctrlKey);if(s!==v){var y=q(e,v),b=Gt(t,a,s),x=c&&(h||m===0||l||f),S=Ye(e,b.x,b.y,v,y,x),C=S.x,w=S.y;e.previousWheelEvent=t,e.setTransformState(v,C,w),W($(e),t,r),W($(e),t,i)}},rn=function(e,t){var n=e.props,r=n.onWheelStop,i=n.onZoomStop;Rt(e.wheelAnimationTimer),e.wheelAnimationTimer=setTimeout(function(){e.mounted&&(ht(e,t.x,t.y),e.wheelAnimationTimer=null)},en),qt(e,t)&&(Rt(e.wheelStopEventTimer),e.wheelStopEventTimer=setTimeout(function(){e.mounted&&(e.wheelStopEventTimer=null,W($(e),t,r),W($(e),t,i))},$t))},an=function(e){for(var t=0,n=0,r=0;r<2;r+=1)t+=e.touches[r].clientX,n+=e.touches[r].clientY;return{x:t/2,y:n/2}},on=function(e,t){var n=Zt(t);e.pinchStartDistance=n,e.lastDistance=n,e.pinchStartScale=e.transformState.scale,e.isPanning=!1;var r=an(t);e.pinchLastCenterX=r.x,e.pinchLastCenterY=r.y,G(e)},sn=function(e,t){var n=e.contentComponent,r=e.pinchStartDistance,i=e.wrapperComponent,a=e.transformState.scale,o=e.setup,s=o.limitToBounds,c=o.centerZoomedOut,l=o.zoomAnimation,u=o.alignmentAnimation,d=l.disabled,f=l.size;if(!(r===null||!n)){var p=Xt(t,a,n);if(!(!Number.isFinite(p.x)||!Number.isFinite(p.y))){var m=Zt(t),h=Qt(e,m),g=an(t),_=g.x-(e.pinchLastCenterX||0),v=g.y-(e.pinchLastCenterY||0);if(!(h===a&&_===0&&v===0)){e.pinchLastCenterX=g.x,e.pinchLastCenterY=g.y;var y=q(e,h),b=s&&(d||f===0||c),x=Ye(e,p.x,p.y,h,y,b),S=x.x,C=x.y;e.pinchMidpoint=p,e.lastDistance=m;var w=u.sizeX,T=u.sizeY,E=X(e,w),D=X(e,T),O=J(S+_,C+v,y,s,E,D,i),k=O.x,A=O.y;e.setTransformState(h,k,A)}}}},cn=function(e){var t=e.pinchMidpoint;e.velocity=null,e.lastDistance=null,e.pinchMidpoint=null,e.pinchStartScale=null,e.pinchStartDistance=null,ht(e,t?.x,t?.y)},ln=function(e,t){var n=e.props.onZoomStop,r=e.setup.doubleClick.animationTime;Rt(e.doubleClickStopEventTimer),e.doubleClickStopEventTimer=setTimeout(function(){e.doubleClickStopEventTimer=null,W($(e),t,n)},r)},un=function(e,t){var n=e.props,r=n.onZoomStart,i=n.onZoom,a=e.setup.doubleClick,o=a.animationTime,s=a.animationType;W($(e),t,r),Ct(e,o,s,function(){return W($(e),t,i)}),ln(e,t)};function dn(e,t){return e===`toggle`?t===1?1:-1:e===`zoomOut`?-1:1}function fn(e,t){var n=e.setup,r=e.doubleClickStopEventTimer,i=e.transformState,a=e.contentComponent,o=i.scale,s=e.props,c=s.onZoomStart,l=s.onZoom,u=n.doubleClick,d=u.disabled,f=u.mode,p=u.step,m=u.animationTime,h=u.animationType;if(!d&&!r){if(f===`reset`)return un(e,t);if(!a)return console.error(`No ContentComponent found`);var g=xt(e,dn(f,e.transformState.scale),p);if(o!==g){W($(e),t,c);var _=Gt(t,a,o),v=mt(e,g,_.x,_.y);if(!v)return console.error(`Error during zoom event. New transformation state was not calculated.`);W($(e),t,l),K(e,v,m,h),ln(e,t)}}}var pn=function(e,t){var n=e.isInitialized,r=e.setup,i=e.wrapperComponent,a=r.doubleClick,o=a.disabled,s=a.excluded,c=t.target,l=i?.contains(c);return!(!(n&&c&&l&&!o)||Lt(c,s))},mn=function(){function e(e){var t=this;this.mounted=!0,this.pinchLastCenterX=null,this.pinchLastCenterY=null,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){t.initializeWindowEvents()},this.unmount=function(){t.cleanupWindowEvents()},this.update=function(e){t.props=e,q(t,t.transformState.scale),t.setup=bt(e)},this.initializeWindowEvents=function(){var e,n=Ft(),r=t.wrapperComponent?.ownerDocument,i=r?.defaultView;(e=t.wrapperComponent)==null||e.addEventListener(`wheel`,t.onWheelPanning,n),i?.addEventListener(`mousedown`,t.onPanningStart,n),i?.addEventListener(`mousemove`,t.onPanning,n),i?.addEventListener(`mouseup`,t.onPanningStop,n),r?.addEventListener(`mouseleave`,t.clearPanning,n),i?.addEventListener(`keyup`,t.setKeyUnPressed,n),i?.addEventListener(`keydown`,t.setKeyPressed,n)},this.cleanupWindowEvents=function(){var e,n=Ft(),r=t.wrapperComponent?.ownerDocument,i=r?.defaultView;i?.removeEventListener(`mousedown`,t.onPanningStart,n),i?.removeEventListener(`mousemove`,t.onPanning,n),i?.removeEventListener(`mouseup`,t.onPanningStop,n),r?.removeEventListener(`mouseleave`,t.clearPanning,n),i?.removeEventListener(`keyup`,t.setKeyUnPressed,n),i?.removeEventListener(`keydown`,t.setKeyPressed,n),document.removeEventListener(`mouseleave`,t.clearPanning,n),G(t),(e=t.observer)==null||e.disconnect()},this.handleInitializeWrapperEvents=function(e){var n=Ft();e.addEventListener(`wheel`,t.onWheelZoom,n),e.addEventListener(`dblclick`,t.onDoubleClick,n),e.addEventListener(`touchstart`,t.onTouchPanningStart,n),e.addEventListener(`touchmove`,t.onTouchPanning,n),e.addEventListener(`touchend`,t.onTouchPanningStop,n)},this.handleInitialize=function(e,n){var r=!1,i=t.setup.centerOnInit,a=function(e,t){for(var n=0,r=e;n<r.length;n++)if(r[n].target===t)return!0;return!1};t.applyTransformation(),t.onInitCallbacks.forEach(function(e){e($(t))}),t.observer=new ResizeObserver(function(o){if(a(o,e)||a(o,n))if(i&&!r){var s=n.offsetWidth,c=n.offsetHeight;(s>0||c>0)&&(r=!0,t.setCenter())}else G(t),q(t,t.transformState.scale),dt(t,0)}),t.observer.observe(e),t.observer.observe(n)},this.onWheelZoom=function(e){t.setup.disabled||Ht(t,e)&&t.isPressingKeys(t.setup.wheel.activationKeys)&&(tn(t,e),nn(t,e),rn(t,e))},this.onWheelPanning=function(e){var n=t.setup,r=n.disabled,i=n.wheel,a=n.panning;if(!(!t.wrapperComponent||!t.contentComponent||r||!i.wheelDisabled||a.disabled||!a.wheelPanning||e.ctrlKey)){e.preventDefault(),e.stopPropagation();var o=t.transformState,s=o.positionX,c=o.positionY,l=s-e.deltaX,u=c-e.deltaY,d=a.lockAxisX?s:l,f=a.lockAxisY?c:u,p=t.setup.alignmentAnimation,m=p.sizeX,h=p.sizeY,g=X(t,m),_=X(t,h);d===s&&f===c||tt(t,d,f,g,_)}},this.onPanningStart=function(e){var n=t.setup.disabled,r=t.props.onPanningStart;n||Xe(t,e)&&t.isPressingKeys(t.setup.panning.activationKeys)&&(e.button===0&&!t.setup.panning.allowLeftClickPan||e.button===1&&!t.setup.panning.allowMiddleClickPan||e.button===2&&!t.setup.panning.allowRightClickPan||(e.preventDefault(),e.stopPropagation(),G(t),ut(t,e),W($(t),e,r)))},this.onPanning=function(e){var n=t.setup.disabled,r=t.props.onPanning;n||Ze(t)&&t.isPressingKeys(t.setup.panning.activationKeys)&&(e.preventDefault(),e.stopPropagation(),ft(t,e.clientX,e.clientY),W($(t),e,r))},this.onPanningStop=function(e){var n=t.props.onPanningStop;t.isPanning&&(pt(t),W($(t),e,n))},this.onPinchStart=function(e){var n=t.setup.disabled,r=t.props,i=r.onPinchingStart,a=r.onZoomStart;n||Jt(t,e)&&(on(t,e),G(t),W($(t),e,i),W($(t),e,a))},this.onPinch=function(e){var n=t.setup.disabled,r=t.props,i=r.onPinching,a=r.onZoom;n||Yt(t)&&(e.preventDefault(),e.stopPropagation(),sn(t,e),W($(t),e,i),W($(t),e,a))},this.onPinchStop=function(e){var n=t.props,r=n.onPinchingStop,i=n.onZoomStop;t.pinchStartScale&&(cn(t),W($(t),e,r),W($(t),e,i))},this.onTouchPanningStart=function(e){var n=t.setup.disabled,r=t.props.onPanningStart;if(!n&&Xe(t,e)&&!(t.lastTouch&&+new Date-t.lastTouch<200&&e.touches.length===1)){t.lastTouch=+new Date,G(t);var i=e.touches,a=i.length===1,o=i.length===2;a&&(G(t),ut(t,e),W($(t),e,r)),o&&t.onPinchStart(e)}},this.onTouchPanning=function(e){var n=t.setup.disabled,r=t.props.onPanning;if(t.isPanning&&e.touches.length===1){if(n||!Ze(t))return;e.preventDefault(),e.stopPropagation();var i=e.touches[0];ft(t,i.clientX,i.clientY),W($(t),e,r)}else e.touches.length>1&&t.onPinch(e)},this.onTouchPanningStop=function(e){t.onPanningStop(e),t.onPinchStop(e)},this.onDoubleClick=function(e){t.setup.disabled||pn(t,e)&&fn(t,e)},this.clearPanning=function(e){t.isPanning&&t.onPanningStop(e)},this.setKeyPressed=function(e){t.pressedKeys[e.key]=!0},this.setKeyUnPressed=function(e){t.pressedKeys[e.key]=!1},this.isPressingKeys=function(e){return e.length?!!e.find(function(e){return t.pressedKeys[e]}):!0},this.setTransformState=function(e,n,r){var i=t.props.onTransformed;if(!Number.isNaN(e)&&!Number.isNaN(n)&&!Number.isNaN(r)){e!==t.transformState.scale&&(t.transformState.previousScale=t.transformState.scale,t.transformState.scale=e),t.transformState.positionX=n,t.transformState.positionY=r,t.applyTransformation();var a=$(t);t.onChangeCallbacks.forEach(function(e){return e(a)}),W(a,{scale:e,positionX:n,positionY:r},i)}else console.error(`Detected NaN set state values`)},this.setCenter=function(){if(t.wrapperComponent&&t.contentComponent){var e=Bt(t.transformState.scale,t.wrapperComponent,t.contentComponent);t.setTransformState(e.scale,e.positionX,e.positionY)}},this.handleTransformStyles=function(e,n,r){return t.props.customTransform?t.props.customTransform(e,n,r):zt(e,n,r)},this.applyTransformation=function(){if(!(!t.mounted||!t.contentComponent)){var e=t.transformState,n=e.scale,r=e.positionX,i=e.positionY,a=t.handleTransformStyles(r,i,n);t.contentComponent.style.transform=a}},this.getContext=function(){return $(t)},this.onChange=function(e){return t.onChangeCallbacks.has(e)||t.onChangeCallbacks.add(e),function(){t.onChangeCallbacks.delete(e)}},this.onInit=function(e){return t.onInitCallbacks.has(e)||t.onInitCallbacks.add(e),function(){t.onInitCallbacks.delete(e)}},this.init=function(e,n){t.cleanupWindowEvents(),t.wrapperComponent=e,t.contentComponent=n,q(t,t.transformState.scale),t.handleInitializeWrapperEvents(e),t.handleInitialize(e,n),t.initializeWindowEvents(),t.isInitialized=!0,W($(t),void 0,t.props.onInit)},this.props=e,this.setup=bt(this.props),this.transformState=yt(this.props)}return e}(),hn=R.createContext(null),gn=function(e,t){return typeof e==`function`?e(t):e},_n=R.forwardRef(function(e,t){var n=(0,R.useRef)(new mn(e)).current,r=gn(e.children,Mt(n));return(0,R.useImperativeHandle)(t,function(){return Mt(n)},[n]),(0,R.useEffect)(function(){n.update(e)},[n,e]),R.createElement(hn.Provider,{value:n},r)});R.forwardRef(function(e,t){var n=(0,R.useRef)(null),r=(0,R.useContext)(hn);return(0,R.useEffect)(function(){return r.onChange(function(e){if(n.current){var t=0,i=0;n.current.style.transform=r.handleTransformStyles(t,i,1/e.instance.transformState.scale)}})},[r]),R.createElement(`div`,Z({},e,{ref:Vt([n,t])}))});function vn(e,t){t===void 0&&(t={});var n=t.insertAt;if(!(!e||typeof document>`u`)){var r=document.head||document.getElementsByTagName(`head`)[0],i=document.createElement(`style`);i.type=`text/css`,n===`top`&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}var yn=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
  transform: translate3d(0, 0, 0);
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,bn={wrapper:`transform-component-module_wrapper__SPB86`,content:`transform-component-module_content__FBWxo`};vn(yn);var xn=function(e){var t=e.children,n=e.wrapperClass,r=n===void 0?``:n,i=e.contentClass,a=i===void 0?``:i,o=e.wrapperStyle,s=e.contentStyle,c=e.wrapperProps,l=c===void 0?{}:c,u=e.contentProps,d=u===void 0?{}:u,f=(0,R.useContext)(hn),p=f.init,m=f.cleanupWindowEvents,h=(0,R.useRef)(null),g=(0,R.useRef)(null);return(0,R.useEffect)(function(){var e=h.current,t=g.current;return e!==null&&t!==null&&p&&p?.(e,t),function(){m?.()}},[]),R.createElement(`div`,Z({},l,{ref:h,className:`${vt.wrapperClass} ${bn.wrapper} ${r}`,style:o}),R.createElement(`div`,Z({},d,{ref:g,className:`${vt.contentClass} ${bn.content} ${a}`,style:s}),t))},Sn=[`images/Board/Nezekan.webp`,`images/Board/Zikel.webp`,`images/Board/Vaizel.webp`,`images/Board/Triniel.webp`,null,null],Cn=R.memo(()=>{let{info:e,boardDetails:t,stats:n}=B(),{boards:r,loadBoardsForClass:i,loading:a}=be(),o=Ce(),{isOpen:l,onOpen:u,onOpenChange:f}=C(),[p,h]=(0,R.useState)(null),{t:g}=M(),_=(0,R.useMemo)(()=>n?.boardStats?Object.fromEntries(n.boardStats.map(e=>[e.type,e.value])):{},[n]);(0,R.useEffect)(()=>{o&&i(o)},[o,i]);let v=e=>{h(e),u()},y=(0,R.useMemo)(()=>r.find(e=>e.id===p),[r,p]),x=(0,R.useMemo)(()=>!p||!t?null:t[`boards:${p}`],[t,p]),{currentStats:w,currentSkills:E}=(0,R.useMemo)(()=>{let e={},t={};return x&&y&&x.openNodes.forEach(n=>{let r=y.nodes.find(e=>e.id===n);r&&(r.stats&&r.stats.forEach(t=>{let n=_[t]||`0`,r=parseFloat(n);isNaN(r)||(e[t]=(e[t]||0)+r)}),r.skillId&&(t[r.skillId]=(t[r.skillId]||0)+1))}),{currentStats:Object.entries(e).map(([e,t])=>({type:e,value:(_[e]||``).includes(`%`)?`${t.toFixed(1).replace(/\.0$/,``)}%`:Math.round(t).toString(),name:g(`stats:${e}.name`,e)})).sort((e,t)=>e.name.localeCompare(t.name)),currentSkills:Object.entries(t).map(([e,t])=>{let n=parseInt(e);return{id:n,level:t,name:g(`skills:${n}.name`,n.toString())}}).sort((e,t)=>e.name.localeCompare(t.name))}},[x,y,_,g]);if(!e||!e.boards)return null;let D=(e,t)=>e.grade===`None`?`images/Board/board_icon_start_${o?.toLowerCase()}.webp`:`images/Board/board_icon_${e.grade?.toLowerCase()||`common`}${t?`_open`:``}.webp`,O=()=>{if(a||!t)return(0,z.jsxs)(`div`,{className:`flex flex-col items-center justify-center py-20 gap-4`,children:[(0,z.jsx)(T,{"aria-label":`Loading...`,size:`md`}),(0,z.jsx)(`div`,{className:`text-default-500 text-sm`,children:g(`character:board.loading`,`正在加载星盘数据...`)})]});if(!y)return(0,z.jsx)(`div`,{className:`py-20 text-center text-default-500`,children:`未能加载守护力配置`});let e=Array.from({length:15},()=>Array(15).fill(null)),n=15,r=-1,i=15,o=-1;y.nodes.forEach(t=>{let a=t.id%1e3,s=Math.floor((a-1)/15),c=(a-1)%15;s>=0&&s<15&&c>=0&&c<15&&(e[s][c]=t,s<n&&(n=s),s>r&&(r=s),c<i&&(i=c),c>o&&(o=c))});let s=r>=0?o-i+1:15,c=r>=0?r-n+1:15,u=Math.max(s,c,1);return(0,z.jsx)(`div`,{className:`flex flex-col gap-3`,children:(0,z.jsx)(`div`,{className:`w-full max-w-[75vh] aspect-square mx-auto relative overflow-hidden rounded-lg`,children:(0,z.jsx)(_n,{initialScale:Math.min(3,15/u),minScale:1,maxScale:3,centerOnInit:!0,panning:{excluded:[`img`,`node-trigger`]},children:()=>(0,z.jsx)(z.Fragment,{children:(0,z.jsx)(xn,{wrapperClass:`w-full h-full`,contentClass:`w-full h-full`,children:(0,z.jsx)(`div`,{className:`grid gap-1 mx-auto aspect-square w-full p-4 bg-no-repeat bg-center bg-cover shrink-0`,style:{gridTemplateColumns:`repeat(15, minmax(0, 1fr))`,backgroundImage:`url(${N(`UI/Resource/Texture/BG/UT_BG_FWindow_Daevanion.webp`)})`},children:e.map((e,t)=>e.map((e,n)=>{if(!e)return(0,z.jsx)(`div`,{className:`aspect-square`},`empty-${t}-${n}`);let r=x?.openNodes.includes(e.id),i=D(e,!!r);return(0,z.jsx)(`div`,{className:`aspect-square flex items-center justify-center relative`,children:(0,z.jsx)(V,{isDisabled:e.grade===`None`,placement:`top`,delay:100,closeDelay:0,disableAnimation:!0,content:(0,z.jsxs)(`div`,{className:`px-2 py-1`,children:[e.skillId&&(0,z.jsxs)(`div`,{className:`text-xs text-foreground flex justify-between gap-1`,children:[(0,z.jsx)(`span`,{children:g(`skills:${e.skillId}.name`,String(e.skillId))}),(0,z.jsx)(`span`,{className:`font-bold`,children:`+Lv.1`})]}),e.stats?.map((e,t)=>(0,z.jsxs)(`div`,{className:`text-xs text-foreground flex justify-between gap-1`,children:[(0,z.jsx)(`span`,{children:g(`stats:${e}.name`,e)}),(0,z.jsxs)(`span`,{className:`font-bold`,children:[`+`,_[e]||``]})]},t))]}),children:(0,z.jsx)(`div`,{className:`w-full h-full flex items-center justify-center cursor-help node-trigger`,children:(0,z.jsx)(`img`,{src:N(i),alt:e.grade,className:`w-full h-full object-contain transition-transform hover:scale-110 hover:z-50 active:scale-95 ${!r&&e.grade!==`None`?`opacity-60 grayscale-[0.5]`:``}`,draggable:!1})})})},e.id)}))})})})})})},`${p}-${l}`)};return(0,z.jsxs)(`div`,{className:`flex flex-col gap-3`,children:[(0,z.jsx)(`div`,{className:`flex justify-between items-center px-1`,children:(0,z.jsx)(`h3`,{className:`text-base font-bold text-default-800`,children:`守护力概览`})}),(0,z.jsx)(`div`,{className:`grid grid-cols-3 sm:grid-cols-6 gap-2 sm:gap-3`,children:e.boards.map((e,t)=>(0,z.jsx)(V,{content:(0,z.jsxs)(`div`,{className:`px-1 py-1`,children:[(0,z.jsx)(`div`,{className:`font-bold text-foreground text-center`,children:e.name}),(0,z.jsxs)(`div`,{className:`text-xs text-default-800 text-center`,children:[e.openNodeCount,` / `,e.totalNodeCount]})]}),placement:`top`,radius:`sm`,delay:0,closeDelay:0,children:(0,z.jsxs)(`div`,{className:`text-center cursor-pointer outline-none focus-visible:ring-2 focus-visible:ring-primary`,tabIndex:0,onClick:()=>v(e.id),children:[(0,z.jsxs)(`div`,{className:`w-full max-w-[80px] aspect-square mx-auto rounded-lg overflow-hidden relative flex items-center justify-center`,children:[(0,z.jsx)(`img`,{src:N(`images/Board/Background.webp`),alt:``,className:`w-full h-full object-cover ${e.open===0?`grayscale opacity-50`:``}`,draggable:!1}),Sn[t]&&(0,z.jsx)(`img`,{src:N(Sn[t]),alt:e.name,className:`absolute inset-0 w-full h-full object-contain p-2 ${e.open===0?`grayscale opacity-50`:``}`,draggable:!1}),(0,z.jsx)(T,{"aria-label":e.name,size:`sm`,value:e.openNodeCount/e.totalNodeCount*100,color:`primary`,disableAnimation:!0,className:`absolute inset-0 z-10 p-1.5`,classNames:{svg:`w-full h-full`,indicator:`stroke-primary`,track:`stroke-transparent`}})]}),(0,z.jsxs)(`div`,{className:`text-[14px] text-default-800 truncate mt-1`,children:[Math.round(e.openNodeCount/e.totalNodeCount*100),`%`]})]})},e.id))}),(0,z.jsx)(b,{isOpen:l,onOpenChange:f,size:`3xl`,classNames:{base:`max-h-[90vh] bg-character-equipment`,body:`p-2 sm:p-6 overflow-x-hidden`},hideCloseButton:!0,children:(0,z.jsx)(S,{children:()=>(0,z.jsxs)(z.Fragment,{children:[(0,z.jsxs)(k,{className:`flex flex-row justify-between items-center pb-0`,children:[(0,z.jsx)(`span`,{children:e.boards.find(e=>e.id===p)?.name||`守护力`}),y&&!a&&(0,z.jsxs)(c,{placement:`bottom-end`,children:[(0,z.jsx)(s,{children:(0,z.jsx)(d,{size:`sm`,variant:`flat`,color:`primary`,className:`h-8 bg-primary/10 hover:bg-primary/20 text-primary border-none shadow-none`,children:g(`character:board.stats`,`能力值详情`)})}),(0,z.jsx)(m,{className:`bg-character-equipment border-1 border-crafting-border shadow-xl p-0`,children:(0,z.jsx)(`div`,{className:`p-3 min-w-[240px] max-w-[320px]`,children:(0,z.jsxs)(`div`,{className:`space-y-4 max-h-[75vh] overflow-y-auto no-scrollbar`,children:[w.length>0&&(0,z.jsx)(`div`,{children:(0,z.jsx)(`div`,{className:`grid grid-cols-1 gap-1`,children:w.map(e=>(0,z.jsxs)(`div`,{className:`flex justify-between text-xs border-b border-white/5 pb-1`,children:[(0,z.jsx)(`span`,{className:`text-default-700`,children:e.name}),(0,z.jsxs)(`span`,{className:`font-bold text-foreground`,children:[`+`,e.value]})]},e.type))})}),E.length>0&&(0,z.jsxs)(`div`,{children:[(0,z.jsx)(`div`,{className:`text-xs font-bold mb-2 text-primary`,children:`技能合计`}),(0,z.jsx)(`div`,{className:`grid grid-cols-1 gap-1`,children:E.map(e=>(0,z.jsxs)(`div`,{className:`flex justify-between text-xs border-b border-white/5 pb-1`,children:[(0,z.jsx)(`span`,{className:`text-default-700`,children:e.name}),(0,z.jsxs)(`span`,{className:`font-bold text-foreground`,children:[`+Lv.`,e.level]})]},e.id))})]}),w.length===0&&E.length===0&&(0,z.jsx)(`div`,{className:`text-center text-xs text-default-500 py-4`,children:`暂无已激活的属性`})]})})})]})]}),(0,z.jsx)(A,{children:O()})]})})})]})});function wn(){let{info:e,loading:t,error:n,characterId:r,stats:i}=B(),{loadBoardsForClass:o}=be(),s=Ce(),c=Me();if((0,R.useEffect)(()=>{s&&o(s)},[s,o]),!r)return null;if(n)return(0,z.jsx)(`div`,{className:`grid place-items-center py-20 text-default-500`,children:(0,z.jsxs)(`div`,{className:`rounded-lg border border-default-200 bg-content2 px-6 py-3 text-sm`,children:[`Error loading character: `,n]})});if(t||!e)return(0,z.jsx)(`div`,{className:`flex justify-center items-center py-20`,children:(0,z.jsx)(g,{})});if(!i)return null;let l={base:`!bg-transparent !shadow-none !backdrop-filter-none !backdrop-blur-none pb-2 `,trigger:`py-4 min-h-0 px-2`,title:`text-[16px] leading-[16px] font-bold`,content:`py-0`,indicator:`text-default-700`},u=[{key:`equipments`,title:`装备`,component:(0,z.jsx)(Fe,{})},{key:`cards`,title:`阿尔卡那`,component:(0,z.jsx)(Le,{})},{key:`stats`,title:`主要能力值`,component:(0,z.jsx)(ke,{})},{key:`boards`,title:`守护力`,component:(0,z.jsx)(Cn,{})},{key:`skills`,title:`技能`,component:(0,z.jsx)(Ae,{})},{key:`titles`,title:`称号`,component:(0,z.jsx)(ze,{})},{key:`rankings`,title:`排名`,component:(0,z.jsx)(je,{})}],d=[`stats`,`skills`,`rankings`],f=[`equipments`,`cards`,`boards`,`titles`],p=(e,t)=>(0,z.jsx)(a,{variant:`light`,selectionMode:`multiple`,defaultExpandedKeys:e.map(e=>e.key),itemClasses:l,showDivider:!1,className:t,children:e.map(e=>(0,z.jsx)(j,{title:e.title,className:`w-full`,children:e.component},e.key))});return(0,z.jsxs)(`div`,{className:`w-full space-y-4`,children:[(0,z.jsx)(Ee,{}),c?(0,z.jsx)(`div`,{children:p(u)}):(0,z.jsxs)(`div`,{className:`grid grid-cols-2 gap-4`,children:[(0,z.jsx)(`div`,{className:`flex flex-col`,children:p(u.filter(e=>d.includes(e.key)))}),(0,z.jsx)(`div`,{className:`flex flex-col`,children:p(u.filter(e=>f.includes(e.key)))})]})]})}function Tn(){return(0,z.jsxs)(`div`,{className:`h-full overflow-y-auto bg-chacracter-page flex flex-col`,children:[(0,z.jsxs)(`div`,{className:`max-w-6xl mx-auto px-4 py-6 space-y-4 flex-1 w-full`,children:[(0,z.jsx)(Se,{}),(0,z.jsx)(wn,{})]}),(0,z.jsx)(de,{})]})}var En=()=>(0,z.jsx)(ce,{children:(0,z.jsx)(ue,{children:(0,z.jsx)(ye,{children:(0,z.jsx)(_e,{children:(0,z.jsx)(pe,{children:(0,z.jsx)(Tn,{})})})})})});export{En as component};